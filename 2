
Imports System
Imports System.IO
Imports System.Text
Imports Word = Microsoft.Office.Interop.Word



Public Class Form1
    Private base As String
    Private FileSazes As String
    Private LoadText As String
    Private p1 As String
    Private p2 As String
    Private rp As String
    Private Busy As Long
    Private LoadEnd As Long
    ' Private BusyFile As Long
    Private LoadText1 As String

    Private xScroll(10) As Integer
    Private yScroll(10) As Integer
    Private lastTime(20) As String

    Private RW As Long
    Private Stringtext As String
    Private bytesvalue As String
    Private TxtDB(200) As Integer
    Private GrWB As Integer
    Private Version As String


    ' Добавьте эти обработчики событий в вашу форму
    Private isDragging As Boolean = False
    Private clickOffsetX As Integer
    Private clickOffsetY As Integer

    Private Sub TabPage10_MouseDown(sender As Object, e As MouseEventArgs) Handles TabPage10.MouseDown
        ' Начало перемещения
        If e.Button = MouseButtons.Left Then
            isDragging = True
            clickOffsetX = e.X
            clickOffsetY = e.Y
        End If
    End Sub

    Private Sub TabPage10_MouseMove(sender As Object, e As MouseEventArgs) Handles TabPage10.MouseMove
        ' Процесс перемещения
        If isDragging Then
            TabPage10.AutoScrollPosition = New Point(clickOffsetX - e.X, clickOffsetY - e.Y)
        End If
    End Sub

    Private Sub TabPage10_MouseUp(sender As Object, e As MouseEventArgs) Handles TabPage10.MouseUp
        ' Конец перемещения
        isDragging = False
    End Sub


    Sub WordPrint()

        'Путь к файлу Word
        Dim path As String = Application.StartupPath & "\rwp.docx"

        'Создаем объект Word.Application
        Dim wdApp As New Word.Application

        'Открываем файл Word с помощью объекта Word.Document
        Dim wdDoc As Word.Document = wdApp.Documents.Open(path)
        Dim wdBookmark As Word.Bookmark
        Dim wdRange As Word.Range


        'Передача данных по закладкам
        ''==========================================================================            погрузка
        wdBookmark = wdDoc.Bookmarks("pogr")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox11.Text




        wdBookmark = wdDoc.Bookmarks("pogr_kr")
        wdRange = wdBookmark.Range
        If Val(Label47.Text) > 0 Then
            wdRange.Text = Label47.Text
        Else
            wdRange.Text = ""
        End If


        wdBookmark = wdDoc.Bookmarks("pogr_kr_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox1.Text

        wdBookmark = wdDoc.Bookmarks("pogr_kr_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox3.Text

        wdBookmark = wdDoc.Bookmarks("pogr_kr_sob")
        wdRange = wdBookmark.Range

        If MaskedTextBox2.Text <> "" Then
            wdRange.Text = MaskedTextBox2.Text & "с"
        Else
            wdRange.Text = MaskedTextBox2.Text
        End If



        wdBookmark = wdDoc.Bookmarks("pogr_kr_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox4.Text




        wdBookmark = wdDoc.Bookmarks("pogr_pl")
        wdRange = wdBookmark.Range
        If Val(Label52.Text) > 0 Then
            wdRange.Text = Label52.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("pogr_pl_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox52.Text

        wdBookmark = wdDoc.Bookmarks("pogr_pl_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox99.Text

        wdBookmark = wdDoc.Bookmarks("pogr_pl_sob")
        wdRange = wdBookmark.Range
        ' wdRange.Text = MaskedTextBox53.Text & "с"

        If MaskedTextBox53.Text <> "" Then
            wdRange.Text = MaskedTextBox53.Text & "с"
        Else
            wdRange.Text = MaskedTextBox53.Text
        End If





        wdBookmark = wdDoc.Bookmarks("pogr_pl_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox34.Text



        wdBookmark = wdDoc.Bookmarks("pogr_pv")
        wdRange = wdBookmark.Range
        If Val(Label59.Text) > 0 Then
            wdRange.Text = Label59.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("pogr_pv_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox54.Text

        wdBookmark = wdDoc.Bookmarks("pogr_pv_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox100.Text

        wdBookmark = wdDoc.Bookmarks("pogr_pv_sob")
        wdRange = wdBookmark.Range

        If MaskedTextBox55.Text <> "" Then
            wdRange.Text = MaskedTextBox55.Text & "с"
        Else
            wdRange.Text = MaskedTextBox55.Text
        End If




        wdBookmark = wdDoc.Bookmarks("pogr_pv_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox101.Text





        wdBookmark = wdDoc.Bookmarks("pogr_cs")
        wdRange = wdBookmark.Range
        If Val(Label62.Text) > 0 Then
            wdRange.Text = Label62.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("pogr_cs_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox56.Text

        wdBookmark = wdDoc.Bookmarks("pogr_cs_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox102.Text

        wdBookmark = wdDoc.Bookmarks("pogr_cs_sob")
        wdRange = wdBookmark.Range

        If MaskedTextBox57.Text <> "" Then
            wdRange.Text = MaskedTextBox57.Text & "с"
        Else
            wdRange.Text = MaskedTextBox57.Text
        End If




        wdBookmark = wdDoc.Bookmarks("pogr_cs_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox103.Text



        wdBookmark = wdDoc.Bookmarks("pogr_pr")
        wdRange = wdBookmark.Range
        If Val(Label65.Text) > 0 Then
            wdRange.Text = Label65.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("pogr_pr_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox58.Text

        wdBookmark = wdDoc.Bookmarks("pogr_pr_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox104.Text

        wdBookmark = wdDoc.Bookmarks("pogr_pr_sob")
        wdRange = wdBookmark.Range

        If MaskedTextBox59.Text <> "" Then
            wdRange.Text = MaskedTextBox59.Text & "с"
        Else
            wdRange.Text = MaskedTextBox59.Text
        End If



        wdBookmark = wdDoc.Bookmarks("pogr_pr_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox105.Text





        'Передача данных по закладкам
        ''==========================================================================            выгрузка
        wdBookmark = wdDoc.Bookmarks("vygr")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox22.Text

        wdBookmark = wdDoc.Bookmarks("vygr_kr")
        wdRange = wdBookmark.Range
        If Val(Label80.Text) > 0 Then
            wdRange.Text = Label80.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("vygr_kr_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox60.Text

        wdBookmark = wdDoc.Bookmarks("vygr_kr_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox88.Text

        wdBookmark = wdDoc.Bookmarks("vygr_kr_sob")
        wdRange = wdBookmark.Range

        If MaskedTextBox61.Text <> "" Then
            wdRange.Text = MaskedTextBox61.Text & "с"
        Else
            wdRange.Text = MaskedTextBox61.Text
        End If



        wdBookmark = wdDoc.Bookmarks("vygr_kr_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox107.Text




        wdBookmark = wdDoc.Bookmarks("vygr_pl")
        wdRange = wdBookmark.Range
        If Val(Label77.Text) > 0 Then
            wdRange.Text = Label77.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("vygr_pl_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox62.Text

        wdBookmark = wdDoc.Bookmarks("vygr_pl_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox108.Text

        wdBookmark = wdDoc.Bookmarks("vygr_pl_sob")
        wdRange = wdBookmark.Range

        If MaskedTextBox63.Text <> "" Then
            wdRange.Text = MaskedTextBox63.Text & "с"
        Else
            wdRange.Text = MaskedTextBox63.Text
        End If

        wdBookmark = wdDoc.Bookmarks("vygr_pl_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox109.Text



        wdBookmark = wdDoc.Bookmarks("vygr_pv")
        wdRange = wdBookmark.Range
        If Val(Label74.Text) > 0 Then
            wdRange.Text = Label74.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("vygr_pv_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox64.Text

        wdBookmark = wdDoc.Bookmarks("vygr_pv_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox110.Text

        wdBookmark = wdDoc.Bookmarks("vygr_pv_sob")
        wdRange = wdBookmark.Range

        If MaskedTextBox65.Text <> "" Then
            wdRange.Text = MaskedTextBox65.Text & "с"
        Else
            wdRange.Text = MaskedTextBox65.Text
        End If



        wdBookmark = wdDoc.Bookmarks("vygr_pv_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox111.Text





        wdBookmark = wdDoc.Bookmarks("vygr_cs")
        wdRange = wdBookmark.Range
        If Val(Label71.Text) > 0 Then
            wdRange.Text = Label71.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("vygr_cs_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox66.Text

        wdBookmark = wdDoc.Bookmarks("vygr_cs_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox112.Text

        wdBookmark = wdDoc.Bookmarks("vygr_cs_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox67.Text <> "" Then
            wdRange.Text = MaskedTextBox67.Text & "с"
        Else
            wdRange.Text = MaskedTextBox67.Text
        End If

        wdBookmark = wdDoc.Bookmarks("vygr_cs_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox113.Text



        wdBookmark = wdDoc.Bookmarks("vygr_pr")
        wdRange = wdBookmark.Range
        If Val(Label68.Text) > 0 Then
            wdRange.Text = Label68.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("vygr_pr_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox68.Text

        wdBookmark = wdDoc.Bookmarks("vygr_pr_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox114.Text

        wdBookmark = wdDoc.Bookmarks("vygr_pr_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox69.Text <> "" Then
            wdRange.Text = MaskedTextBox69.Text & "с"
        Else
            wdRange.Text = MaskedTextBox69.Text
        End If

        wdBookmark = wdDoc.Bookmarks("vygr_pr_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox115.Text








        'Передача данных по закладкам
        ''==========================================================================            заявка
        wdBookmark = wdDoc.Bookmarks("zayavka")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox45.Text

        wdBookmark = wdDoc.Bookmarks("zayavka_kr")
        wdRange = wdBookmark.Range
        If Val(Label95.Text) > 0 Then
            wdRange.Text = Label95.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("zayavka_kr_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox70.Text

        wdBookmark = wdDoc.Bookmarks("zayavka_kr_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox116.Text

        wdBookmark = wdDoc.Bookmarks("zayavka_kr_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox71.Text <> "" Then
            wdRange.Text = MaskedTextBox71.Text & "с"
        Else
            wdRange.Text = MaskedTextBox71.Text
        End If

        wdBookmark = wdDoc.Bookmarks("zayavka_kr_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox117.Text




        wdBookmark = wdDoc.Bookmarks("zayavka_pl")
        wdRange = wdBookmark.Range
        If Val(Label92.Text) > 0 Then
            wdRange.Text = Label92.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("zayavka_pl_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox72.Text

        wdBookmark = wdDoc.Bookmarks("zayavka_pl_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox118.Text

        wdBookmark = wdDoc.Bookmarks("zayavka_pl_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox73.Text <> "" Then
            wdRange.Text = MaskedTextBox73.Text & "с"
        Else
            wdRange.Text = MaskedTextBox73.Text
        End If

        wdBookmark = wdDoc.Bookmarks("zayavka_pl_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox119.Text



        wdBookmark = wdDoc.Bookmarks("zayavka_pv")
        wdRange = wdBookmark.Range
        If Val(Label89.Text) > 0 Then
            wdRange.Text = Label89.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("zayavka_pv_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox74.Text

        wdBookmark = wdDoc.Bookmarks("zayavka_pv_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox120.Text

        wdBookmark = wdDoc.Bookmarks("zayavka_pv_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox75.Text <> "" Then
            wdRange.Text = MaskedTextBox75.Text & "с"
        Else
            wdRange.Text = MaskedTextBox75.Text
        End If

        wdBookmark = wdDoc.Bookmarks("zayavka_pv_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox121.Text





        wdBookmark = wdDoc.Bookmarks("zayavka_cs")
        wdRange = wdBookmark.Range
        If Val(Label86.Text) > 0 Then
            wdRange.Text = Label86.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("zayavka_cs_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox76.Text

        wdBookmark = wdDoc.Bookmarks("zayavka_cs_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox122.Text

        wdBookmark = wdDoc.Bookmarks("zayavka_cs_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox77.Text <> "" Then
            wdRange.Text = MaskedTextBox77.Text & "с"
        Else
            wdRange.Text = MaskedTextBox77.Text
        End If

        wdBookmark = wdDoc.Bookmarks("zayavka_cs_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox123.Text



        wdBookmark = wdDoc.Bookmarks("zayavka_pr")
        wdRange = wdBookmark.Range
        If Val(Label83.Text) > 0 Then
            wdRange.Text = Label83.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("zayavka_pr_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox78.Text

        wdBookmark = wdDoc.Bookmarks("zayavka_pr_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox124.Text

        wdBookmark = wdDoc.Bookmarks("zayavka_pr_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox79.Text <> "" Then
            wdRange.Text = MaskedTextBox79.Text & "с"
        Else
            wdRange.Text = MaskedTextBox79.Text
        End If

        wdBookmark = wdDoc.Bookmarks("zayavka_pr_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox125.Text








        'Передача данных по закладкам
        ''==========================================================================            под выгрузкой
        wdBookmark = wdDoc.Bookmarks("podvygr")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox46.Text

        wdBookmark = wdDoc.Bookmarks("podvygr_kr")
        wdRange = wdBookmark.Range
        If Val(Label110.Text) > 0 Then
            wdRange.Text = Label110.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("podvygr_kr_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox90.Text

        wdBookmark = wdDoc.Bookmarks("podvygr_kr_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox136.Text

        wdBookmark = wdDoc.Bookmarks("podvygr_kr_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox91.Text <> "" Then
            wdRange.Text = MaskedTextBox91.Text & "с"
        Else
            wdRange.Text = MaskedTextBox91.Text
        End If

        wdBookmark = wdDoc.Bookmarks("podvygr_kr_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox137.Text




        wdBookmark = wdDoc.Bookmarks("podvygr_pl")
        wdRange = wdBookmark.Range
        If Val(Label107.Text) > 0 Then
            wdRange.Text = Label107.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("podvygr_pl_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox92.Text

        wdBookmark = wdDoc.Bookmarks("podvygr_pl_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox138.Text

        wdBookmark = wdDoc.Bookmarks("podvygr_pl_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox93.Text <> "" Then
            wdRange.Text = MaskedTextBox93.Text & "с"
        Else
            wdRange.Text = MaskedTextBox93.Text
        End If

        wdBookmark = wdDoc.Bookmarks("podvygr_pl_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox139.Text



        wdBookmark = wdDoc.Bookmarks("podvygr_pv")
        wdRange = wdBookmark.Range
        If Val(Label104.Text) > 0 Then
            wdRange.Text = Label104.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("podvygr_pv_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox94.Text

        wdBookmark = wdDoc.Bookmarks("podvygr_pv_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox140.Text

        wdBookmark = wdDoc.Bookmarks("podvygr_pv_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox95.Text <> "" Then
            wdRange.Text = MaskedTextBox95.Text & "с"
        Else
            wdRange.Text = MaskedTextBox95.Text
        End If

        wdBookmark = wdDoc.Bookmarks("podvygr_pv_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox141.Text





        wdBookmark = wdDoc.Bookmarks("podvygr_cs")
        wdRange = wdBookmark.Range
        If Val(Label101.Text) > 0 Then
            wdRange.Text = Label101.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("podvygr_cs_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox96.Text

        wdBookmark = wdDoc.Bookmarks("podvygr_cs_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox142.Text

        wdBookmark = wdDoc.Bookmarks("podvygr_cs_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox97.Text <> "" Then
            wdRange.Text = MaskedTextBox97.Text & "с"
        Else
            wdRange.Text = MaskedTextBox97.Text
        End If

        wdBookmark = wdDoc.Bookmarks("podvygr_cs_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox143.Text



        wdBookmark = wdDoc.Bookmarks("podvygr_pr")
        wdRange = wdBookmark.Range
        If Val(Label98.Text) > 0 Then
            wdRange.Text = Label98.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("podvygr_pr_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox98.Text

        wdBookmark = wdDoc.Bookmarks("podvygr_pr_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox144.Text

        wdBookmark = wdDoc.Bookmarks("podvygr_pr_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox99.Text <> "" Then
            wdRange.Text = MaskedTextBox99.Text & "с"
        Else
            wdRange.Text = MaskedTextBox99.Text
        End If

        wdBookmark = wdDoc.Bookmarks("podvygr_pr_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox145.Text





        'Передача данных по закладкам
        ''==========================================================================            надо довезти
        wdBookmark = wdDoc.Bookmarks("dovoz")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox87.Text

        wdBookmark = wdDoc.Bookmarks("dovoz_kr")
        wdRange = wdBookmark.Range
        If Val(Label186.Text) > 0 Then
            wdRange.Text = Label186.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("dovoz_kr_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox100.Text

        wdBookmark = wdDoc.Bookmarks("dovoz_kr_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox146.Text

        wdBookmark = wdDoc.Bookmarks("dovoz_kr_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox101.Text <> "" Then
            wdRange.Text = MaskedTextBox101.Text & "с"
        Else
            wdRange.Text = MaskedTextBox101.Text
        End If

        wdBookmark = wdDoc.Bookmarks("dovoz_kr_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox147.Text




        wdBookmark = wdDoc.Bookmarks("dovoz_pl")
        wdRange = wdBookmark.Range
        If Val(Label183.Text) > 0 Then
            wdRange.Text = Label183.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("dovoz_pl_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox102.Text

        wdBookmark = wdDoc.Bookmarks("dovoz_pl_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox148.Text

        wdBookmark = wdDoc.Bookmarks("dovoz_pl_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox103.Text <> "" Then
            wdRange.Text = MaskedTextBox103.Text & "с"
        Else
            wdRange.Text = MaskedTextBox103.Text
        End If

        wdBookmark = wdDoc.Bookmarks("dovoz_pl_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox149.Text



        wdBookmark = wdDoc.Bookmarks("dovoz_pv")
        wdRange = wdBookmark.Range
        If Val(Label180.Text) > 0 Then
            wdRange.Text = Label180.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("dovoz_pv_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox104.Text

        wdBookmark = wdDoc.Bookmarks("dovoz_pv_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox150.Text

        wdBookmark = wdDoc.Bookmarks("dovoz_pv_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox105.Text <> "" Then
            wdRange.Text = MaskedTextBox105.Text & "с"
        Else
            wdRange.Text = MaskedTextBox105.Text
        End If

        wdBookmark = wdDoc.Bookmarks("dovoz_pv_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox151.Text





        wdBookmark = wdDoc.Bookmarks("dovoz_cs")
        wdRange = wdBookmark.Range
        If Val(Label177.Text) > 0 Then
            wdRange.Text = Label177.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("dovoz_cs_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox106.Text

        wdBookmark = wdDoc.Bookmarks("dovoz_cs_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox152.Text

        wdBookmark = wdDoc.Bookmarks("dovoz_cs_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox107.Text <> "" Then
            wdRange.Text = MaskedTextBox107.Text & "с"
        Else
            wdRange.Text = MaskedTextBox107.Text
        End If

        wdBookmark = wdDoc.Bookmarks("dovoz_cs_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox153.Text



        wdBookmark = wdDoc.Bookmarks("dovoz_pr")
        wdRange = wdBookmark.Range
        If Val(Label28.Text) > 0 Then
            wdRange.Text = Label28.Text
        Else
            wdRange.Text = ""
        End If

        wdBookmark = wdDoc.Bookmarks("dovoz_pr_ip")
        wdRange = wdBookmark.Range
        wdRange.Text = MaskedTextBox108.Text

        wdBookmark = wdDoc.Bookmarks("dovoz_pr_ip_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox154.Text

        wdBookmark = wdDoc.Bookmarks("dovoz_pr_sob")
        wdRange = wdBookmark.Range
        If MaskedTextBox109.Text <> "" Then
            wdRange.Text = MaskedTextBox109.Text & "с"
        Else
            wdRange.Text = MaskedTextBox109.Text
        End If

        wdBookmark = wdDoc.Bookmarks("dovoz_pr_sob_text")
        wdRange = wdBookmark.Range
        wdRange.Text = TextBox155.Text







        'wdApp.Visible = True



        ' Отключите отображение сообщений об ошибках
        wdApp.DisplayAlerts = Word.WdAlertLevel.wdAlertsNone



        ' Распечатайте документ
        wdDoc.PrintOut(Background:=True)

        ' Закройте документ без сохранения изменений
        wdDoc.Close(SaveChanges:=False, OriginalFormat:=False, RouteDocument:=False)

        ' Закройте приложение Word
        wdApp.Quit()






    End Sub






















    Sub CreateDir()
        If My.Computer.FileSystem.DirectoryExists(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text) = False Then
            My.Computer.FileSystem.CreateDirectory(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text)
        End If
    End Sub
    Private Sub Form1_AutoValidateChanged(sender As Object, e As EventArgs) Handles Me.AutoValidateChanged

    End Sub

    Private Sub Form1_FormClosing(sender As Object, e As FormClosingEventArgs) Handles Me.FormClosing
        If My.Computer.FileSystem.FileExists("Z:\mcw\RWData\netstat\online.txt") = True Then
            My.Computer.FileSystem.WriteAllText("Z:\mcw\RWData\netstat\online\" & My.Computer.Name, "-100" & vbCrLf & System.Net.Dns.GetHostByName(System.Net.Dns.GetHostName()).AddressList(0).ToString & vbCrLf & My.Computer.Info.OSFullName & vbCrLf & My.User.Name & vbCrLf & My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\usercode.txt"), False) 'записываем параметр минуты
        End If
    End Sub



    Sub ClearAllTextboxes()
        For Each ctrl As Control In TabPage10.Controls
            If TypeOf ctrl Is TextBox Then
                ' Если элемент управления - TextBox, очистите его содержимое
                CType(ctrl, TextBox).Clear()
            End If
        Next

    End Sub




    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        If My.Computer.FileSystem.DirectoryExists(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt")) = False Then


            MsgBox("Не найдены ресурсы, необходимые для работы (проверьте файлы настроек), приложение будет закрыто.")
            Me.Close()
        Else
            Me.Hide()


            'Me.Hide()
            'Настройки для лайт версии (отключение функций)
            'настройка видимости вкладок
            TabShow(TabControl1, TabPage1, False)
            TabShow(TabControl1, TabPage3, False)
            TabShow(TabControl1, TabPage4, False)
            TabShow(TabControl1, TabPage5, False)
            TabShow(TabControl1, TabPage6, False)
            TabShow(TabControl1, TabPage7, False)
            'отключение не нужных таймеров
            Timer1.Enabled = False
            Timer2.Enabled = False
            Timer3.Enabled = False
            Timer4.Enabled = False
            Timer5.Enabled = False
            Timer7.Enabled = False

            DateTimePicker1.Format = DateTimePickerFormat.Custom
            DateTimePicker1.CustomFormat = "dd MMMM yyyy'г.'"

            Me.WindowState = FormWindowState.Maximized ' окно на весь экран

            'Выравнивание групп боксов
            GrWin()
            Version = " v.1.12.06L"

            'WebBrowser1.Navigate(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Information.mht")

            Refresh()

            'SplashScreen1.Show()
            'SplashScreen1.Refresh()
            '
            ' SplashScreen1.ProgressBar1.Maximum = 100

            Label112.Text = "Готово"

            ' If My.Computer.FileSystem.FileExists(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\busy.txt") = True Then
            ' BusyFile = 1
            'Else
            ' BusyFile = 0
            ' End If


            'выравнивание первого столбца в суточном плане

            For i = 1 To 5
                Dim arrTable2 As TableLayoutPanel = TableLayoutPanel6.Controls("TableLayoutPanel" & i)
                arrTable2.ColumnStyles(0).SizeType = SizeType.Absolute
                arrTable2.ColumnStyles(0).Width = 60
            Next i


            For i = 7 To 16
                Dim arrTable2 As TableLayoutPanel = TableLayoutPanel6.Controls("TableLayoutPanel" & i)
                arrTable2.ColumnStyles(0).SizeType = SizeType.Absolute
                arrTable2.ColumnStyles(0).Width = 60
            Next i

            For i = 22 To 31
                Dim arrTable2 As TableLayoutPanel = TableLayoutPanel6.Controls("TableLayoutPanel" & i)
                arrTable2.ColumnStyles(0).SizeType = SizeType.Absolute
                arrTable2.ColumnStyles(0).Width = 60
            Next i



            ' GrantedAccess()


            'ПОЛУчение времени изменения файлов всех
            ' lastTime(1) = My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Information.mht").LastWriteTime()
            'lastTime(2) = My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\DLoad.mht").LastWriteTime()
            'lastTime(3) = My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\LCTOLoad.mht").LastWriteTime()
            ' lastTime(4) = My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\PLoad.mht").LastWriteTime()
            'lastTime(5) = My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\OKLoad.mht").LastWriteTime()
            'lastTime(5) = My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\bd.mht").LastWriteTime()
            'lastTime(5) = My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\ot.mht").LastWriteTime()

            Dim D As Date = Now


            Label45.Text = Format(D, "dd MMMM yyyyг.")
            Me.Text = Format(D, "dd MMMM yyyyг.") & " РЕЧИЦА БЧ " & Version
            'GroupBox4.Text = "Выполнение показателей за " & Format(D, "dd MMMM")

            LoadEnd = 0







            '======== ЗАГРУЗКА вкладки БЕЗОПАСНОСТЬ ДВИЖЕНИЯ


            'If My.Computer.FileSystem.FileExists(Application.StartupPath & "\myname.txt") = True Then
            'Label1.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt")
            'Me.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt") & " - E-Library"
            'End If


            '======== ОБЪЯВЛЯЕМ ПЕРЕМЕННЫЕ ИЛИ СБРАСЫВАЕМ ТУТ

            Dim RW As Long = 0


            ' SplashScreen1.ProgressBar1.Value = 25
            'SplashScreen1.Refresh()

            '======== ЗАГРУЗКА вкладки ДОКУМЕНТЫ  - делать это только когда нажимаешь вкладку документы




            '====================== Загрузка RichTextBox ов

            'webLoadAll()





            LoadEnd = 1


            'SplashScreen1.ProgressBar1.Value = 35
            ' SplashScreen1.Refresh()
            '
            '======== ЗАГРУЗКА вкладки Суточный план

            LoadEnd = 0

            Me.Show()

            TableLayoutPanel6.Visible = False
            Label22.Visible = True
            Label22.Refresh()

            SPLoad()
            Label22.Visible = False
            TableLayoutPanel6.Visible = True




            If Val(TextBox11.Text) > 0 Then
                Label48.Text = TextBox11.Text & " ="


                If Val(Label47.Text) > 0 Then Label48.Text = Label48.Text & " кр" & Label47.Text
                If Val(Label52.Text) > 0 Then Label48.Text = Label48.Text & " пл" & Label52.Text
                If Val(Label59.Text) > 0 Then Label48.Text = Label48.Text & " пв" & Label59.Text
                If Val(Label62.Text) > 0 Then Label48.Text = Label48.Text & " цс" & Label62.Text
                If Val(Label65.Text) > 0 Then Label48.Text = Label48.Text & " пр" & Label65.Text

            End If


            If Val(TextBox22.Text) > 0 Then
                Label8.Text = TextBox22.Text & " ="

                If Val(Label80.Text) > 0 Then Label8.Text = Label8.Text & " кр" & Label80.Text
                If Val(Label77.Text) > 0 Then Label8.Text = Label8.Text & " пл" & Label77.Text
                If Val(Label74.Text) > 0 Then Label8.Text = Label8.Text & " пв" & Label74.Text
                If Val(Label71.Text) > 0 Then Label8.Text = Label8.Text & " цс" & Label71.Text
                If Val(Label68.Text) > 0 Then Label8.Text = Label8.Text & " пр" & Label68.Text

            End If

            If Val(TextBox45.Text) > 0 Then
                Label9.Text = TextBox45.Text & " ="

                If Val(Label95.Text) > 0 Then Label9.Text = Label9.Text & " кр" & Label95.Text
                If Val(Label92.Text) > 0 Then Label9.Text = Label9.Text & " пл" & Label92.Text
                If Val(Label89.Text) > 0 Then Label9.Text = Label9.Text & " пв" & Label89.Text
                If Val(Label86.Text) > 0 Then Label9.Text = Label9.Text & " цс" & Label86.Text
                If Val(Label83.Text) > 0 Then Label9.Text = Label9.Text & " пр" & Label83.Text

            End If

            If Val(TextBox46.Text) > 0 Then
                Label14.Text = TextBox46.Text & " ="

                If Val(Label110.Text) > 0 Then Label14.Text = Label14.Text & " кр" & Label110.Text
                If Val(Label107.Text) > 0 Then Label14.Text = Label14.Text & " пл" & Label107.Text
                If Val(Label104.Text) > 0 Then Label14.Text = Label14.Text & " пв" & Label104.Text
                If Val(Label101.Text) > 0 Then Label14.Text = Label14.Text & " цс" & Label101.Text
                If Val(Label98.Text) > 0 Then Label14.Text = Label14.Text & " пр" & Label98.Text

            End If
            ' LoadProgress()

            'SplashScreen1.ProgressBar1.Value = 100
            'SplashScreen1.Refresh()
            '

            'Me.Show()

            ' SplashScreen1.Close()


            If My.Computer.FileSystem.DirectoryExists(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text) = True Then

            Else
                My.Computer.FileSystem.CreateDirectory(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text)
            End If




        End If


    End Sub

    Public Sub TabShow(ByVal TabControlName As TabControl, ByVal TabPageName As TabPage, ByVal ShowHide_True_False As Boolean, Optional ByVal Index As Integer = 0)
        If ShowHide_True_False = True Then
            If Not TabControlName.Contains(TabPageName) Then
                TabControlName.TabPages.Insert(Index, TabPageName)
            End If
        ElseIf ShowHide_True_False = False Then
            If TabControlName.Contains(TabPageName) Then
                TabControlName.TabPages.Remove(TabPageName)
            End If
        End If
    End Sub
    Sub LoadTxt(FLN As String)

        If My.Computer.FileSystem.FileExists(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\" & FLN) = True Then

            LoadText1 = My.Computer.FileSystem.ReadAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\" & FLN)

        Else
            LoadText1 = ""
        End If




    End Sub


    Sub IndexationV2()
        Dim DocsPath As String
        Dim InDir As String
        Dim Rw As String
        Dim DocsIn As String
        DocsIn = ""


        DocsPath = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfBD.txt", Encoding.GetEncoding(1251))
        InDir = ""
        Rw = 0



        If My.Computer.FileSystem.DirectoryExists(DocsPath) = True Then

            Dim N As Integer
            Dim Files() As String = IO.Directory.GetFiles(DocsPath, "*", IO.SearchOption.AllDirectories)
            Dim Lines(Files.Length) As String
            'MsgBox(Files.Length - 1)
            If Files.Length > 0 Then
                If Files.Length - 1 <= 0 Then
                    DataGridView1.Rows.Insert(DataGridView1.RowCount - 1, Files.Length)
                Else
                    DataGridView1.Rows.Insert(DataGridView1.RowCount - 1, Files.Length - 1)
                End If



                ' DataGridView1.Rows.Insert(DataGridView1.RowCount - 1, Files.Length - 1)
                ' ProgressBar1.Maximum = Files.Length - 1

                For I As Long = 0 To Files.Length - 1
                    Lines(I + 1) = Files(I)
                    'Lines(I + 1) = Replace(Lines(I + 1), "E:/Печать/", "")
                    '  ProgressBar1.Value = I
                    '  ProgressBar1.Refresh()

                    WriteRows(Rw, Files(I), I)
                    Rw = Rw + 1
                    N = N + 1
                Next
            End If

        Else

            MsgBox("Нет сети: проверьте подключение. Приложение будет будет закрыто.", MsgBoxStyle.Critical)
            Me.Close()
        End If




    End Sub



    Sub WriteRows(rw As String, Indir As String, i As Long)

        'MsgBox(My.Computer.FileSystem.GetFiles(DocsPath).Item(i)) '-----------------------получение имени файла в папке
        DataGridView1.Rows(rw).Cells(0).Value = rw + 1
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileBD.txt", rw + 1 & vbCrLf, True)

        DataGridView1.Rows(rw).Cells(1).Value = My.Computer.FileSystem.GetFileInfo(Indir).Name
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileBD.txt", My.Computer.FileSystem.GetFileInfo(Indir).Name & vbCrLf, True)

        DataGridView1.Rows(rw).Cells(2).Value = My.Computer.FileSystem.GetFileInfo(Indir).FullName
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileBD.txt", My.Computer.FileSystem.GetFileInfo(Indir).FullName & vbCrLf, True)


        DataGridView1.Rows(rw).Cells(3).Value = My.Computer.FileSystem.GetFileInfo(Indir).LastWriteTime.ToString
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileBD.txt", My.Computer.FileSystem.GetFileInfo(Indir).LastWriteTime.ToString & vbCrLf, True)

        DataGridView1.Rows(rw).Cells(4).Value = My.Computer.FileSystem.GetFileInfo(Indir).Length & " байт"
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileBD.txt", My.Computer.FileSystem.GetFileInfo(Indir).Length & vbCrLf, True)

        FileSazes = FileSazes + My.Computer.FileSystem.GetFileInfo(Indir).Length


        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\FileSize.txt", FileSazes, False)


        If My.Computer.FileSystem.GetFileInfo(Indir).Length > 1024 Then
            DataGridView1.Rows(rw).Cells(4).Value = Math.Round(My.Computer.FileSystem.GetFileInfo(Indir).Length / 1024, 0) & " Кб"
        End If
        If My.Computer.FileSystem.GetFileInfo(Indir).Length > 1048576 Then
            DataGridView1.Rows(rw).Cells(4).Value = Math.Round(My.Computer.FileSystem.GetFileInfo(Indir).Length / 1048576, 0) & " Мб"
        End If
        If My.Computer.FileSystem.GetFileInfo(Indir).Length > 1073741824 Then
            DataGridView1.Rows(rw).Cells(4).Value = Math.Round(My.Computer.FileSystem.GetFileInfo(Indir).Length / 1073741824, 0) & " Гб"
        End If

        ' MsgBox(Rw)
        rw = rw + 1

    End Sub



    Sub IndexationOT()
        Dim DocsPath As String
        Dim InDir As String
        Dim Rw As String
        Dim DocsIn As String
        DocsIn = ""


        DocsPath = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfOT.txt", Encoding.GetEncoding(1251))
        InDir = ""
        Rw = 0



        If My.Computer.FileSystem.DirectoryExists(DocsPath) = True Then

            Dim N As Integer
            Dim Files() As String = IO.Directory.GetFiles(DocsPath, "*", IO.SearchOption.AllDirectories)
            Dim Lines(Files.Length) As String
            'MsgBox(Files.Length - 1)

            If Files.Length > 0 Then
                If Files.Length - 1 <= 0 Then
                    DataGridView3.Rows.Insert(DataGridView3.RowCount - 1, Files.Length)
                Else
                    DataGridView3.Rows.Insert(DataGridView3.RowCount - 1, Files.Length - 1)
                End If



                ' DataGridView3.Rows.Insert(DataGridView3.RowCount - 1, Files.Length - 1)
                'ProgressBar1.Maximum = Files.Length - 1

                For I As Long = 0 To Files.Length - 1
                    Lines(I + 1) = Files(I)
                    'Lines(I + 1) = Replace(Lines(I + 1), "E:/Печать/", "")
                    '   ProgressBar1.Value = I
                    '   ProgressBar1.Refresh()

                    WriteRowsOT(Rw, Files(I), I)
                    Rw = Rw + 1
                    N = N + 1

                Next
            End If




        Else
            MsgBox("Папка с документами не найдена. Проверьте подключения к локальным и сетевым накопителям.", MsgBoxStyle.Critical)
        End If




    End Sub



    Sub WriteRowsOT(rw As String, Indir As String, i As Long)

        'MsgBox(My.Computer.FileSystem.GetFiles(DocsPath).Item(i)) '-----------------------получение имени файла в папке
        DataGridView3.Rows(rw).Cells(0).Value = rw + 1
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileOT.txt", rw + 1 & vbCrLf, True)

        DataGridView3.Rows(rw).Cells(1).Value = My.Computer.FileSystem.GetFileInfo(Indir).Name
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileOT.txt", My.Computer.FileSystem.GetFileInfo(Indir).Name & vbCrLf, True)

        DataGridView3.Rows(rw).Cells(2).Value = My.Computer.FileSystem.GetFileInfo(Indir).FullName
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileOT.txt", My.Computer.FileSystem.GetFileInfo(Indir).FullName & vbCrLf, True)


        DataGridView3.Rows(rw).Cells(3).Value = My.Computer.FileSystem.GetFileInfo(Indir).LastWriteTime.ToString
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileOT.txt", My.Computer.FileSystem.GetFileInfo(Indir).LastWriteTime.ToString & vbCrLf, True)

        DataGridView3.Rows(rw).Cells(4).Value = My.Computer.FileSystem.GetFileInfo(Indir).Length & " байт"
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileOT.txt", My.Computer.FileSystem.GetFileInfo(Indir).Length & vbCrLf, True)

        FileSazes = FileSazes + My.Computer.FileSystem.GetFileInfo(Indir).Length


        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\FileSize.txt", FileSazes, False)


        If My.Computer.FileSystem.GetFileInfo(Indir).Length > 1024 Then
            DataGridView3.Rows(rw).Cells(4).Value = Math.Round(My.Computer.FileSystem.GetFileInfo(Indir).Length / 1024, 0) & " Кб"
        End If
        If My.Computer.FileSystem.GetFileInfo(Indir).Length > 1048576 Then
            DataGridView3.Rows(rw).Cells(4).Value = Math.Round(My.Computer.FileSystem.GetFileInfo(Indir).Length / 1048576, 0) & " Мб"
        End If
        If My.Computer.FileSystem.GetFileInfo(Indir).Length > 1073741824 Then
            DataGridView3.Rows(rw).Cells(4).Value = Math.Round(My.Computer.FileSystem.GetFileInfo(Indir).Length / 1073741824, 0) & " Гб"
        End If

        ' MsgBox(Rw)
        rw = rw + 1

    End Sub




    Sub IndexationIN()
        Dim DocsPath As String
        Dim InDir As String
        Dim Rw As String
        Dim DocsIn As String
        DocsIn = ""


        DocsPath = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfIN.txt", Encoding.GetEncoding(1251))
        InDir = ""
        Rw = 0



        If My.Computer.FileSystem.DirectoryExists(DocsPath) = True Then

            Dim N As Integer
            Dim Files() As String = IO.Directory.GetFiles(DocsPath, "*", IO.SearchOption.AllDirectories)
            Dim Lines(Files.Length) As String
            '   MsgBox(Files.Length)
            If Files.Length > 0 Then
                If Files.Length - 1 <= 0 Then
                    DataGridView5.Rows.Insert(DataGridView5.RowCount - 1, Files.Length)
                Else
                    DataGridView5.Rows.Insert(DataGridView5.RowCount - 1, Files.Length - 1)
                End If

                'ProgressBar1.Maximum = Files.Length - 1

                For I As Long = 0 To Files.Length - 1
                    Lines(I + 1) = Files(I)
                    'Lines(I + 1) = Replace(Lines(I + 1), "E:/Печать/", "")
                    '   ProgressBar1.Value = I
                    '   ProgressBar1.Refresh()

                    WriteRowsIN(Rw, Files(I), I)
                    Rw = Rw + 1
                    N = N + 1

                Next


            End If


        Else
            MsgBox("Папка с документами не найдена. Проверьте подключения к локальным и сетевым накопителям.", MsgBoxStyle.Critical)
        End If




    End Sub



    Sub WriteRowsIN(rw As String, Indir As String, i As Long)

        'MsgBox(My.Computer.FileSystem.GetFiles(DocsPath).Item(i)) '-----------------------получение имени файла в папке
        DataGridView5.Rows(rw).Cells(0).Value = rw + 1
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileIT.txt", rw + 1 & vbCrLf, True)

        DataGridView5.Rows(rw).Cells(1).Value = My.Computer.FileSystem.GetFileInfo(Indir).Name
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileIT.txt", My.Computer.FileSystem.GetFileInfo(Indir).Name & vbCrLf, True)

        DataGridView5.Rows(rw).Cells(2).Value = My.Computer.FileSystem.GetFileInfo(Indir).FullName
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileIT.txt", My.Computer.FileSystem.GetFileInfo(Indir).FullName & vbCrLf, True)


        DataGridView5.Rows(rw).Cells(3).Value = My.Computer.FileSystem.GetFileInfo(Indir).LastWriteTime.ToString
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileIT.txt", My.Computer.FileSystem.GetFileInfo(Indir).LastWriteTime.ToString & vbCrLf, True)

        DataGridView5.Rows(rw).Cells(4).Value = My.Computer.FileSystem.GetFileInfo(Indir).Length & " байт"
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileIT.txt", My.Computer.FileSystem.GetFileInfo(Indir).Length & vbCrLf, True)

        FileSazes = FileSazes + My.Computer.FileSystem.GetFileInfo(Indir).Length


        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\FileSize.txt", FileSazes, False)


        If My.Computer.FileSystem.GetFileInfo(Indir).Length > 1024 Then
            DataGridView5.Rows(rw).Cells(4).Value = Math.Round(My.Computer.FileSystem.GetFileInfo(Indir).Length / 1024, 0) & " Кб"
        End If
        If My.Computer.FileSystem.GetFileInfo(Indir).Length > 1048576 Then
            DataGridView5.Rows(rw).Cells(4).Value = Math.Round(My.Computer.FileSystem.GetFileInfo(Indir).Length / 1048576, 0) & " Мб"
        End If
        If My.Computer.FileSystem.GetFileInfo(Indir).Length > 1073741824 Then
            DataGridView5.Rows(rw).Cells(4).Value = Math.Round(My.Computer.FileSystem.GetFileInfo(Indir).Length / 1073741824, 0) & " Гб"
        End If

        ' MsgBox(Rw)
        rw = rw + 1

    End Sub



    Sub IndexationDOC()
        Dim DocsPath As String
        Dim InDir As String
        Dim Rw As String
        Dim DocsIn As String
        DocsIn = ""


        DocsPath = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfDOC.txt", Encoding.GetEncoding(1251))
        InDir = ""
        Rw = 0



        If My.Computer.FileSystem.DirectoryExists(DocsPath) = True Then

            Dim N As Integer
            Dim Files() As String = IO.Directory.GetFiles(DocsPath, "*", IO.SearchOption.AllDirectories)
            Dim Lines(Files.Length) As String
            'MsgBox(Files.Length - 1)
            '  DataGridView7.Rows.Insert(DataGridView7.RowCount - 1, Files.Length - 1)


            If Files.Length > 0 Then

                If Files.Length - 1 <= 0 Then
                    DataGridView7.Rows.Insert(DataGridView7.RowCount - 1, Files.Length)
                Else
                    DataGridView7.Rows.Insert(DataGridView7.RowCount - 1, Files.Length - 1)
                End If


                ProgressBar14.Maximum = Files.Length

                'SplashScreen1.ProgressBar1.Maximum = DataGridView7.RowCount

                ' ProgressBar1.Maximum = Files.Length - 1

                For I As Long = 0 To Files.Length - 1
                    '  SplashScreen1.ProgressBar1.Value = I
                    ' SplashScreen1.Refresh()


                    ProgressBar14.Value = I
                    ProgressBar14.Refresh()



                    Lines(I + 1) = Files(I)
                    'Lines(I + 1) = Replace(Lines(I + 1), "E:/Печать/", "")
                    '   ProgressBar1.Value = I
                    '   ProgressBar1.Refresh()

                    WriteRowsDOC(Rw, Files(I), I)
                    Rw = Rw + 1
                    N = N + 1

                Next



            End If

        Else
            MsgBox("Папка с документами не найдена. Проверьте подключения к локальным и сетевым накопителям.", MsgBoxStyle.Critical)
        End If




    End Sub



    Sub WriteRowsDOC(rw As String, Indir As String, i As Long)

        'MsgBox(My.Computer.FileSystem.GetFiles(DocsPath).Item(i)) '-----------------------получение имени файла в папке
        DataGridView7.Rows(rw).Cells(0).Value = rw + 1
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileDOC.txt", rw + 1 & vbCrLf, True)

        DataGridView7.Rows(rw).Cells(1).Value = My.Computer.FileSystem.GetFileInfo(Indir).Name
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileDOC.txt", My.Computer.FileSystem.GetFileInfo(Indir).Name & vbCrLf, True)

        DataGridView7.Rows(rw).Cells(2).Value = My.Computer.FileSystem.GetFileInfo(Indir).FullName
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileDOC.txt", My.Computer.FileSystem.GetFileInfo(Indir).FullName & vbCrLf, True)


        DataGridView7.Rows(rw).Cells(3).Value = My.Computer.FileSystem.GetFileInfo(Indir).LastWriteTime.ToString
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileDOC.txt", My.Computer.FileSystem.GetFileInfo(Indir).LastWriteTime.ToString & vbCrLf, True)

        DataGridView7.Rows(rw).Cells(4).Value = My.Computer.FileSystem.GetFileInfo(Indir).Length & " байт"
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileDOC.txt", My.Computer.FileSystem.GetFileInfo(Indir).Length & vbCrLf, True)

        FileSazes = FileSazes + My.Computer.FileSystem.GetFileInfo(Indir).Length


        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\FileSize.txt", FileSazes, False)


        If My.Computer.FileSystem.GetFileInfo(Indir).Length > 1024 Then
            DataGridView7.Rows(rw).Cells(4).Value = Math.Round(My.Computer.FileSystem.GetFileInfo(Indir).Length / 1024, 0) & " Кб"
        End If
        If My.Computer.FileSystem.GetFileInfo(Indir).Length > 1048576 Then
            DataGridView7.Rows(rw).Cells(4).Value = Math.Round(My.Computer.FileSystem.GetFileInfo(Indir).Length / 1048576, 0) & " Мб"
        End If
        If My.Computer.FileSystem.GetFileInfo(Indir).Length > 1073741824 Then
            DataGridView7.Rows(rw).Cells(4).Value = Math.Round(My.Computer.FileSystem.GetFileInfo(Indir).Length / 1073741824, 0) & " Гб"
        End If

        ' MsgBox(Rw)
        rw = rw + 1

    End Sub








    Private Sub Form1_SizeChanged(sender As Object, e As EventArgs) Handles Me.SizeChanged
        GrWin()


    End Sub

    Private Sub TextBoxes_GotFocus(sender As Object, e As EventArgs) Handles MaskedTextBox52.GotFocus,
        MaskedTextBox1.GotFocus,
        MaskedTextBox2.GotFocus,
        MaskedTextBox52.GotFocus,
        MaskedTextBox53.GotFocus,
        MaskedTextBox54.GotFocus,
        MaskedTextBox55.GotFocus,
        MaskedTextBox56.GotFocus,
        MaskedTextBox57.GotFocus,
        MaskedTextBox58.GotFocus,
        MaskedTextBox59.GotFocus,
        MaskedTextBox60.GotFocus,
        MaskedTextBox61.GotFocus,
        MaskedTextBox62.GotFocus,
        MaskedTextBox63.GotFocus,
        MaskedTextBox64.GotFocus,
        MaskedTextBox65.GotFocus,
        MaskedTextBox66.GotFocus,
        MaskedTextBox67.GotFocus,
        MaskedTextBox68.GotFocus,
        MaskedTextBox69.GotFocus,
        MaskedTextBox70.GotFocus,
        MaskedTextBox71.GotFocus,
        MaskedTextBox72.GotFocus,
        MaskedTextBox73.GotFocus,
        MaskedTextBox74.GotFocus,
        MaskedTextBox75.GotFocus,
        MaskedTextBox76.GotFocus,
        MaskedTextBox77.GotFocus,
        MaskedTextBox78.GotFocus,
        MaskedTextBox79.GotFocus,
        MaskedTextBox90.GotFocus,
        MaskedTextBox91.GotFocus,
        MaskedTextBox92.GotFocus,
        MaskedTextBox93.GotFocus,
        MaskedTextBox94.GotFocus,
        MaskedTextBox95.GotFocus,
        MaskedTextBox96.GotFocus,
        MaskedTextBox97.GotFocus,
        MaskedTextBox98.GotFocus,
        MaskedTextBox99.GotFocus,
        MaskedTextBox100.GotFocus,
        MaskedTextBox101.GotFocus,
        MaskedTextBox102.GotFocus,
        MaskedTextBox103.GotFocus,
        MaskedTextBox104.GotFocus,
        MaskedTextBox105.GotFocus,
        MaskedTextBox106.GotFocus,
        MaskedTextBox107.GotFocus,
        MaskedTextBox108.GotFocus,
        MaskedTextBox109.GotFocus,
        TextBox34.GotFocus,
        TextBox88.GotFocus,
        TextBox3.GotFocus,
        TextBox4.GotFocus,
        TextBox99.GotFocus,
        TextBox100.GotFocus,
        TextBox101.GotFocus,
        TextBox102.GotFocus,
        TextBox103.GotFocus,
        TextBox104.GotFocus,
        TextBox105.GotFocus,
        TextBox106.GotFocus,
        TextBox107.GotFocus,
        TextBox108.GotFocus,
        TextBox109.GotFocus,
        TextBox110.GotFocus,
        TextBox111.GotFocus,
        TextBox112.GotFocus,
        TextBox113.GotFocus,
        TextBox114.GotFocus,
        TextBox115.GotFocus,
        TextBox116.GotFocus,
        TextBox117.GotFocus,
        TextBox118.GotFocus,
        TextBox119.GotFocus,
        TextBox120.GotFocus,
        TextBox121.GotFocus,
        TextBox122.GotFocus,
        TextBox123.GotFocus,
        TextBox124.GotFocus,
        TextBox125.GotFocus,
        TextBox136.GotFocus,
        TextBox137.GotFocus,
        TextBox138.GotFocus,
        TextBox139.GotFocus,
        TextBox140.GotFocus,
        TextBox141.GotFocus,
        TextBox142.GotFocus,
        TextBox143.GotFocus,
        TextBox144.GotFocus,
        TextBox145.GotFocus,
        TextBox146.GotFocus,
        TextBox147.GotFocus,
        TextBox148.GotFocus,
        TextBox149.GotFocus,
        TextBox150.GotFocus,
        TextBox151.GotFocus,
        TextBox152.GotFocus,
        TextBox153.GotFocus,
        TextBox154.GotFocus,
        TextBox155.GotFocus




        'все делаем стандартным цветом

        MaskedTextBox52.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox53.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox1.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox2.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox54.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox55.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox56.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox57.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox58.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox59.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox60.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox61.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox62.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox63.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox64.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox65.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox66.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox67.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox68.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox69.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox70.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox71.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox72.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox73.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox74.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox75.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox76.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox77.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox78.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox79.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox90.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox91.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox92.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox93.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox94.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox95.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox96.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox97.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox98.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox99.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox100.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox101.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox102.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox103.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox104.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox105.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox106.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox107.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox108.BackColor = Color.FromArgb(218, 229, 242)
        MaskedTextBox109.BackColor = Color.FromArgb(218, 229, 242)
        TextBox34.BackColor = Color.FromArgb(218, 229, 242)
        TextBox88.BackColor = Color.FromArgb(218, 229, 242)
        TextBox3.BackColor = Color.FromArgb(218, 229, 242)
        TextBox4.BackColor = Color.FromArgb(218, 229, 242)
        TextBox99.BackColor = Color.FromArgb(218, 229, 242)
        TextBox100.BackColor = Color.FromArgb(218, 229, 242)
        TextBox101.BackColor = Color.FromArgb(218, 229, 242)
        TextBox102.BackColor = Color.FromArgb(218, 229, 242)
        TextBox103.BackColor = Color.FromArgb(218, 229, 242)
        TextBox104.BackColor = Color.FromArgb(218, 229, 242)
        TextBox105.BackColor = Color.FromArgb(218, 229, 242)
        TextBox106.BackColor = Color.FromArgb(218, 229, 242)
        TextBox107.BackColor = Color.FromArgb(218, 229, 242)
        TextBox108.BackColor = Color.FromArgb(218, 229, 242)
        TextBox109.BackColor = Color.FromArgb(218, 229, 242)
        TextBox110.BackColor = Color.FromArgb(218, 229, 242)
        TextBox111.BackColor = Color.FromArgb(218, 229, 242)
        TextBox112.BackColor = Color.FromArgb(218, 229, 242)
        TextBox113.BackColor = Color.FromArgb(218, 229, 242)
        TextBox114.BackColor = Color.FromArgb(218, 229, 242)
        TextBox115.BackColor = Color.FromArgb(218, 229, 242)
        TextBox116.BackColor = Color.FromArgb(218, 229, 242)
        TextBox117.BackColor = Color.FromArgb(218, 229, 242)
        TextBox118.BackColor = Color.FromArgb(218, 229, 242)
        TextBox119.BackColor = Color.FromArgb(218, 229, 242)
        TextBox120.BackColor = Color.FromArgb(218, 229, 242)
        TextBox121.BackColor = Color.FromArgb(218, 229, 242)
        TextBox122.BackColor = Color.FromArgb(218, 229, 242)
        TextBox123.BackColor = Color.FromArgb(218, 229, 242)
        TextBox124.BackColor = Color.FromArgb(218, 229, 242)
        TextBox125.BackColor = Color.FromArgb(218, 229, 242)
        TextBox136.BackColor = Color.FromArgb(218, 229, 242)
        TextBox137.BackColor = Color.FromArgb(218, 229, 242)
        TextBox138.BackColor = Color.FromArgb(218, 229, 242)
        TextBox139.BackColor = Color.FromArgb(218, 229, 242)
        TextBox140.BackColor = Color.FromArgb(218, 229, 242)
        TextBox141.BackColor = Color.FromArgb(218, 229, 242)
        TextBox142.BackColor = Color.FromArgb(218, 229, 242)
        TextBox143.BackColor = Color.FromArgb(218, 229, 242)
        TextBox144.BackColor = Color.FromArgb(218, 229, 242)
        TextBox145.BackColor = Color.FromArgb(218, 229, 242)
        TextBox146.BackColor = Color.FromArgb(218, 229, 242)
        TextBox147.BackColor = Color.FromArgb(218, 229, 242)
        TextBox148.BackColor = Color.FromArgb(218, 229, 242)
        TextBox149.BackColor = Color.FromArgb(218, 229, 242)
        TextBox150.BackColor = Color.FromArgb(218, 229, 242)
        TextBox151.BackColor = Color.FromArgb(218, 229, 242)
        TextBox152.BackColor = Color.FromArgb(218, 229, 242)
        TextBox153.BackColor = Color.FromArgb(218, 229, 242)
        TextBox154.BackColor = Color.FromArgb(218, 229, 242)
        TextBox155.BackColor = Color.FromArgb(218, 229, 242)


        'выделение зеленым выбранный



        ActiveControl.BackColor = Color.LightGreen




        '  My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\busy.txt", "busy", False)


    End Sub





    Private Sub MaskedTextBoxes_TextChanged(sender As Object, e As EventArgs) Handles MaskedTextBox53.TextChanged, MaskedTextBox52.TextChanged, MaskedTextBox54.TextChanged,
       MaskedTextBox55.TextChanged, MaskedTextBox59.TextChanged, MaskedTextBox56.TextChanged, MaskedTextBox57.TextChanged, MaskedTextBox1.TextChanged, MaskedTextBox2.TextChanged,
       MaskedTextBox58.TextChanged, MaskedTextBox60.TextChanged, MaskedTextBox61.TextChanged, MaskedTextBox62.TextChanged,
       MaskedTextBox63.TextChanged, MaskedTextBox64.TextChanged, MaskedTextBox65.TextChanged, MaskedTextBox66.TextChanged,
       MaskedTextBox67.TextChanged, MaskedTextBox68.TextChanged, MaskedTextBox69.TextChanged, MaskedTextBox70.TextChanged,
       MaskedTextBox71.TextChanged, MaskedTextBox72.TextChanged, MaskedTextBox73.TextChanged, MaskedTextBox74.TextChanged,
       MaskedTextBox75.TextChanged, MaskedTextBox76.TextChanged, MaskedTextBox77.TextChanged, MaskedTextBox78.TextChanged,
       MaskedTextBox79.TextChanged, MaskedTextBox90.TextChanged, MaskedTextBox91.TextChanged, MaskedTextBox92.TextChanged,
       MaskedTextBox93.TextChanged, MaskedTextBox94.TextChanged, MaskedTextBox95.TextChanged, MaskedTextBox96.TextChanged,
       MaskedTextBox97.TextChanged, MaskedTextBox98.TextChanged, MaskedTextBox99.TextChanged, MaskedTextBox100.TextChanged,
       MaskedTextBox101.TextChanged, MaskedTextBox102.TextChanged, MaskedTextBox103.TextChanged, MaskedTextBox104.TextChanged,
       MaskedTextBox105.TextChanged, MaskedTextBox106.TextChanged, MaskedTextBox107.TextChanged, MaskedTextBox108.TextChanged,
       MaskedTextBox109.TextChanged, MaskedTextBox53.TextChanged, MaskedTextBox52.TextChanged, MaskedTextBox59.TextChanged, MaskedTextBox58.TextChanged,
       MaskedTextBox57.TextChanged, MaskedTextBox56.TextChanged, MaskedTextBox55.TextChanged, MaskedTextBox54.TextChanged, MaskedTextBox99.TextChanged,
       MaskedTextBox98.TextChanged, MaskedTextBox97.TextChanged, MaskedTextBox96.TextChanged, MaskedTextBox95.TextChanged, MaskedTextBox94.TextChanged,
       MaskedTextBox93.TextChanged, MaskedTextBox92.TextChanged, MaskedTextBox91.TextChanged, MaskedTextBox90.TextChanged, MaskedTextBox79.TextChanged,
       MaskedTextBox78.TextChanged, MaskedTextBox77.TextChanged, MaskedTextBox76.TextChanged, MaskedTextBox75.TextChanged, MaskedTextBox74.TextChanged,
       MaskedTextBox73.TextChanged, MaskedTextBox72.TextChanged, MaskedTextBox71.TextChanged, MaskedTextBox70.TextChanged, MaskedTextBox69.TextChanged,
       MaskedTextBox68.TextChanged, MaskedTextBox67.TextChanged, MaskedTextBox66.TextChanged, MaskedTextBox65.TextChanged, MaskedTextBox64.TextChanged,
       MaskedTextBox63.TextChanged, MaskedTextBox62.TextChanged, MaskedTextBox61.TextChanged, MaskedTextBox60.TextChanged, MaskedTextBox109.TextChanged,
       MaskedTextBox108.TextChanged, MaskedTextBox107.TextChanged, MaskedTextBox106.TextChanged, MaskedTextBox105.TextChanged, MaskedTextBox104.TextChanged,
       MaskedTextBox103.TextChanged, MaskedTextBox102.TextChanged, MaskedTextBox101.TextChanged, MaskedTextBox100.TextChanged, MaskedTextBox1.TextChanged, MaskedTextBox2.TextChanged




        'Считаем сумму погрузки
        Label47.Text = Val(MaskedTextBox1.Text) + Val(MaskedTextBox2.Text) 'кр
        Label52.Text = Val(MaskedTextBox53.Text) + Val(MaskedTextBox52.Text) 'пл
        Label59.Text = Val(MaskedTextBox55.Text) + Val(MaskedTextBox54.Text) 'пв
        Label62.Text = Val(MaskedTextBox57.Text) + Val(MaskedTextBox56.Text) 'цс
        Label65.Text = Val(MaskedTextBox59.Text) + Val(MaskedTextBox58.Text) 'пр
        Dim ПогрузкаСП As Long = Val(Label47.Text) + Val(Label52.Text) + Val(Label59.Text) + Val(Label62.Text) + Val(Label65.Text)
        TextBox11.Text = ПогрузкаСП
        Label189.Text = "Погрузка - " & TextBox11.Text
        'Me.Text = TextBox11.Text
        'Считаем сумму выгрузки
        Label80.Text = Val(MaskedTextBox60.Text) + Val(MaskedTextBox61.Text) 'кр
        Label77.Text = Val(MaskedTextBox62.Text) + Val(MaskedTextBox63.Text) 'пл
        Label74.Text = Val(MaskedTextBox64.Text) + Val(MaskedTextBox65.Text) 'пв
        Label71.Text = Val(MaskedTextBox66.Text) + Val(MaskedTextBox67.Text) 'цс
        Label68.Text = Val(MaskedTextBox68.Text) + Val(MaskedTextBox69.Text) 'пр
        Dim ВыгрузкаСП As Long = Val(Label80.Text) + Val(Label77.Text) + Val(Label74.Text) + Val(Label71.Text) + Val(Label68.Text)
        TextBox22.Text = ВыгрузкаСП
        Label190.Text = "Выгрузка - " & TextBox22.Text

        'Считаем сумму заявки
        Label95.Text = Val(MaskedTextBox70.Text) + Val(MaskedTextBox71.Text) 'кр
        Label92.Text = Val(MaskedTextBox72.Text) + Val(MaskedTextBox73.Text) 'пл
        Label89.Text = Val(MaskedTextBox74.Text) + Val(MaskedTextBox75.Text) 'пв
        Label86.Text = Val(MaskedTextBox76.Text) + Val(MaskedTextBox77.Text) 'цс
        Label83.Text = Val(MaskedTextBox78.Text) + Val(MaskedTextBox79.Text) 'пр
        Dim ЗаявкаСП As Long = Val(Label95.Text) + Val(Label92.Text) + Val(Label89.Text) + Val(Label86.Text) + Val(Label83.Text)
        TextBox45.Text = ЗаявкаСП
        Label191.Text = "Заявка - " & TextBox45.Text

        'Считаем сумму под выгрузкой
        Label110.Text = Val(MaskedTextBox90.Text) + Val(MaskedTextBox91.Text) 'кр
        Label107.Text = Val(MaskedTextBox92.Text) + Val(MaskedTextBox93.Text) 'пл
        Label104.Text = Val(MaskedTextBox94.Text) + Val(MaskedTextBox95.Text) 'пв
        Label101.Text = Val(MaskedTextBox96.Text) + Val(MaskedTextBox97.Text) 'цс
        Label98.Text = Val(MaskedTextBox98.Text) + Val(MaskedTextBox99.Text) 'пр
        Dim ПодвыгрузкойСП As Long = Val(Label110.Text) + Val(Label107.Text) + Val(Label104.Text) + Val(Label101.Text) + Val(Label98.Text)
        TextBox46.Text = ПодвыгрузкойСП
        Label193.Text = "Под выгрузкой - " & TextBox46.Text

        'Считаем сумму переход после 18
        Label186.Text = Val(MaskedTextBox100.Text) + Val(MaskedTextBox101.Text) 'кр
        Label183.Text = Val(MaskedTextBox102.Text) + Val(MaskedTextBox103.Text) 'пл
        Label180.Text = Val(MaskedTextBox104.Text) + Val(MaskedTextBox105.Text) 'пв
        Label177.Text = Val(MaskedTextBox106.Text) + Val(MaskedTextBox107.Text) 'цс
        Label28.Text = Val(MaskedTextBox108.Text) + Val(MaskedTextBox109.Text) 'пр
        Dim ПереходСП As Long = Val(Label186.Text) + Val(Label183.Text) + Val(Label180.Text) + Val(Label177.Text) + Val(Label28.Text)
        TextBox87.Text = ПереходСП
        Label199.Text = "Нужно довезти - " & TextBox87.Text





        If LoadEnd = 1 Then


            If ActiveControl.Name = "MaskedTextBox1" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_kr1.txt", MaskedTextBox1.Text, False)
                End If
            End If

            If ActiveControl.Name = "MaskedTextBox2" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_kr3.txt", MaskedTextBox2.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox52" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_pl1.txt", MaskedTextBox52.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox53" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_pl3.txt", MaskedTextBox53.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox54" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_pv1.txt", MaskedTextBox54.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox55" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_pv3.txt", MaskedTextBox55.Text, False)
                End If
            End If

            If ActiveControl.Name = "MaskedTextBox56" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_cs1.txt", MaskedTextBox56.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox57" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_cs3.txt", MaskedTextBox57.Text, False)
                End If
            End If



            If ActiveControl.Name = "MaskedTextBox58" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_pr1.txt", MaskedTextBox58.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox59" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_pr3.txt", MaskedTextBox59.Text, False)
                End If
            End If



            If ActiveControl.Name = "MaskedTextBox60" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_kr1.txt", MaskedTextBox60.Text, False)
                End If
            End If




            If ActiveControl.Name = "MaskedTextBox61" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_kr3.txt", MaskedTextBox61.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox62" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_pl1.txt", MaskedTextBox62.Text, False)
                End If
            End If




            If ActiveControl.Name = "MaskedTextBox63" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_pl3.txt", MaskedTextBox63.Text, False)
                End If
            End If



            If ActiveControl.Name = "MaskedTextBox64" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_pv1.txt", MaskedTextBox64.Text, False)
                End If
            End If



            If ActiveControl.Name = "MaskedTextBox65" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_pv3.txt", MaskedTextBox65.Text, False)
                End If
            End If




            If ActiveControl.Name = "MaskedTextBox66" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_cs1.txt", MaskedTextBox66.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox67" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_cs3.txt", MaskedTextBox67.Text, False)
                End If
            End If



            If ActiveControl.Name = "MaskedTextBox68" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_pr1.txt", MaskedTextBox68.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox69" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_pr3.txt", MaskedTextBox69.Text, False)
                End If
            End If



            If ActiveControl.Name = "MaskedTextBox70" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_kr1.txt", MaskedTextBox70.Text, False)
                End If
            End If



            If ActiveControl.Name = "MaskedTextBox71" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_kr3.txt", MaskedTextBox71.Text, False)
                End If
            End If



            If ActiveControl.Name = "MaskedTextBox72" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_pl1.txt", MaskedTextBox72.Text, False)
                End If
            End If

            If ActiveControl.Name = "MaskedTextBox73" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_pl3.txt", MaskedTextBox73.Text, False)
                End If
            End If



            If ActiveControl.Name = "MaskedTextBox74" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_pv1.txt", MaskedTextBox74.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox75" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_pv3.txt", MaskedTextBox75.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox76" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_cs1.txt", MaskedTextBox76.Text, False)
                End If
            End If



            If ActiveControl.Name = "MaskedTextBox77" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_cs3.txt", MaskedTextBox77.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox78" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_pr1.txt", MaskedTextBox78.Text, False)
                End If
            End If





            If ActiveControl.Name = "MaskedTextBox79" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_pr3.txt", MaskedTextBox79.Text, False)
                End If
            End If



            If ActiveControl.Name = "MaskedTextBox90" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_kr1.txt", MaskedTextBox90.Text, False)
                End If
            End If



            If ActiveControl.Name = "MaskedTextBox91" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_kr3.txt", MaskedTextBox91.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox92" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_pl1.txt", MaskedTextBox92.Text, False)
                End If
            End If

            If ActiveControl.Name = "MaskedTextBox93" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_pl3.txt", MaskedTextBox93.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox94" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_pv1.txt", MaskedTextBox94.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox95" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_pv3.txt", MaskedTextBox95.Text, False)
                End If
            End If



            If ActiveControl.Name = "MaskedTextBox96" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_cs1.txt", MaskedTextBox96.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox97" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_cs3.txt", MaskedTextBox97.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox98" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_pr1.txt", MaskedTextBox98.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox99" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_pr3.txt", MaskedTextBox99.Text, False)
                End If
            End If

            If ActiveControl.Name = "MaskedTextBox100" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_kr1.txt", MaskedTextBox100.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox101" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_kr3.txt", MaskedTextBox101.Text, False)
                End If
            End If

            If ActiveControl.Name = "MaskedTextBox102" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_pl1.txt", MaskedTextBox102.Text, False)
                End If
            End If

            If ActiveControl.Name = "MaskedTextBox103" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_pl3.txt", MaskedTextBox103.Text, False)
                End If
            End If


            If ActiveControl.Name = "MaskedTextBox104" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_pv1.txt", MaskedTextBox104.Text, False)
                End If
            End If

            If ActiveControl.Name = "MaskedTextBox105" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_pv3.txt", MaskedTextBox105.Text, False)
                End If
            End If

            If ActiveControl.Name = "MaskedTextBox106" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_cs1.txt", MaskedTextBox106.Text, False)
                End If
            End If

            If ActiveControl.Name = "MaskedTextBox107" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_cs3.txt", MaskedTextBox107.Text, False)
                End If
            End If

            If ActiveControl.Name = "MaskedTextBox108" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_pr1.txt", MaskedTextBox108.Text, False)
                End If
            End If

            If ActiveControl.Name = "MaskedTextBox109" Then
                If LoadEnd = 1 Then
                    My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_pr3.txt", MaskedTextBox109.Text, False)
                End If
            End If


        End If







    End Sub

    Private Sub MaskedTextBox_MouseClick(sender As Object, e As MouseEventArgs) Handles MaskedTextBox52.MouseClick,
        MaskedTextBox53.MouseClick, MaskedTextBox54.MouseClick,
        MaskedTextBox55.MouseClick, MaskedTextBox56.MouseClick,
        MaskedTextBox57.MouseClick, MaskedTextBox58.MouseClick,
        MaskedTextBox59.MouseClick, MaskedTextBox60.MouseClick,
        MaskedTextBox61.MouseClick, MaskedTextBox62.MouseClick,
        MaskedTextBox63.MouseClick, MaskedTextBox64.MouseClick,
        MaskedTextBox65.MouseClick, MaskedTextBox66.MouseClick,
        MaskedTextBox67.MouseClick, MaskedTextBox68.MouseClick,
        MaskedTextBox69.MouseClick, MaskedTextBox70.MouseClick,
        MaskedTextBox71.MouseClick, MaskedTextBox72.MouseClick,
        MaskedTextBox73.MouseClick, MaskedTextBox74.MouseClick,
        MaskedTextBox75.MouseClick, MaskedTextBox76.MouseClick,
        MaskedTextBox77.MouseClick, MaskedTextBox78.MouseClick,
        MaskedTextBox79.MouseClick, MaskedTextBox90.MouseClick,
        MaskedTextBox91.MouseClick, MaskedTextBox92.MouseClick,
        MaskedTextBox93.MouseClick, MaskedTextBox94.MouseClick,
        MaskedTextBox95.MouseClick, MaskedTextBox96.MouseClick,
        MaskedTextBox97.MouseClick, MaskedTextBox98.MouseClick,
        MaskedTextBox99.MouseClick, MaskedTextBox100.MouseClick,
        MaskedTextBox101.MouseClick, MaskedTextBox102.MouseClick,
        MaskedTextBox103.MouseClick, MaskedTextBox104.MouseClick,
        MaskedTextBox105.MouseClick, MaskedTextBox106.MouseClick,
        MaskedTextBox107.MouseClick, MaskedTextBox108.MouseClick,
        MaskedTextBox1.MouseClick, MaskedTextBox2.MouseClick,
        MaskedTextBox109.MouseClick

        '===================== клики мышкой


        If ActiveControl.Text.Length = 0 Then

            If ActiveControl.Name = "MaskedTextBox1" Then MaskedTextBox1.SelectAll()
            If ActiveControl.Name = "MaskedTextBox2" Then MaskedTextBox2.SelectAll()
            If ActiveControl.Name = "MaskedTextBox52" Then MaskedTextBox52.SelectAll()
            If ActiveControl.Name = "MaskedTextBox53" Then MaskedTextBox53.SelectAll()
            If ActiveControl.Name = "MaskedTextBox54" Then MaskedTextBox54.SelectAll()
            If ActiveControl.Name = "MaskedTextBox55" Then MaskedTextBox55.SelectAll()
            If ActiveControl.Name = "MaskedTextBox56" Then MaskedTextBox56.SelectAll()
            If ActiveControl.Name = "MaskedTextBox57" Then MaskedTextBox57.SelectAll()
            If ActiveControl.Name = "MaskedTextBox58" Then MaskedTextBox58.SelectAll()
            If ActiveControl.Name = "MaskedTextBox59" Then MaskedTextBox59.SelectAll()
            If ActiveControl.Name = "MaskedTextBox60" Then MaskedTextBox60.SelectAll()
            If ActiveControl.Name = "MaskedTextBox61" Then MaskedTextBox61.SelectAll()
            If ActiveControl.Name = "MaskedTextBox62" Then MaskedTextBox62.SelectAll()
            If ActiveControl.Name = "MaskedTextBox63" Then MaskedTextBox63.SelectAll()
            If ActiveControl.Name = "MaskedTextBox64" Then MaskedTextBox64.SelectAll()
            If ActiveControl.Name = "MaskedTextBox65" Then MaskedTextBox65.SelectAll()
            If ActiveControl.Name = "MaskedTextBox66" Then MaskedTextBox66.SelectAll()
            If ActiveControl.Name = "MaskedTextBox67" Then MaskedTextBox67.SelectAll()
            If ActiveControl.Name = "MaskedTextBox68" Then MaskedTextBox68.SelectAll()
            If ActiveControl.Name = "MaskedTextBox69" Then MaskedTextBox69.SelectAll()
            If ActiveControl.Name = "MaskedTextBox70" Then MaskedTextBox70.SelectAll()
            If ActiveControl.Name = "MaskedTextBox71" Then MaskedTextBox71.SelectAll()
            If ActiveControl.Name = "MaskedTextBox72" Then MaskedTextBox72.SelectAll()
            If ActiveControl.Name = "MaskedTextBox73" Then MaskedTextBox73.SelectAll()
            If ActiveControl.Name = "MaskedTextBox74" Then MaskedTextBox74.SelectAll()
            If ActiveControl.Name = "MaskedTextBox75" Then MaskedTextBox75.SelectAll()
            If ActiveControl.Name = "MaskedTextBox76" Then MaskedTextBox76.SelectAll()
            If ActiveControl.Name = "MaskedTextBox77" Then MaskedTextBox77.SelectAll()
            If ActiveControl.Name = "MaskedTextBox78" Then MaskedTextBox78.SelectAll()
            If ActiveControl.Name = "MaskedTextBox79" Then MaskedTextBox79.SelectAll()
            If ActiveControl.Name = "MaskedTextBox90" Then MaskedTextBox90.SelectAll()
            If ActiveControl.Name = "MaskedTextBox91" Then MaskedTextBox91.SelectAll()
            If ActiveControl.Name = "MaskedTextBox92" Then MaskedTextBox92.SelectAll()
            If ActiveControl.Name = "MaskedTextBox93" Then MaskedTextBox93.SelectAll()
            If ActiveControl.Name = "MaskedTextBox94" Then MaskedTextBox94.SelectAll()
            If ActiveControl.Name = "MaskedTextBox95" Then MaskedTextBox95.SelectAll()
            If ActiveControl.Name = "MaskedTextBox96" Then MaskedTextBox96.SelectAll()
            If ActiveControl.Name = "MaskedTextBox97" Then MaskedTextBox97.SelectAll()
            If ActiveControl.Name = "MaskedTextBox98" Then MaskedTextBox98.SelectAll()
            If ActiveControl.Name = "MaskedTextBox99" Then MaskedTextBox99.SelectAll()
            If ActiveControl.Name = "MaskedTextBox100" Then MaskedTextBox100.SelectAll()
            If ActiveControl.Name = "MaskedTextBox101" Then MaskedTextBox101.SelectAll()
            If ActiveControl.Name = "MaskedTextBox102" Then MaskedTextBox102.SelectAll()
            If ActiveControl.Name = "MaskedTextBox103" Then MaskedTextBox103.SelectAll()
            If ActiveControl.Name = "MaskedTextBox104" Then MaskedTextBox104.SelectAll()
            If ActiveControl.Name = "MaskedTextBox105" Then MaskedTextBox105.SelectAll()
            If ActiveControl.Name = "MaskedTextBox106" Then MaskedTextBox106.SelectAll()
            If ActiveControl.Name = "MaskedTextBox107" Then MaskedTextBox107.SelectAll()
            If ActiveControl.Name = "MaskedTextBox108" Then MaskedTextBox108.SelectAll()
            If ActiveControl.Name = "MaskedTextBox109" Then MaskedTextBox109.SelectAll()


        End If
    End Sub






    Private Sub TabPage4_Click(sender As Object, e As EventArgs) Handles TabPage4.Click

    End Sub

    Private Sub TextBox78_TextChanged(sender As Object, e As EventArgs) Handles TextBox78.TextChanged
        If Len(TextBox78.Text) > 1 Then
            If CheckBox1.Checked = True Then
                If DataGridView1.Rows.Count > 1 Then
                    DataGridView2.Rows.Clear()
                    DataGridView2.Visible = True
                    'Label4.Visible = False
                    'Button7.Visible = True
                    Dim RR As Long
                    Dim DAR As Long
                    DAR = 0
                    RR = 0
                    For ii As Integer = 0 To DataGridView1.Rows.Count - 1
                        For bb As Integer = 0 To 4
                            Dim saa As Object
                            TextBox80.Text = DataGridView1.Rows(ii).Cells(bb).Value
                            saa = InStr(TextBox80.Text.ToUpper, TextBox78.Text.ToUpper)
                            If saa <> 0 Then
                                If DAR = 0 Then
                                    RR = RR + 1
                                    DataGridView2.Rows.Add()
                                    DAR = 1
                                End If
                                For bbb As Integer = 0 To 4
                                    DataGridView2.Rows(RR - 1).Cells(bbb).Value = DataGridView1.Rows(ii).Cells(bbb).Value
                                Next
                                DataGridView2.Rows(RR - 1).Cells(bb).Selected = True
                            End If
                        Next
                        DAR = 0
                    Next
                End If
            Else
                If DataGridView1.Rows.Count > 1 Then
                    DataGridView2.Rows.Clear()
                    DataGridView2.Visible = True
                    ' Label4.Visible = False
                    ' Button7.Visible = True
                    Dim RR As Long
                    Dim DAR As Long
                    DAR = 0
                    RR = 0
                    For ii As Integer = 0 To DataGridView1.Rows.Count - 1
                        Dim saa As Object
                        TextBox80.Text = DataGridView1.Rows(ii).Cells(1).Value
                        saa = InStr(TextBox80.Text.ToUpper, TextBox78.Text.ToUpper)
                        If saa <> 0 Then
                            If DAR = 0 Then
                                RR = RR + 1
                                DataGridView2.Rows.Add()
                                DAR = 1
                            End If
                            For bbb As Integer = 0 To 4
                                DataGridView2.Rows(RR - 1).Cells(bbb).Value = DataGridView1.Rows(ii).Cells(bbb).Value
                            Next
                            DataGridView2.Rows(RR - 1).Cells(1).Selected = True
                        End If
                        DAR = 0
                    Next
                End If
            End If

            ' ToolStripStatusLabel1.Text = "Найдено искомых документов: " & DataGridView2.RowCount - 1 & "."
        Else
            DataGridView2.Visible = False
            'Label4.Visible = True
            ' Button7.Visible = False
            ' ToolStripStatusLabel1.Text = "Всего документов в библиотеке: " & DataGridView1.RowCount - 1 & "."
        End If
        If Len(TextBox78.Text) > 0 Then
            'Label4.Visible = False
        End If
    End Sub

    Private Sub TextBox79_TextChanged(sender As Object, e As EventArgs) Handles TextBox79.TextChanged
        'Поиск по дате изменения

        If Len(TextBox79.Text) > 0 Then

            If DataGridView1.Rows.Count > 1 Then
                DataGridView2.Rows.Clear()
                DataGridView2.Visible = True
                ' Label4.Visible = False
                ' Button7.Visible = True
                Dim RR As Long
                Dim DAR As Long
                DAR = 0
                RR = 0
                For ii As Integer = 0 To DataGridView1.Rows.Count - 1
                    Dim saa As Object
                    TextBox80.Text = DataGridView1.Rows(ii).Cells(3).Value
                    saa = InStr(TextBox80.Text.ToUpper, TextBox79.Text.ToUpper)
                    If saa <> 0 Then
                        If DAR = 0 Then
                            RR = RR + 1
                            DataGridView2.Rows.Add()
                            DAR = 1
                        End If
                        For bbb As Integer = 0 To 4
                            DataGridView2.Rows(RR - 1).Cells(bbb).Value = DataGridView1.Rows(ii).Cells(bbb).Value
                        Next
                        DataGridView2.Rows(RR - 1).Cells(1).Selected = True
                    End If
                    DAR = 0
                Next
            End If

        Else
            DataGridView2.Visible = False
        End If
    End Sub

    Private Sub TextBox81_TextChanged(sender As Object, e As EventArgs) Handles TextBox81.TextChanged
        If Len(TextBox81.Text) > 1 Then
            If CheckBox2.Checked = True Then
                If DataGridView3.Rows.Count > 1 Then
                    DataGridView4.Rows.Clear()
                    DataGridView4.Visible = True
                    'Label4.Visible = False
                    'Button7.Visible = True
                    Dim RR As Long
                    Dim DAR As Long
                    DAR = 0
                    RR = 0
                    For ii As Integer = 0 To DataGridView3.Rows.Count - 1
                        For bb As Integer = 0 To 4
                            Dim saa As Object
                            TextBox80.Text = DataGridView3.Rows(ii).Cells(bb).Value
                            saa = InStr(TextBox80.Text.ToUpper, TextBox81.Text.ToUpper)
                            If saa <> 0 Then
                                If DAR = 0 Then
                                    RR = RR + 1
                                    DataGridView4.Rows.Add()
                                    DAR = 1
                                End If
                                For bbb As Integer = 0 To 4
                                    DataGridView4.Rows(RR - 1).Cells(bbb).Value = DataGridView3.Rows(ii).Cells(bbb).Value
                                Next
                                DataGridView4.Rows(RR - 1).Cells(bb).Selected = True
                            End If
                        Next
                        DAR = 0
                    Next
                End If
            Else
                If DataGridView3.Rows.Count > 1 Then
                    DataGridView4.Rows.Clear()
                    DataGridView4.Visible = True
                    ' Label4.Visible = False
                    ' Button7.Visible = True
                    Dim RR As Long
                    Dim DAR As Long
                    DAR = 0
                    RR = 0
                    For ii As Integer = 0 To DataGridView3.Rows.Count - 1
                        Dim saa As Object
                        TextBox80.Text = DataGridView3.Rows(ii).Cells(1).Value
                        saa = InStr(TextBox80.Text.ToUpper, TextBox81.Text.ToUpper)
                        If saa <> 0 Then
                            If DAR = 0 Then
                                RR = RR + 1
                                DataGridView4.Rows.Add()
                                DAR = 1
                            End If
                            For bbb As Integer = 0 To 4
                                DataGridView4.Rows(RR - 1).Cells(bbb).Value = DataGridView3.Rows(ii).Cells(bbb).Value
                            Next
                            DataGridView4.Rows(RR - 1).Cells(1).Selected = True
                        End If
                        DAR = 0
                    Next
                End If
            End If

            ' ToolStripStatusLabel1.Text = "Найдено искомых документов: " & Datagridview4.RowCount - 1 & "."
        Else
            DataGridView4.Visible = False
            'Label4.Visible = True
            ' Button7.Visible = False
            ' ToolStripStatusLabel1.Text = "Всего документов в библиотеке: " & Datagridview3.RowCount - 1 & "."
        End If
        If Len(TextBox81.Text) > 0 Then
            'Label4.Visible = False
        End If
    End Sub

    Private Sub TextBox82_TextChanged(sender As Object, e As EventArgs) Handles TextBox82.TextChanged
        'Поиск по дате изменения

        If Len(TextBox82.Text) > 0 Then

            If DataGridView3.Rows.Count > 1 Then
                DataGridView4.Rows.Clear()
                DataGridView4.Visible = True
                ' Label4.Visible = False
                ' Button7.Visible = True
                Dim RR As Long
                Dim DAR As Long
                DAR = 0
                RR = 0
                For ii As Integer = 0 To DataGridView3.Rows.Count - 1
                    Dim saa As Object
                    TextBox80.Text = DataGridView3.Rows(ii).Cells(3).Value
                    saa = InStr(TextBox80.Text.ToUpper, TextBox82.Text.ToUpper)
                    If saa <> 0 Then
                        If DAR = 0 Then
                            RR = RR + 1
                            DataGridView4.Rows.Add()
                            DAR = 1
                        End If
                        For bbb As Integer = 0 To 4
                            DataGridView4.Rows(RR - 1).Cells(bbb).Value = DataGridView3.Rows(ii).Cells(bbb).Value
                        Next
                        DataGridView4.Rows(RR - 1).Cells(1).Selected = True
                    End If
                    DAR = 0
                Next
            End If

        Else
            DataGridView4.Visible = False
        End If
    End Sub

    Private Sub TextBox83_TextChanged(sender As Object, e As EventArgs) Handles TextBox83.TextChanged
        If Len(TextBox83.Text) > 1 Then
            If CheckBox3.Checked = True Then
                If DataGridView5.Rows.Count > 1 Then
                    DataGridView6.Rows.Clear()
                    DataGridView6.Visible = True
                    'Label4.Visible = False
                    'Button7.Visible = True
                    Dim RR As Long
                    Dim DAR As Long
                    DAR = 0
                    RR = 0
                    For ii As Integer = 0 To DataGridView5.Rows.Count - 1
                        For bb As Integer = 0 To 4
                            Dim saa As Object
                            TextBox83.Text = DataGridView5.Rows(ii).Cells(bb).Value
                            saa = InStr(TextBox80.Text.ToUpper, TextBox83.Text.ToUpper)
                            If saa <> 0 Then
                                If DAR = 0 Then
                                    RR = RR + 1
                                    DataGridView6.Rows.Add()
                                    DAR = 1
                                End If
                                For bbb As Integer = 0 To 4
                                    DataGridView6.Rows(RR - 1).Cells(bbb).Value = DataGridView5.Rows(ii).Cells(bbb).Value
                                Next
                                DataGridView6.Rows(RR - 1).Cells(bb).Selected = True
                            End If
                        Next
                        DAR = 0
                    Next
                End If
            Else
                If DataGridView5.Rows.Count > 1 Then
                    DataGridView6.Rows.Clear()
                    DataGridView6.Visible = True
                    ' Label4.Visible = False
                    ' Button7.Visible = True
                    Dim RR As Long
                    Dim DAR As Long
                    DAR = 0
                    RR = 0
                    For ii As Integer = 0 To DataGridView5.Rows.Count - 1
                        Dim saa As Object
                        TextBox80.Text = DataGridView5.Rows(ii).Cells(1).Value
                        saa = InStr(TextBox80.Text.ToUpper, TextBox83.Text.ToUpper)
                        If saa <> 0 Then
                            If DAR = 0 Then
                                RR = RR + 1
                                DataGridView6.Rows.Add()
                                DAR = 1
                            End If
                            For bbb As Integer = 0 To 4
                                DataGridView6.Rows(RR - 1).Cells(bbb).Value = DataGridView5.Rows(ii).Cells(bbb).Value
                            Next
                            DataGridView6.Rows(RR - 1).Cells(1).Selected = True
                        End If
                        DAR = 0
                    Next
                End If
            End If

            ' ToolStripStatusLabel1.Text = "Найдено искомых документов: " & Datagridview6.RowCount - 1 & "."
        Else
            DataGridView6.Visible = False
            'Label4.Visible = True
            ' Button7.Visible = False
            ' ToolStripStatusLabel1.Text = "Всего документов в библиотеке: " & Datagridview5.RowCount - 1 & "."
        End If
        If Len(TextBox81.Text) > 0 Then
            'Label4.Visible = False
        End If
    End Sub

    Private Sub TextBox84_TextChanged(sender As Object, e As EventArgs) Handles TextBox84.TextChanged
        'Поиск по дате изменения

        If Len(TextBox84.Text) > 0 Then

            If DataGridView5.Rows.Count > 1 Then
                DataGridView6.Rows.Clear()
                DataGridView6.Visible = True
                ' Label4.Visible = False
                ' Button7.Visible = True
                Dim RR As Long
                Dim DAR As Long
                DAR = 0
                RR = 0
                For ii As Integer = 0 To DataGridView5.Rows.Count - 1
                    Dim saa As Object
                    TextBox80.Text = DataGridView5.Rows(ii).Cells(3).Value
                    saa = InStr(TextBox80.Text.ToUpper, TextBox84.Text.ToUpper)
                    If saa <> 0 Then
                        If DAR = 0 Then
                            RR = RR + 1
                            DataGridView6.Rows.Add()
                            DAR = 1
                        End If
                        For bbb As Integer = 0 To 4
                            DataGridView6.Rows(RR - 1).Cells(bbb).Value = DataGridView5.Rows(ii).Cells(bbb).Value
                        Next
                        DataGridView6.Rows(RR - 1).Cells(1).Selected = True
                    End If
                    DAR = 0
                Next
            End If

        Else
            DataGridView6.Visible = False
        End If
    End Sub

    Private Sub TextBox85_TextChanged(sender As Object, e As EventArgs) Handles TextBox85.TextChanged

        If Len(TextBox85.Text) > 1 Then
            If CheckBox4.Checked = True Then
                If DataGridView7.Rows.Count > 1 Then
                    DataGridView8.Rows.Clear()
                    DataGridView8.Visible = True
                    'Label4.Visible = False
                    'Button7.Visible = True
                    Dim RR As Long
                    Dim DAR As Long
                    DAR = 0
                    RR = 0
                    For ii As Integer = 0 To DataGridView7.Rows.Count - 1
                        For bb As Integer = 0 To 4
                            Dim saa As Object
                            TextBox80.Text = DataGridView7.Rows(ii).Cells(bb).Value
                            saa = InStr(TextBox80.Text.ToUpper, TextBox85.Text.ToUpper)
                            If saa <> 0 Then
                                If DAR = 0 Then
                                    RR = RR + 1
                                    DataGridView8.Rows.Add()
                                    DAR = 1
                                End If
                                For bbb As Integer = 0 To 4
                                    DataGridView8.Rows(RR - 1).Cells(bbb).Value = DataGridView7.Rows(ii).Cells(bbb).Value
                                Next
                                DataGridView8.Rows(RR - 1).Cells(bb).Selected = True
                            End If
                        Next
                        DAR = 0
                    Next
                End If
            Else
                If DataGridView7.Rows.Count > 1 Then
                    DataGridView8.Rows.Clear()
                    DataGridView8.Visible = True
                    ' Label4.Visible = False
                    ' Button7.Visible = True
                    Dim RR As Long
                    Dim DAR As Long
                    DAR = 0
                    RR = 0
                    For ii As Integer = 0 To DataGridView7.Rows.Count - 1
                        Dim saa As Object
                        TextBox80.Text = DataGridView7.Rows(ii).Cells(1).Value
                        saa = InStr(TextBox80.Text.ToUpper, TextBox85.Text.ToUpper)
                        If saa <> 0 Then
                            If DAR = 0 Then
                                RR = RR + 1
                                DataGridView8.Rows.Add()
                                DAR = 1
                            End If
                            For bbb As Integer = 0 To 4
                                DataGridView8.Rows(RR - 1).Cells(bbb).Value = DataGridView7.Rows(ii).Cells(bbb).Value
                            Next
                            DataGridView8.Rows(RR - 1).Cells(1).Selected = True
                        End If
                        DAR = 0
                    Next
                End If
            End If

            ' ToolStripStatusLabel1.Text = "Найдено искомых документов: " & DataGridView8.RowCount - 1 & "."
        Else
            DataGridView8.Visible = False
            'Label4.Visible = True
            ' Button7.Visible = False
            ' ToolStripStatusLabel1.Text = "Всего документов в библиотеке: " & DataGridView7.RowCount - 1 & "."
        End If
        If Len(TextBox81.Text) > 0 Then
            'Label4.Visible = False
        End If




    End Sub

    Private Sub TextBox86_TextChanged(sender As Object, e As EventArgs) Handles TextBox86.TextChanged

        If Len(TextBox86.Text) > 0 Then

            If DataGridView7.Rows.Count > 1 Then
                DataGridView8.Rows.Clear()
                DataGridView8.Visible = True
                ' Label4.Visible = False
                ' Button7.Visible = True
                Dim RR As Long
                Dim DAR As Long
                DAR = 0
                RR = 0
                For ii As Integer = 0 To DataGridView7.Rows.Count - 1
                    Dim saa As Object
                    TextBox80.Text = DataGridView7.Rows(ii).Cells(3).Value
                    saa = InStr(TextBox80.Text.ToUpper, TextBox86.Text.ToUpper)
                    If saa <> 0 Then
                        If DAR = 0 Then
                            RR = RR + 1
                            DataGridView8.Rows.Add()
                            DAR = 1
                        End If
                        For bbb As Integer = 0 To 4
                            DataGridView8.Rows(RR - 1).Cells(bbb).Value = DataGridView7.Rows(ii).Cells(bbb).Value
                        Next
                        DataGridView8.Rows(RR - 1).Cells(1).Selected = True
                    End If
                    DAR = 0
                Next
            End If

        Else
            DataGridView8.Visible = False
        End If


    End Sub


    Private Sub DataGridView7_CellDoubleClick(sender As Object, e As DataGridViewCellEventArgs) Handles DataGridView7.CellDoubleClick
        System.Diagnostics.Process.Start(DataGridView7.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub



    Private Sub DataGridView8_CellContentDoubleClick(sender As Object, e As DataGridViewCellEventArgs) Handles DataGridView8.CellContentDoubleClick
        System.Diagnostics.Process.Start(DataGridView8.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub


    Private Sub DataGridView5_CellContentDoubleClick(sender As Object, e As DataGridViewCellEventArgs) Handles DataGridView5.CellContentDoubleClick
        System.Diagnostics.Process.Start(DataGridView5.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub

    Private Sub DataGridView6_CellContentDoubleClick(sender As Object, e As DataGridViewCellEventArgs) Handles DataGridView6.CellContentDoubleClick
        System.Diagnostics.Process.Start(DataGridView6.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub

    Private Sub DataGridView3_CellContentDoubleClick(sender As Object, e As DataGridViewCellEventArgs) Handles DataGridView3.CellContentDoubleClick
        System.Diagnostics.Process.Start(DataGridView3.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub

    Private Sub DataGridView4_CellContentDoubleClick(sender As Object, e As DataGridViewCellEventArgs) Handles DataGridView4.CellContentDoubleClick
        System.Diagnostics.Process.Start(DataGridView4.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub

    Private Sub DataGridView1_CellContentDoubleClick(sender As Object, e As DataGridViewCellEventArgs) Handles DataGridView1.CellContentDoubleClick
        System.Diagnostics.Process.Start(DataGridView1.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub

    Private Sub DataGridView2_CellContentDoubleClick(sender As Object, e As DataGridViewCellEventArgs) Handles DataGridView2.CellContentDoubleClick
        System.Diagnostics.Process.Start(DataGridView2.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub

    Private Sub TextBox47_TextChanged(sender As Object, e As EventArgs) Handles TextBox47.TextChanged
        'Ввод в ячейку - Погрузка с начала месяца в тоннах
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Pogr_mes_t.txt", TextBox47.Text, False)
    End Sub


    Private Sub TextBox52_TextChanged(sender As Object, e As EventArgs) Handles TextBox52.TextChanged
        'Ввод в ячейку - Погрузка с начала месяца в вагонах
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Pogr_mes_vag.txt", TextBox52.Text, False)

    End Sub

    Private Sub TextBox48_TextChanged(sender As Object, e As EventArgs) Handles TextBox48.TextChanged
        'Ввод в ячейку - Выгрузка с начала месяца в вагонах
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Vygr_mes_vag.txt", TextBox48.Text, False)

    End Sub

    Private Sub TextBox49_TextChanged(sender As Object, e As EventArgs) Handles TextBox49.TextChanged
        'Ввод в ячейку - Простой с начала месяца
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Prostoi_mes.txt", TextBox49.Text, False)

    End Sub

    Private Sub TextBox50_TextChanged(sender As Object, e As EventArgs) Handles TextBox50.TextChanged
        'Ввод в ячейку - Производительность локомотива с начала месяца
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Proizvod_lok_mes.txt", TextBox50.Text, False)

    End Sub

    Private Sub TextBox51_TextChanged(sender As Object, e As EventArgs) Handles TextBox51.TextChanged
        'Ввод в ячейку - Вагонооборот с начала месяца
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Vagonooborot_mes.txt", TextBox51.Text, False)

    End Sub


    Private Sub TextBox58_TextChanged(sender As Object, e As EventArgs) Handles TextBox58.TextChanged
        'Ввод в ячейку - Задание на текущий месяц - погрузка в тоннах
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Pogr_t_plan_mes.txt", TextBox58.Text, False)

    End Sub

    Private Sub TextBox57_TextChanged(sender As Object, e As EventArgs) Handles TextBox57.TextChanged
        'Ввод в ячейку - Задание на текущий месяц - погрузка в вагонах
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Pogr_vag_plan_mes.txt", TextBox57.Text, False)

    End Sub



    Private Sub TextBox56_TextChanged(sender As Object, e As EventArgs) Handles TextBox56.TextChanged
        'Ввод в ячейку - Задание на текущий месяц - выгрузка в вагонах
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Vygr_vag_plan_mes.txt", TextBox56.Text, False)
    End Sub

    Private Sub TextBox55_TextChanged(sender As Object, e As EventArgs) Handles TextBox55.TextChanged
        'Ввод в ячейку - Задание на текущий месяц - Простой
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Prostoi_plan_mes.txt", TextBox55.Text, False)

    End Sub



    Private Sub TextBox54_TextChanged(sender As Object, e As EventArgs) Handles TextBox54.TextChanged
        'Ввод в ячейку - Задание на текущий месяц - Произв.локомотива
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Proizvod_lok_plan_mes.txt", TextBox54.Text, False)

    End Sub




    Private Sub TextBox76_TextChanged(sender As Object, e As EventArgs) Handles TextBox76.TextChanged
        'Ввод в ячейку - Задание на текущий месяц - Погрузка прошлый месяц тонн
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Pogr_t_pred_mes.txt", TextBox76.Text, False)

    End Sub

    Private Sub TextBox75_TextChanged(sender As Object, e As EventArgs) Handles TextBox75.TextChanged
        'Ввод в ячейку - Задание на текущий месяц - Погрузка прошлый месяц вагонов
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Pogr_vag_pred_mes.txt", TextBox75.Text, False)

    End Sub

    Private Sub TextBox74_TextChanged(sender As Object, e As EventArgs) Handles TextBox74.TextChanged
        'Ввод в ячейку - Задание на текущий месяц - Выгрузка прошлый месяц вагонов
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Vygr_vag_pred_mes.txt", TextBox74.Text, False)

    End Sub

    Private Sub TextBox73_TextChanged(sender As Object, e As EventArgs) Handles TextBox73.TextChanged
        'Ввод в ячейку - Задание на текущий месяц - Простой прошлый месяц вагонов
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Prostoi_pred_mes.txt", TextBox73.Text, False)

    End Sub

    Private Sub TextBox72_TextChanged(sender As Object, e As EventArgs) Handles TextBox72.TextChanged
        'Ввод в ячейку - Задание на текущий месяц - Производительность локомотива прошлый месяц вагонов
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Proizvod_lok_pred_mes.txt", TextBox72.Text, False)

    End Sub

    Private Sub TextBox77_TextChanged(sender As Object, e As EventArgs) Handles TextBox77.TextChanged
        'Ввод в ячейку - Задание на текущий месяц - Вагонооборот прошлый месяц вагонов
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Vagonooborot_pred_mes.txt", TextBox77.Text, False)

    End Sub

    Private Sub TextBox65_TextChanged(sender As Object, e As EventArgs) Handles TextBox65.TextChanged
        'Дата на момент заполнения показателей ежемесячных
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Data_pokazat_mes.txt", TextBox65.Text, False)

    End Sub

    Private Sub TextBox53_TextChanged(sender As Object, e As EventArgs) Handles TextBox53.TextChanged
        'Дата на момент заполнения показателей текущих
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Data_pokazat_tek.txt", TextBox53.Text, False)

    End Sub

    Private Sub TextBox64_TextChanged(sender As Object, e As EventArgs) Handles TextBox64.TextChanged
        'Ввод в ячейку - с начала года - Погрузка - тонн
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Pogr_t_tek_god.txt", TextBox64.Text, False)

    End Sub

    Private Sub TextBox63_TextChanged(sender As Object, e As EventArgs) Handles TextBox63.TextChanged
        'Ввод в ячейку - с начала года - Погрузка - вагонов
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Pogr_vag_tek_god.txt", TextBox63.Text, False)

    End Sub

    Private Sub TextBox62_TextChanged(sender As Object, e As EventArgs) Handles TextBox62.TextChanged
        'Ввод в ячейку - с начала года - Выгрузка - вагонов
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Vygr_vag_tek_god.txt", TextBox62.Text, False)

    End Sub

    Private Sub TextBox61_TextChanged(sender As Object, e As EventArgs) Handles TextBox61.TextChanged
        'Ввод в ячейку - с начала года - Простой
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Prostoi_tek_god.txt", TextBox61.Text, False)

    End Sub

    Private Sub TextBox60_TextChanged(sender As Object, e As EventArgs) Handles TextBox60.TextChanged
        'Ввод в ячейку - с начала года - Произв.локомотива
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Proizvod_lok_god.txt", TextBox60.Text, False)

    End Sub

    Private Sub TextBox71_TextChanged(sender As Object, e As EventArgs) Handles TextBox71.TextChanged
        SaveTextbox("\Pogr_t_pred_god.txt", TextBox71.Text)
    End Sub


    Sub SaveTextbox(Fname As String, TBox As String)
        My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & Fname, TBox, False)
    End Sub

    Private Sub TextBox70_TextChanged(sender As Object, e As EventArgs) Handles TextBox70.TextChanged
        SaveTextbox("\Pogr_vag_pred_god.txt", TextBox70.Text)
    End Sub





    Private Sub TextBox69_TextChanged(sender As Object, e As EventArgs) Handles TextBox69.TextChanged
        SaveTextbox("\Vygr_pred_god.txt", TextBox69.Text)
    End Sub




    Private Sub TextBox68_TextChanged(sender As Object, e As EventArgs) Handles TextBox68.TextChanged
        SaveTextbox("\Prostoi_pred_god.txt", TextBox68.Text)
    End Sub





    Private Sub TextBox67_TextChanged(sender As Object, e As EventArgs) Handles TextBox67.TextChanged
        SaveTextbox("\Proizv_lok_pred_god.txt", TextBox67.Text)
    End Sub




    Private Sub TextBox66_TextChanged(sender As Object, e As EventArgs) Handles TextBox66.TextChanged
        SaveTextbox("\Vagonooborot_pred_god.txt", TextBox66.Text)
    End Sub

    Sub PokazateliLoad()


        'Грузим содержимое вкладки - показатели все с файлов

        ReadTextbox("Pogr_mes_t.txt")
        TextBox47.Text = LoadText

        ReadTextbox("Pogr_mes_vag.txt")
        TextBox52.Text = LoadText

        ReadTextbox("Vygr_mes_vag.txt")
        TextBox48.Text = LoadText

        ReadTextbox("Prostoi_mes.txt")
        TextBox49.Text = LoadText

        ReadTextbox("Proizvod_lok_mes.txt")
        TextBox50.Text = LoadText

        ReadTextbox("Vagonooborot_mes.txt")
        TextBox51.Text = LoadText


        ReadTextbox("Pogr_t_plan_mes.txt")
        TextBox58.Text = LoadText



        ReadTextbox("Pogr_vag_plan_mes.txt")
        TextBox57.Text = LoadText


        ReadTextbox("Vygr_vag_plan_mes.txt")
        TextBox56.Text = LoadText


        ReadTextbox("Prostoi_plan_mes.txt")
        TextBox55.Text = LoadText


        ReadTextbox("Proizvod_lok_plan_mes.txt")
        TextBox54.Text = LoadText

        ReadTextbox("Pogr_t_pred_mes.txt")
        TextBox76.Text = LoadText

        ReadTextbox("Pogr_vag_pred_mes.txt")
        TextBox75.Text = LoadText

        ReadTextbox("Vygr_vag_pred_mes.txt")
        TextBox74.Text = LoadText

        ReadTextbox("Prostoi_pred_mes.txt")
        TextBox73.Text = LoadText

        ReadTextbox("Proizvod_lok_pred_mes.txt")
        TextBox72.Text = LoadText

        ReadTextbox("Vagonooborot_pred_mes.txt")
        TextBox77.Text = LoadText

        ReadTextbox("Data_pokazat_mes.txt")
        TextBox65.Text = LoadText

        ReadTextbox("Data_pokazat_tek.txt")
        TextBox53.Text = LoadText

        ReadTextbox("Pogr_t_tek_god.txt")
        TextBox64.Text = LoadText

        ReadTextbox("Pogr_vag_tek_god.txt")
        TextBox63.Text = LoadText

        ReadTextbox("Vygr_vag_tek_god.txt")
        TextBox62.Text = LoadText

        ReadTextbox("Prostoi_tek_god.txt")
        TextBox61.Text = LoadText

        ReadTextbox("Proizvod_lok_god.txt")
        TextBox60.Text = LoadText

        ReadTextbox("Pogr_t_pred_god.txt")
        TextBox71.Text = LoadText

        ReadTextbox("Pogr_vag_pred_god.txt")
        TextBox70.Text = LoadText

        ReadTextbox("Vygr_pred_god.txt")
        TextBox69.Text = LoadText

        ReadTextbox("Prostoi_pred_god.txt")
        TextBox68.Text = LoadText

        ReadTextbox("Proizv_lok_pred_god.txt")
        TextBox67.Text = LoadText

        ReadTextbox("Vagonooborot_pred_god.txt")
        TextBox66.Text = LoadText

        ReadTextbox("Vagonooborot_tek_god.txt")
        TextBox59.Text = LoadText


    End Sub


    Private Sub TabControl2_SelectedIndexChanged(sender As Object, e As EventArgs) Handles TabControl2.SelectedIndexChanged
        'Проверка выбранной вкладки для её обновления - вообще наверное и нет уже необходимости, оно все равно обновляется каждую минуту
        ' If TabControl2.SelectedIndex = 0 Then InformationLoad()
        'If TabControl2.SelectedIndex = 1 Then DLoad()
        ' If TabControl2.SelectedIndex = 2 Then LCTOLoad()
        'If TabControl2.SelectedIndex = 3 Then PLoad()
        ' If TabControl2.SelectedIndex = 4 Then OKLoad()
    End Sub

    Private Sub TabControl1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles TabControl1.SelectedIndexChanged
        'MsgBox(TabControl1.SelectedIndex)







        If TabControl1.SelectedIndex = 3 Then   'вкладка БД

            RW = 0
            Stringtext = ""
            bytesvalue = ""


            If My.Computer.FileSystem.FileExists(Application.StartupPath & "\IndexFileBD.txt") = True Then
                base = Application.StartupPath & "\IndexFileBD.txt"

                Dim reader As Microsoft.VisualBasic.FileIO.TextFieldParser

                reader = My.Computer.FileSystem.OpenTextFieldParser _
                (base)

                While Not reader.EndOfData
                    Stringtext = reader.ReadLine()
                    Stringtext = reader.ReadLine()
                    Stringtext = reader.ReadLine()
                    Stringtext = reader.ReadLine()
                    Stringtext = reader.ReadLine()
                    DataGridView1.Rows.Add()
                End While
                reader.Close()


                reader = My.Computer.FileSystem.OpenTextFieldParser _
                (base)
                While Not reader.EndOfData
                    DataGridView1.Rows(RW).Cells(0).Value = reader.ReadLine()
                    DataGridView1.Rows(RW).Cells(1).Value = reader.ReadLine()
                    DataGridView1.Rows(RW).Cells(2).Value = reader.ReadLine()
                    DataGridView1.Rows(RW).Cells(3).Value = reader.ReadLine()
                    bytesvalue = reader.ReadLine()

                    DataGridView1.Rows(RW).Cells(4).Value = bytesvalue

                    If bytesvalue > 1024 Then
                        DataGridView1.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1024, 0) & " Кб"
                    End If

                    If bytesvalue > 1048576 Then
                        DataGridView1.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1048576, 0) & " Мб"
                    End If
                    If bytesvalue > 1073741824 Then
                        DataGridView1.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1073741824, 0) & " Гб"
                    End If

                    RW = RW + 1
                End While
                reader.Close()
            End If


            'DataGridView1.DefaultCellStyle.Font = New Font(DataGridView1.DefaultCellStyle.Font.Name, 13, FontStyle.Regular)




            '==== Завершено чтение файлов в индексном файле


            ' ===== запускаем индексацию
            DataGridView1.Rows.Clear() 'чистим ровбокс
            My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileBD.txt", "", False) 'чистим файл индекса
            IndexationV2() 'индексируем файлы БД
            'Registration()

            '===== конец загрузки


        End If



        If TabControl1.SelectedIndex = 4 Then   '  ОХрана труда


            '======== ЗАГРУЗКА вкладки Охрана труда


            If My.Computer.FileSystem.FileExists(Application.StartupPath & "\myname.txt") = True Then
                'Label1.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt")
                'Me.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt") & " - E-Library"
            End If


            '======== ОБЪЯВЛЯЕМ ПЕРЕМЕННЫЕ ИЛИ СБРАСЫВАЕМ ТУТ

            RW = 0
            Stringtext = ""
            bytesvalue = ""



            If My.Computer.FileSystem.FileExists(Application.StartupPath & "\IndexFileOT.txt") = True Then
                base = Application.StartupPath & "\IndexFileOT.txt"

                Dim reader As Microsoft.VisualBasic.FileIO.TextFieldParser

                reader = My.Computer.FileSystem.OpenTextFieldParser _
                (base)

                While Not reader.EndOfData
                    Stringtext = reader.ReadLine()
                    Stringtext = reader.ReadLine()
                    Stringtext = reader.ReadLine()
                    Stringtext = reader.ReadLine()
                    Stringtext = reader.ReadLine()
                    DataGridView3.Rows.Add()
                End While
                reader.Close()


                reader = My.Computer.FileSystem.OpenTextFieldParser _
                (base)
                While Not reader.EndOfData
                    DataGridView3.Rows(RW).Cells(0).Value = reader.ReadLine()
                    DataGridView3.Rows(RW).Cells(1).Value = reader.ReadLine()
                    DataGridView3.Rows(RW).Cells(2).Value = reader.ReadLine()
                    DataGridView3.Rows(RW).Cells(3).Value = reader.ReadLine()
                    bytesvalue = reader.ReadLine()

                    DataGridView3.Rows(RW).Cells(4).Value = bytesvalue

                    If bytesvalue > 1024 Then
                        DataGridView3.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1024, 0) & " Кб"
                    End If

                    If bytesvalue > 1048576 Then
                        DataGridView3.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1048576, 0) & " Мб"
                    End If
                    If bytesvalue > 1073741824 Then
                        DataGridView3.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1073741824, 0) & " Гб"
                    End If

                    RW = RW + 1
                End While
                reader.Close()
            End If


            'DataGridView3.DefaultCellStyle.Font = New Font(DataGridView3.DefaultCellStyle.Font.Name, 13, FontStyle.Regular)




            '==== Завершено чтение файлов в индексном файле


            ' ===== запускаем индексацию
            DataGridView3.Rows.Clear() 'чистим ровбокс
            My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileOT.txt", "", False) 'чистим файл индекса
            IndexationOT() 'индексируем файлы БД
            'Registration()

            '===== конец загрузки

        End If



        If TabControl1.SelectedIndex = 5 Then   '  Инструктажи
            '======== ЗАГРУЗКА вкладки ИНСТРУКТАЖИ


            If My.Computer.FileSystem.FileExists(Application.StartupPath & "\myname.txt") = True Then
                'Label1.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt")
                'Me.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt") & " - E-Library"
            End If


            '======== ОБЪЯВЛЯЕМ ПЕРЕМЕННЫЕ ИЛИ СБРАСЫВАЕМ ТУТ

            RW = 0
            Stringtext = ""
            bytesvalue = ""



            If My.Computer.FileSystem.FileExists(Application.StartupPath & "\IndexFileIN.txt") = True Then
                base = Application.StartupPath & "\IndexFileIN.txt"

                Dim reader As Microsoft.VisualBasic.FileIO.TextFieldParser

                reader = My.Computer.FileSystem.OpenTextFieldParser _
                (base)

                While Not reader.EndOfData
                    Stringtext = reader.ReadLine()
                    Stringtext = reader.ReadLine()
                    Stringtext = reader.ReadLine()
                    Stringtext = reader.ReadLine()
                    Stringtext = reader.ReadLine()
                    DataGridView5.Rows.Add()
                End While
                reader.Close()


                reader = My.Computer.FileSystem.OpenTextFieldParser _
                (base)
                While Not reader.EndOfData
                    DataGridView5.Rows(RW).Cells(0).Value = reader.ReadLine()
                    DataGridView5.Rows(RW).Cells(1).Value = reader.ReadLine()
                    DataGridView5.Rows(RW).Cells(2).Value = reader.ReadLine()
                    DataGridView5.Rows(RW).Cells(3).Value = reader.ReadLine()
                    bytesvalue = reader.ReadLine()

                    DataGridView5.Rows(RW).Cells(4).Value = bytesvalue

                    If bytesvalue > 1024 Then
                        DataGridView5.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1024, 0) & " Кб"
                    End If

                    If bytesvalue > 1048576 Then
                        DataGridView5.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1048576, 0) & " Мб"
                    End If
                    If bytesvalue > 1073741824 Then
                        DataGridView5.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1073741824, 0) & " Гб"
                    End If

                    RW = RW + 1
                End While
                reader.Close()
            End If


            'Datagridview5.DefaultCellStyle.Font = New Font(Datagridview5.DefaultCellStyle.Font.Name, 13, FontStyle.Regular)




            '==== Завершено чтение файлов в индексном файле


            ' ===== запускаем индексацию
            DataGridView5.Rows.Clear() 'чистим ровбокс
            My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileIN.txt", "", False) 'чистим файл индекса
            IndexationIN() 'индексируем файлы БД
            'Registration()

            '===== КОНЕЦ ЗАГРУЗКИ

        End If



        If TabControl1.SelectedIndex = 0 Then
            '====================== Загрузка RichTextBox ов
            ' InformationLoad()
            ' DLoad()
            ' LCTOLoad()
            ' PLoad()
            ' OKLoad()
            LoadEnd = 1
        End If




        ' MsgBox(TabControl1.SelectedIndex)
        If TabControl1.SelectedIndex = 1 Then  '''' поменять обратно!!!!! на одинку
            ' MsgBox("I")
            GrWin()
            If My.Computer.FileSystem.DirectoryExists(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text) = False Then
                My.Computer.FileSystem.CreateDirectory(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text)
            End If



            '======== ЗАГРУЗКА вкладки Суточный план


            LoadEnd = 0


            LoadTxtDat("Prim_today.txt")
            TextBox106.Text = LoadText1

            LoadTxtDat("Pogr_today_kr1.txt")
            MaskedTextBox1.Text = LoadText1
            LoadTxtDat("Pogr_today_kr2.txt")
            TextBox3.Text = LoadText1
            LoadTxtDat("Pogr_today_kr3.txt")
            MaskedTextBox2.Text = LoadText1
            LoadTxtDat("Pogr_today_kr4.txt")
            TextBox4.Text = LoadText1

            LoadTxtDat("Pogr_today.txt")
            TextBox11.Text = LoadText1
            Label189.Text = "Погрузка - " & TextBox11.Text

            LoadTxtDat("Pogr_today_pl1.txt")
            MaskedTextBox52.Text = LoadText1
            LoadTxtDat("Pogr_today_pl2.txt")
            TextBox99.Text = LoadText1
            LoadTxtDat("Pogr_today_pl3.txt")
            MaskedTextBox53.Text = LoadText1
            LoadTxtDat("Pogr_today_pl4.txt")
            TextBox34.Text = LoadText1


            LoadTxtDat("Pogr_today_pv1.txt")
            MaskedTextBox54.Text = LoadText1
            LoadTxtDat("Pogr_today_pv2.txt")
            TextBox100.Text = LoadText1
            LoadTxtDat("Pogr_today_pv3.txt")
            MaskedTextBox55.Text = LoadText1
            LoadTxtDat("Pogr_today_pv4.txt")
            TextBox101.Text = LoadText1


            LoadTxtDat("Pogr_today_cs1.txt")
            MaskedTextBox56.Text = LoadText1
            LoadTxtDat("Pogr_today_cs2.txt")
            TextBox102.Text = LoadText1
            LoadTxtDat("Pogr_today_cs3.txt")
            MaskedTextBox57.Text = LoadText1
            LoadTxtDat("Pogr_today_cs4.txt")
            TextBox103.Text = LoadText1



            LoadTxtDat("Pogr_today_pr1.txt")
            MaskedTextBox58.Text = LoadText1
            LoadTxtDat("Pogr_today_pr2.txt")
            TextBox104.Text = LoadText1
            LoadTxtDat("Pogr_today_pr3.txt")
            MaskedTextBox59.Text = LoadText1
            LoadTxtDat("Pogr_today_pr4.txt")
            TextBox105.Text = LoadText1









            LoadTxtDat("Vygr_today_kr1.txt")
            MaskedTextBox60.Text = LoadText1
            LoadTxtDat("Vygr_today_kr2.txt")
            TextBox88.Text = LoadText1
            LoadTxtDat("Vygr_today_kr3.txt")
            MaskedTextBox61.Text = LoadText1
            LoadTxtDat("Vygr_today_kr4.txt")
            TextBox107.Text = LoadText1

            LoadTxtDat("Vygr_today.txt")
            TextBox22.Text = LoadText1
            Label190.Text = "Выгрузка - " & TextBox22.Text


            LoadTxtDat("Vygr_today_pl1.txt")
            MaskedTextBox62.Text = LoadText1
            LoadTxtDat("Vygr_today_pl2.txt")
            TextBox108.Text = LoadText1
            LoadTxtDat("Vygr_today_pl3.txt")
            MaskedTextBox63.Text = LoadText1
            LoadTxtDat("Vygr_today_pl4.txt")
            TextBox109.Text = LoadText1


            LoadTxtDat("Vygr_today_pv1.txt")
            MaskedTextBox64.Text = LoadText1
            LoadTxtDat("Vygr_today_pv2.txt")
            TextBox110.Text = LoadText1
            LoadTxtDat("Vygr_today_pv3.txt")
            MaskedTextBox65.Text = LoadText1
            LoadTxtDat("Vygr_today_pv4.txt")
            TextBox111.Text = LoadText1


            LoadTxtDat("Vygr_today_cs1.txt")
            MaskedTextBox66.Text = LoadText1
            LoadTxtDat("Vygr_today_cs2.txt")
            TextBox112.Text = LoadText1
            LoadTxtDat("Vygr_today_cs3.txt")
            MaskedTextBox67.Text = LoadText1
            LoadTxtDat("Vygr_today_cs4.txt")
            TextBox113.Text = LoadText1



            LoadTxtDat("Vygr_today_pr1.txt")
            MaskedTextBox68.Text = LoadText1
            LoadTxtDat("Vygr_today_pr2.txt")
            TextBox114.Text = LoadText1
            LoadTxtDat("Vygr_today_pr3.txt")
            MaskedTextBox69.Text = LoadText1
            LoadTxtDat("Vygr_today_pr4.txt")
            TextBox115.Text = LoadText1











            LoadTxtDat("Zayavka_today_kr1.txt")
            MaskedTextBox70.Text = LoadText1
            LoadTxtDat("Zayavka_today_kr2.txt")
            TextBox116.Text = LoadText1
            LoadTxtDat("Zayavka_today_kr3.txt")
            MaskedTextBox71.Text = LoadText1
            LoadTxtDat("Zayavka_today_kr4.txt")
            TextBox117.Text = LoadText1

            LoadTxtDat("Zayavka_today.txt")
            TextBox45.Text = LoadText1
            Label191.Text = "Заявка - " & TextBox45.Text


            LoadTxtDat("Zayavka_today_pl1.txt")
            MaskedTextBox72.Text = LoadText1
            LoadTxtDat("Zayavka_today_pl2.txt")
            TextBox118.Text = LoadText1
            LoadTxtDat("Zayavka_today_pl3.txt")
            MaskedTextBox73.Text = LoadText1
            LoadTxtDat("Zayavka_today_pl4.txt")
            TextBox119.Text = LoadText1


            LoadTxtDat("Zayavka_today_pv1.txt")
            MaskedTextBox74.Text = LoadText1
            LoadTxtDat("Zayavka_today_pv2.txt")
            TextBox120.Text = LoadText1
            LoadTxtDat("Zayavka_today_pv3.txt")
            MaskedTextBox75.Text = LoadText1
            LoadTxtDat("Zayavka_today_pv4.txt")
            TextBox121.Text = LoadText1


            LoadTxtDat("Zayavka_today_cs1.txt")
            MaskedTextBox76.Text = LoadText1
            LoadTxtDat("Zayavka_today_cs2.txt")
            TextBox122.Text = LoadText1
            LoadTxtDat("Zayavka_today_cs3.txt")
            MaskedTextBox77.Text = LoadText1
            LoadTxtDat("Zayavka_today_cs4.txt")
            TextBox123.Text = LoadText1



            LoadTxtDat("Zayavka_today_pr1.txt")
            MaskedTextBox78.Text = LoadText1
            LoadTxtDat("Zayavka_today_pr2.txt")
            TextBox124.Text = LoadText1
            LoadTxtDat("Zayavka_today_pr3.txt")
            MaskedTextBox79.Text = LoadText1
            LoadTxtDat("Zayavka_today_pr4.txt")
            TextBox125.Text = LoadText1












            LoadTxtDat("PodVygr_today_kr1.txt")
            MaskedTextBox90.Text = LoadText1
            LoadTxtDat("PodVygr_today_kr2.txt")
            TextBox136.Text = LoadText1
            LoadTxtDat("PodVygr_today_kr3.txt")
            MaskedTextBox91.Text = LoadText1
            LoadTxtDat("PodVygr_today_kr4.txt")
            TextBox137.Text = LoadText1

            LoadTxtDat("PodVygr_today.txt")
            TextBox46.Text = LoadText1
            Label193.Text = "Под выгрузкой - " & TextBox46.Text


            LoadTxtDat("PodVygr_today_pl1.txt")
            MaskedTextBox92.Text = LoadText1
            LoadTxtDat("PodVygr_today_pl2.txt")
            TextBox138.Text = LoadText1
            LoadTxtDat("PodVygr_today_pl3.txt")
            MaskedTextBox93.Text = LoadText1
            LoadTxtDat("PodVygr_today_pl4.txt")
            TextBox139.Text = LoadText1


            LoadTxtDat("PodVygr_today_pv1.txt")
            MaskedTextBox94.Text = LoadText1
            LoadTxtDat("PodVygr_today_pv2.txt")
            TextBox140.Text = LoadText1
            LoadTxtDat("PodVygr_today_pv3.txt")
            MaskedTextBox95.Text = LoadText1
            LoadTxtDat("PodVygr_today_pv4.txt")
            TextBox141.Text = LoadText1


            LoadTxtDat("PodVygr_today_cs1.txt")
            MaskedTextBox96.Text = LoadText1
            LoadTxtDat("PodVygr_today_cs2.txt")
            TextBox142.Text = LoadText1
            LoadTxtDat("PodVygr_today_cs3.txt")
            MaskedTextBox97.Text = LoadText1
            LoadTxtDat("PodVygr_today_cs4.txt")
            TextBox143.Text = LoadText1




            LoadTxtDat("PodVygr_today_pr1.txt")
            MaskedTextBox98.Text = LoadText1
            LoadTxtDat("PodVygr_today_pr2.txt")
            TextBox144.Text = LoadText1
            LoadTxtDat("PodVygr_today_pr3.txt")
            MaskedTextBox99.Text = LoadText1
            LoadTxtDat("PodVygr_today_pr4.txt")
            TextBox145.Text = LoadText1




            LoadTxt("Perehod_today_kr1.txt")
            MaskedTextBox100.Text = LoadText1
            LoadTxt("Perehod_today_kr2.txt")
            TextBox146.Text = LoadText1
            LoadTxt("Perehod_today_kr3.txt")
            MaskedTextBox101.Text = LoadText1
            LoadTxt("Perehod_today_kr4.txt")
            TextBox147.Text = LoadText1

            LoadTxt("Perehod_today.txt")
            TextBox87.Text = LoadText1
            Label199.Text = "Нужно довезти - " & TextBox87.Text


            LoadTxt("Perehod_today_pl1.txt")
            MaskedTextBox102.Text = LoadText1
            LoadTxt("Perehod_today_pl2.txt")
            TextBox148.Text = LoadText1
            LoadTxt("Perehod_today_pl3.txt")
            MaskedTextBox103.Text = LoadText1
            LoadTxt("Perehod_today_pl4.txt")
            TextBox149.Text = LoadText1


            LoadTxt("Perehod_today_pv1.txt")
            MaskedTextBox104.Text = LoadText1
            LoadTxt("Perehod_today_pv2.txt")
            TextBox150.Text = LoadText1
            LoadTxt("Perehod_today_pv3.txt")
            MaskedTextBox105.Text = LoadText1
            LoadTxt("Perehod_today_pv4.txt")
            TextBox151.Text = LoadText1


            LoadTxt("Perehod_today_cs1.txt")
            MaskedTextBox106.Text = LoadText1
            LoadTxt("Perehod_today_cs2.txt")
            TextBox152.Text = LoadText1
            LoadTxt("Perehod_today_cs3.txt")
            MaskedTextBox107.Text = LoadText1
            LoadTxt("Perehod_today_cs4.txt")
            TextBox153.Text = LoadText1




            LoadTxt("Perehod_today_pr1.txt")
            MaskedTextBox108.Text = LoadText1
            LoadTxt("Perehod_today_pr2.txt")
            TextBox154.Text = LoadText1
            LoadTxt("Perehod_today_pr3.txt")
            MaskedTextBox109.Text = LoadText1
            LoadTxt("Perehod_today_pr4.txt")
            TextBox155.Text = LoadText1


            LoadEnd = 1
            Label48.Text = ""
            Label8.Text = ""
            Label9.Text = ""
            Label14.Text = ""



            If Val(TextBox11.Text) > 0 Then
                Label48.Text = TextBox11.Text & " ="
                Label189.Text = "Погрузка - " & TextBox11.Text
                If Val(Label47.Text) > 0 Then Label48.Text = Label48.Text & " кр" & Label47.Text
                If Val(Label52.Text) > 0 Then Label48.Text = Label48.Text & " пл" & Label52.Text
                If Val(Label59.Text) > 0 Then Label48.Text = Label48.Text & " пв" & Label59.Text
                If Val(Label62.Text) > 0 Then Label48.Text = Label48.Text & " цс" & Label62.Text
                If Val(Label65.Text) > 0 Then Label48.Text = Label48.Text & " пр" & Label65.Text

            End If


            If Val(TextBox22.Text) > 0 Then
                Label8.Text = TextBox22.Text & " ="
                Label190.Text = "Выгрузка - " & TextBox22.Text
                If Val(Label80.Text) > 0 Then Label8.Text = Label8.Text & " кр" & Label80.Text
                If Val(Label77.Text) > 0 Then Label8.Text = Label8.Text & " пл" & Label77.Text
                If Val(Label74.Text) > 0 Then Label8.Text = Label8.Text & " пв" & Label74.Text
                If Val(Label71.Text) > 0 Then Label8.Text = Label8.Text & " цс" & Label71.Text
                If Val(Label68.Text) > 0 Then Label8.Text = Label8.Text & " пр" & Label68.Text

            End If

            If Val(TextBox45.Text) > 0 Then
                Label9.Text = TextBox45.Text & " ="

                If Val(Label95.Text) > 0 Then Label9.Text = Label9.Text & " кр" & Label95.Text
                If Val(Label92.Text) > 0 Then Label9.Text = Label9.Text & " пл" & Label92.Text
                If Val(Label89.Text) > 0 Then Label9.Text = Label9.Text & " пв" & Label89.Text
                If Val(Label86.Text) > 0 Then Label9.Text = Label9.Text & " цс" & Label86.Text
                If Val(Label83.Text) > 0 Then Label9.Text = Label9.Text & " пр" & Label83.Text

            End If

            If Val(TextBox46.Text) > 0 Then
                Label14.Text = TextBox46.Text & " ="

                If Val(Label110.Text) > 0 Then Label14.Text = Label14.Text & " кр" & Label110.Text
                If Val(Label107.Text) > 0 Then Label14.Text = Label14.Text & " пл" & Label107.Text
                If Val(Label104.Text) > 0 Then Label14.Text = Label14.Text & " пв" & Label104.Text
                If Val(Label101.Text) > 0 Then Label14.Text = Label14.Text & " цс" & Label101.Text
                If Val(Label98.Text) > 0 Then Label14.Text = Label14.Text & " пр" & Label98.Text

            End If





            DataCheckRead()
            'GrantedAccess()


        End If





        If TabControl1.SelectedIndex = 2 Then ' выбрана вкладка показатели


            'Грузим содержимое вкладки - показатели все с файлов

            ReadTextbox("Pogr_mes_t.txt")
            TextBox47.Text = LoadText

            ReadTextbox("Pogr_mes_vag.txt")
            TextBox52.Text = LoadText

            ReadTextbox("Vygr_mes_vag.txt")
            TextBox48.Text = LoadText

            ReadTextbox("Prostoi_mes.txt")
            TextBox49.Text = LoadText

            ReadTextbox("Proizvod_lok_mes.txt")
            TextBox50.Text = LoadText

            ReadTextbox("Vagonooborot_mes.txt")
            TextBox51.Text = LoadText


            ReadTextbox("Pogr_t_plan_mes.txt")
            TextBox58.Text = LoadText



            ReadTextbox("Pogr_vag_plan_mes.txt")
            TextBox57.Text = LoadText


            ReadTextbox("Vygr_vag_plan_mes.txt")
            TextBox56.Text = LoadText


            ReadTextbox("Prostoi_plan_mes.txt")
            TextBox55.Text = LoadText


            ReadTextbox("Proizvod_lok_plan_mes.txt")
            TextBox54.Text = LoadText

            ReadTextbox("Pogr_t_pred_mes.txt")
            TextBox76.Text = LoadText

            ReadTextbox("Pogr_vag_pred_mes.txt")
            TextBox75.Text = LoadText

            ReadTextbox("Vygr_vag_pred_mes.txt")
            TextBox74.Text = LoadText

            ReadTextbox("Prostoi_pred_mes.txt")
            TextBox73.Text = LoadText

            ReadTextbox("Proizvod_lok_pred_mes.txt")
            TextBox72.Text = LoadText

            ReadTextbox("Vagonooborot_pred_mes.txt")
            TextBox77.Text = LoadText

            ReadTextbox("Data_pokazat_mes.txt")
            TextBox65.Text = LoadText

            ReadTextbox("Data_pokazat_tek.txt")
            TextBox53.Text = LoadText

            ReadTextbox("Pogr_t_tek_god.txt")
            TextBox64.Text = LoadText

            ReadTextbox("Pogr_vag_tek_god.txt")
            TextBox63.Text = LoadText

            ReadTextbox("Vygr_vag_tek_god.txt")
            TextBox62.Text = LoadText

            ReadTextbox("Prostoi_tek_god.txt")
            TextBox61.Text = LoadText

            ReadTextbox("Proizvod_lok_god.txt")
            TextBox60.Text = LoadText

            ReadTextbox("Pogr_t_pred_god.txt")
            TextBox71.Text = LoadText

            ReadTextbox("Pogr_vag_pred_god.txt")
            TextBox70.Text = LoadText

            ReadTextbox("Vygr_pred_god.txt")
            TextBox69.Text = LoadText

            ReadTextbox("Prostoi_pred_god.txt")
            TextBox68.Text = LoadText

            ReadTextbox("Proizv_lok_pred_god.txt")
            TextBox67.Text = LoadText

            ReadTextbox("Vagonooborot_pred_god.txt")
            TextBox66.Text = LoadText









        End If




        If TabControl1.SelectedIndex = 6 Then   '  Вкладка документы
            DocumentLoad()
        End If


    End Sub



    Sub ReadTextbox(FileName As String)




        If My.Computer.FileSystem.FileExists((My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & FileName)) = True Then 'Если файл есть - грузим

            LoadText = My.Computer.FileSystem.ReadAllText((My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & "\" & FileName))
            'MsgBox(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & FileName)
            ' MsgBox(LoadText)
        Else 'Иначе просто присваиваем пустоту

            LoadText = ""
        End If
    End Sub


    Private Sub Timer1_Tick(sender As Object, e As EventArgs) Handles Timer1.Tick


        Dim usrcode As String = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\usercode.txt")

        If My.Computer.FileSystem.FileExists(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & usrcode & ".rtf") = True Then

            Incomming.RichTextBox1.LoadFile(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & usrcode & ".rtf")

            My.Computer.FileSystem.DeleteFile(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & usrcode & ".rtf")

            Incomming.Text = "Входящее сообщение"
            Incomming.Show()
            SplashScreen2.Show()
            SplashScreen2.Timer1.Enabled = True
            SplashScreen2.TextBox1.Text = "Новое сообщение"
        End If




    End Sub


    Sub Procent()
        If p1 > 0 And p2 > 0 Then
            rp = p1 / p2 * 100
        Else
            rp = 0
        End If
        'MsgBox(rp)

        rp = Math.Round(Val(rp), 2) ' округление

        ' rp = Math.Floor(rp)
    End Sub


    Private Sub TextBox11_TextChanged(sender As Object, e As EventArgs)
        'Ввод в ячейку - Погрузка сегодня
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today.txt", TextBox11.Text, False)
        End If
    End Sub




    Private Sub TextBox22_TextChanged(sender As Object, e As EventArgs)
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today.txt", TextBox22.Text, False)
        End If
    End Sub



    Private Sub TextBox45_TextChanged(sender As Object, e As EventArgs)
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today.txt", TextBox45.Text, False)
        End If
    End Sub



    Private Sub MaskedTextBox27_MaskInputRejected(sender As Object, e As MaskInputRejectedEventArgs) Handles MaskedTextBox73.MaskInputRejected
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_pl3.txt", MaskedTextBox73.Text, False)
        End If
    End Sub



    Private Sub TextBox30_TextChanged(sender As Object, e As EventArgs)

    End Sub



    Private Sub TextBox29_TextChanged(sender As Object, e As EventArgs)

    End Sub


    Private Sub TextBox28_TextChanged(sender As Object, e As EventArgs)

    End Sub


    Private Sub TextBox27_TextChanged(sender As Object, e As EventArgs)

    End Sub


    Private Sub TextBox26_TextChanged(sender As Object, e As EventArgs)

    End Sub



    Private Sub TextBox25_TextChanged(sender As Object, e As EventArgs)

    End Sub


    Private Sub TextBox24_TextChanged(sender As Object, e As EventArgs)

    End Sub


    Private Sub TextBox46_TextChanged(sender As Object, e As EventArgs)
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today.txt", TextBox46.Text, False)
        End If
    End Sub

    Private Sub TextBox87_TextChanged(sender As Object, e As EventArgs)
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today.txt", TextBox87.Text, False)
        End If
    End Sub



    Private Sub Timer2_Tick(sender As Object, e As EventArgs) Handles Timer2.Tick

        'Обновление каждые 5 минут  ==================ОБНОВЛЯЕМ ФОРМУ


        Dim D As Date = Now



        Me.Text = Format(D, "dd MMMM yyyyг.") & " РЕЧИЦА БЧ " & Version

        'GroupBox4.Text = "Выполнение показателей за " & Format(D, "dd MMMM")

        LoadEnd = 0

        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\myname.txt") = True Then
            'Label1.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt")
            'Me.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt") & " - E-Library"
        End If


        '====================== Загрузка RichTextBox ов

        '  InformationLoad()
        ' DLoad()
        ' LCTOLoad()
        '  PLoad()
        '' OKLoad()
        ' BDLoad()
        '  OTLoad()

        LoadEnd = 1


        If My.Computer.FileSystem.FileExists(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Format(Date.Now, "dd MMMM yyyyг.") & "\Utv.txt") = True Then
            If My.Computer.FileSystem.FileExists(Application.StartupPath & "\utv" & Format(Date.Now, "dd MMMM yyyyг.") & ".txt") = False Then
                My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\utv" & Format(Date.Now, "dd MMMM yyyyг.") & ".txt", "", False)
                SplashScreen2.Show()
                SplashScreen2.TextBox1.Text = "Утвержден суточный план"
                If My.Computer.FileSystem.FileExists(Application.StartupPath & "\utv" & Format(DateAdd(DateInterval.Day, -1, Convert.ToDateTime(Date.Now)), "dd MMMM yyyyг.") & ".txt") = True Then
                    My.Computer.FileSystem.DeleteFile(Application.StartupPath & "\utv" & Format(DateAdd(DateInterval.Day, -1, Convert.ToDateTime(Date.Now)), "dd MMMM yyyyг.") & ".txt")
                End If
            End If
        End If





    End Sub





    Sub SPLoad()




        '======== ЗАГРУЗКА вкладки Суточный план

        LoadEnd = 0


        LoadTxtDat("Prim_today.txt")
        TextBox106.Text = LoadText1

        LoadTxtDat("Pogr_today_kr1.txt")
        MaskedTextBox1.Text = LoadText1
        LoadTxtDat("Pogr_today_kr2.txt")
        TextBox3.Text = LoadText1
        LoadTxtDat("Pogr_today_kr3.txt")
        MaskedTextBox2.Text = LoadText1
        LoadTxtDat("Pogr_today_kr4.txt")
        TextBox4.Text = LoadText1

        LoadTxtDat("Pogr_today.txt")
        TextBox11.Text = LoadText1
        Label189.Text = "Погрузка - " & TextBox11.Text

        LoadTxtDat("Pogr_today_pl1.txt")
        MaskedTextBox52.Text = LoadText1
        LoadTxtDat("Pogr_today_pl2.txt")
        TextBox99.Text = LoadText1
        LoadTxtDat("Pogr_today_pl3.txt")
        MaskedTextBox53.Text = LoadText1
        LoadTxtDat("Pogr_today_pl4.txt")
        TextBox34.Text = LoadText1


        LoadTxtDat("Pogr_today_pv1.txt")
        MaskedTextBox54.Text = LoadText1
        LoadTxtDat("Pogr_today_pv2.txt")
        TextBox100.Text = LoadText1
        LoadTxtDat("Pogr_today_pv3.txt")
        MaskedTextBox55.Text = LoadText1
        LoadTxtDat("Pogr_today_pv4.txt")
        TextBox101.Text = LoadText1


        LoadTxtDat("Pogr_today_cs1.txt")
        MaskedTextBox56.Text = LoadText1
        LoadTxtDat("Pogr_today_cs2.txt")
        TextBox102.Text = LoadText1
        LoadTxtDat("Pogr_today_cs3.txt")
        MaskedTextBox57.Text = LoadText1
        LoadTxtDat("Pogr_today_cs4.txt")
        TextBox103.Text = LoadText1



        LoadTxtDat("Pogr_today_pr1.txt")
        MaskedTextBox58.Text = LoadText1
        LoadTxtDat("Pogr_today_pr2.txt")
        TextBox104.Text = LoadText1
        LoadTxtDat("Pogr_today_pr3.txt")
        MaskedTextBox59.Text = LoadText1
        LoadTxtDat("Pogr_today_pr4.txt")
        TextBox105.Text = LoadText1









        LoadTxtDat("Vygr_today_kr1.txt")
        MaskedTextBox60.Text = LoadText1
        LoadTxtDat("Vygr_today_kr2.txt")
        TextBox88.Text = LoadText1
        LoadTxtDat("Vygr_today_kr3.txt")
        MaskedTextBox61.Text = LoadText1
        LoadTxtDat("Vygr_today_kr4.txt")
        TextBox107.Text = LoadText1

        LoadTxtDat("Vygr_today.txt")
        TextBox22.Text = LoadText1
        Label190.Text = "Выгрузка - " & TextBox22.Text


        LoadTxtDat("Vygr_today_pl1.txt")
        MaskedTextBox62.Text = LoadText1
        LoadTxtDat("Vygr_today_pl2.txt")
        TextBox108.Text = LoadText1
        LoadTxtDat("Vygr_today_pl3.txt")
        MaskedTextBox63.Text = LoadText1
        LoadTxtDat("Vygr_today_pl4.txt")
        TextBox109.Text = LoadText1


        LoadTxtDat("Vygr_today_pv1.txt")
        MaskedTextBox64.Text = LoadText1
        LoadTxtDat("Vygr_today_pv2.txt")
        TextBox110.Text = LoadText1
        LoadTxtDat("Vygr_today_pv3.txt")
        MaskedTextBox65.Text = LoadText1
        LoadTxtDat("Vygr_today_pv4.txt")
        TextBox111.Text = LoadText1


        LoadTxtDat("Vygr_today_cs1.txt")
        MaskedTextBox66.Text = LoadText1
        LoadTxtDat("Vygr_today_cs2.txt")
        TextBox112.Text = LoadText1
        LoadTxtDat("Vygr_today_cs3.txt")
        MaskedTextBox67.Text = LoadText1
        LoadTxtDat("Vygr_today_cs4.txt")
        TextBox113.Text = LoadText1



        LoadTxtDat("Vygr_today_pr1.txt")
        MaskedTextBox68.Text = LoadText1
        LoadTxtDat("Vygr_today_pr2.txt")
        TextBox114.Text = LoadText1
        LoadTxtDat("Vygr_today_pr3.txt")
        MaskedTextBox69.Text = LoadText1
        LoadTxtDat("Vygr_today_pr4.txt")
        TextBox115.Text = LoadText1











        LoadTxtDat("Zayavka_today_kr1.txt")
        MaskedTextBox70.Text = LoadText1
        LoadTxtDat("Zayavka_today_kr2.txt")
        TextBox116.Text = LoadText1
        LoadTxtDat("Zayavka_today_kr3.txt")
        MaskedTextBox71.Text = LoadText1
        LoadTxtDat("Zayavka_today_kr4.txt")
        TextBox117.Text = LoadText1

        LoadTxtDat("Zayavka_today.txt")
        TextBox45.Text = LoadText1
        Label191.Text = "Заявка - " & TextBox45.Text


        LoadTxtDat("Zayavka_today_pl1.txt")
        MaskedTextBox72.Text = LoadText1
        LoadTxtDat("Zayavka_today_pl2.txt")
        TextBox118.Text = LoadText1
        LoadTxtDat("Zayavka_today_pl3.txt")
        MaskedTextBox73.Text = LoadText1
        LoadTxtDat("Zayavka_today_pl4.txt")
        TextBox119.Text = LoadText1


        LoadTxtDat("Zayavka_today_pv1.txt")
        MaskedTextBox74.Text = LoadText1
        LoadTxtDat("Zayavka_today_pv2.txt")
        TextBox120.Text = LoadText1
        LoadTxtDat("Zayavka_today_pv3.txt")
        MaskedTextBox75.Text = LoadText1
        LoadTxtDat("Zayavka_today_pv4.txt")
        TextBox121.Text = LoadText1


        LoadTxtDat("Zayavka_today_cs1.txt")
        MaskedTextBox76.Text = LoadText1
        LoadTxtDat("Zayavka_today_cs2.txt")
        TextBox122.Text = LoadText1
        LoadTxtDat("Zayavka_today_cs3.txt")
        MaskedTextBox77.Text = LoadText1
        LoadTxtDat("Zayavka_today_cs4.txt")
        TextBox123.Text = LoadText1



        LoadTxtDat("Zayavka_today_pr1.txt")
        MaskedTextBox78.Text = LoadText1
        LoadTxtDat("Zayavka_today_pr2.txt")
        TextBox124.Text = LoadText1
        LoadTxtDat("Zayavka_today_pr3.txt")
        MaskedTextBox79.Text = LoadText1
        LoadTxtDat("Zayavka_today_pr4.txt")
        TextBox125.Text = LoadText1












        LoadTxtDat("PodVygr_today_kr1.txt")
        MaskedTextBox90.Text = LoadText1
        LoadTxtDat("PodVygr_today_kr2.txt")
        TextBox136.Text = LoadText1
        LoadTxtDat("PodVygr_today_kr3.txt")
        MaskedTextBox91.Text = LoadText1
        LoadTxtDat("PodVygr_today_kr4.txt")
        TextBox137.Text = LoadText1

        LoadTxtDat("PodVygr_today.txt")
        TextBox46.Text = LoadText1
        Label193.Text = "Под выгрузкой - " & TextBox46.Text


        LoadTxtDat("PodVygr_today_pl1.txt")
        MaskedTextBox92.Text = LoadText1
        LoadTxtDat("PodVygr_today_pl2.txt")
        TextBox138.Text = LoadText1
        LoadTxtDat("PodVygr_today_pl3.txt")
        MaskedTextBox93.Text = LoadText1
        LoadTxtDat("PodVygr_today_pl4.txt")
        TextBox139.Text = LoadText1


        LoadTxtDat("PodVygr_today_pv1.txt")
        MaskedTextBox94.Text = LoadText1
        LoadTxtDat("PodVygr_today_pv2.txt")
        TextBox140.Text = LoadText1
        LoadTxtDat("PodVygr_today_pv3.txt")
        MaskedTextBox95.Text = LoadText1
        LoadTxtDat("PodVygr_today_pv4.txt")
        TextBox141.Text = LoadText1


        LoadTxtDat("PodVygr_today_cs1.txt")
        MaskedTextBox96.Text = LoadText1
        LoadTxtDat("PodVygr_today_cs2.txt")
        TextBox142.Text = LoadText1
        LoadTxtDat("PodVygr_today_cs3.txt")
        MaskedTextBox97.Text = LoadText1
        LoadTxtDat("PodVygr_today_cs4.txt")
        TextBox143.Text = LoadText1




        LoadTxtDat("PodVygr_today_pr1.txt")
        MaskedTextBox98.Text = LoadText1
        LoadTxtDat("PodVygr_today_pr2.txt")
        TextBox144.Text = LoadText1
        LoadTxtDat("PodVygr_today_pr3.txt")
        MaskedTextBox99.Text = LoadText1
        LoadTxtDat("PodVygr_today_pr4.txt")
        TextBox145.Text = LoadText1




        LoadTxt("Perehod_today_kr1.txt")
        MaskedTextBox100.Text = LoadText1
        LoadTxt("Perehod_today_kr2.txt")
        TextBox146.Text = LoadText1
        LoadTxt("Perehod_today_kr3.txt")
        MaskedTextBox101.Text = LoadText1
        LoadTxt("Perehod_today_kr4.txt")
        TextBox147.Text = LoadText1

        LoadTxt("Perehod_today.txt")
        TextBox87.Text = LoadText1
        Label199.Text = "Нужно довезти - " & TextBox87.Text


        LoadTxt("Perehod_today_pl1.txt")
        MaskedTextBox102.Text = LoadText1
        LoadTxt("Perehod_today_pl2.txt")
        TextBox148.Text = LoadText1
        LoadTxt("Perehod_today_pl3.txt")
        MaskedTextBox103.Text = LoadText1
        LoadTxt("Perehod_today_pl4.txt")
        TextBox149.Text = LoadText1


        LoadTxt("Perehod_today_pv1.txt")
        MaskedTextBox104.Text = LoadText1
        LoadTxt("Perehod_today_pv2.txt")
        TextBox150.Text = LoadText1
        LoadTxt("Perehod_today_pv3.txt")
        MaskedTextBox105.Text = LoadText1
        LoadTxt("Perehod_today_pv4.txt")
        TextBox151.Text = LoadText1


        LoadTxt("Perehod_today_cs1.txt")
        MaskedTextBox106.Text = LoadText1
        LoadTxt("Perehod_today_cs2.txt")
        TextBox152.Text = LoadText1
        LoadTxt("Perehod_today_cs3.txt")
        MaskedTextBox107.Text = LoadText1
        LoadTxt("Perehod_today_cs4.txt")
        TextBox153.Text = LoadText1




        LoadTxt("Perehod_today_pr1.txt")
        MaskedTextBox108.Text = LoadText1
        LoadTxt("Perehod_today_pr2.txt")
        TextBox154.Text = LoadText1
        LoadTxt("Perehod_today_pr3.txt")
        MaskedTextBox109.Text = LoadText1
        LoadTxt("Perehod_today_pr4.txt")
        TextBox155.Text = LoadText1




        LoadEnd = 1
        Label48.Text = ""
        Label8.Text = ""
        Label9.Text = ""
        Label14.Text = ""





    End Sub


    Sub LoadTxtDat(FLN As String)

        If My.Computer.FileSystem.FileExists(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\" & FLN) = True Then
            LoadText1 = My.Computer.FileSystem.ReadAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\" & FLN)
        Else
            LoadText1 = ""
        End If


    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        'ClearAllTextboxes()
        ' Отнимаем день
        Label45.Text = Format(DateAdd(DateInterval.Day, -1, Convert.ToDateTime(Label45.Text)), "dd MMMM yyyyг.")
        Label45.Refresh()



        If My.Computer.FileSystem.DirectoryExists(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text) = True Then
            TableLayoutPanel6.Visible = False
            Label22.Visible = True
            Label22.Refresh()
            SPLoad()
            Label22.Visible = False
            TableLayoutPanel6.Visible = True
        Else
            TableLayoutPanel6.Visible = False
            Label22.Visible = True
            Label22.Refresh()
            SPLoad()
            Label22.Visible = False
            TableLayoutPanel6.Visible = True
        End If


        DateTimePicker1.Value = Convert.ToDateTime(Label45.Text)
        DateTimePicker1.Refresh()
        'CreateDir()
        'DataCheckRead()
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        'ClearAllTextboxes()
        'Добавляем день
        Label45.Text = Format(DateAdd(DateInterval.Day, 1, Convert.ToDateTime(Label45.Text)), "dd MMMM yyyyг.")
        Label45.Refresh()


        If My.Computer.FileSystem.DirectoryExists(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text) = True Then
            TableLayoutPanel6.Visible = False
            Label22.Visible = True
            Label22.Refresh()
            SPLoad()
            Label22.Visible = False

            TableLayoutPanel6.Visible = True

        Else
            TableLayoutPanel6.Visible = False
            Label22.Visible = True
            Label22.Refresh()
            SPLoad()
            Label22.Visible = False

            TableLayoutPanel6.Visible = True
        End If

        DateTimePicker1.Value = Convert.ToDateTime(Label45.Text)
        DateTimePicker1.Refresh()

        ' CreateDir()


        'DataCheckRead()
        'GrantedAccess()

    End Sub

    Sub DataCheckRead()

        If Label45.Text = Format(Date.Now, "dd MMMM yyyyг.") Then
            'OpenSP()


        Else

            'CloseSP()


        End If



    End Sub

    Sub CloseSP()
        MaskedTextBox1.ReadOnly = True
        MaskedTextBox2.ReadOnly = True
        MaskedTextBox53.ReadOnly = True
        MaskedTextBox52.ReadOnly = True
        MaskedTextBox55.ReadOnly = True
        MaskedTextBox54.ReadOnly = True
        MaskedTextBox57.ReadOnly = True
        MaskedTextBox56.ReadOnly = True
        MaskedTextBox59.ReadOnly = True
        MaskedTextBox69.ReadOnly = True
        MaskedTextBox68.ReadOnly = True
        MaskedTextBox67.ReadOnly = True
        MaskedTextBox66.ReadOnly = True
        MaskedTextBox65.ReadOnly = True
        MaskedTextBox64.ReadOnly = True
        MaskedTextBox63.ReadOnly = True
        MaskedTextBox62.ReadOnly = True
        MaskedTextBox61.ReadOnly = True
        MaskedTextBox60.ReadOnly = True
        MaskedTextBox79.ReadOnly = True
        MaskedTextBox78.ReadOnly = True
        MaskedTextBox77.ReadOnly = True
        MaskedTextBox76.ReadOnly = True
        MaskedTextBox75.ReadOnly = True
        MaskedTextBox74.ReadOnly = True
        MaskedTextBox73.ReadOnly = True
        MaskedTextBox72.ReadOnly = True
        MaskedTextBox71.ReadOnly = True
        MaskedTextBox70.ReadOnly = True
        MaskedTextBox99.ReadOnly = True
        MaskedTextBox98.ReadOnly = True
        MaskedTextBox97.ReadOnly = True
        MaskedTextBox96.ReadOnly = True
        MaskedTextBox95.ReadOnly = True
        MaskedTextBox94.ReadOnly = True
        MaskedTextBox93.ReadOnly = True
        MaskedTextBox92.ReadOnly = True
        MaskedTextBox91.ReadOnly = True
        MaskedTextBox90.ReadOnly = True
        MaskedTextBox41.ReadOnly = True
        MaskedTextBox109.ReadOnly = True
        MaskedTextBox108.ReadOnly = True
        MaskedTextBox107.ReadOnly = True
        MaskedTextBox106.ReadOnly = True
        MaskedTextBox105.ReadOnly = True
        MaskedTextBox104.ReadOnly = True
        MaskedTextBox103.ReadOnly = True
        MaskedTextBox102.ReadOnly = True
        MaskedTextBox101.ReadOnly = True
        MaskedTextBox100.ReadOnly = True
        MaskedTextBox101.ReadOnly = True
        MaskedTextBox102.ReadOnly = True
        MaskedTextBox103.ReadOnly = True
        MaskedTextBox104.ReadOnly = True
        MaskedTextBox105.ReadOnly = True
        MaskedTextBox106.ReadOnly = True
        MaskedTextBox107.ReadOnly = True
        MaskedTextBox108.ReadOnly = True
        MaskedTextBox109.ReadOnly = True
        TextBox3.ReadOnly = True
        TextBox4.ReadOnly = True
        TextBox99.ReadOnly = True
        TextBox34.ReadOnly = True
        TextBox100.ReadOnly = True
        TextBox101.ReadOnly = True
        TextBox102.ReadOnly = True
        TextBox103.ReadOnly = True
        TextBox104.ReadOnly = True
        TextBox105.ReadOnly = True
        TextBox106.ReadOnly = True
        TextBox107.ReadOnly = True
        TextBox108.ReadOnly = True
        TextBox109.ReadOnly = True
        TextBox110.ReadOnly = True
        TextBox111.ReadOnly = True
        TextBox112.ReadOnly = True
        TextBox113.ReadOnly = True
        TextBox114.ReadOnly = True
        TextBox115.ReadOnly = True
        TextBox116.ReadOnly = True
        TextBox117.ReadOnly = True
        TextBox118.ReadOnly = True
        TextBox119.ReadOnly = True
        TextBox120.ReadOnly = True
        TextBox121.ReadOnly = True
        TextBox122.ReadOnly = True
        TextBox123.ReadOnly = True
        TextBox124.ReadOnly = True
        TextBox125.ReadOnly = True
        TextBox136.ReadOnly = True
        TextBox137.ReadOnly = True
        TextBox138.ReadOnly = True
        TextBox139.ReadOnly = True
        TextBox140.ReadOnly = True
        TextBox141.ReadOnly = True
        TextBox142.ReadOnly = True
        TextBox143.ReadOnly = True
        TextBox144.ReadOnly = True
        TextBox145.ReadOnly = True
        TextBox146.ReadOnly = True
        TextBox147.ReadOnly = True
        TextBox148.ReadOnly = True
        TextBox149.ReadOnly = True
        TextBox150.ReadOnly = True
        TextBox151.ReadOnly = True
        TextBox152.ReadOnly = True
        TextBox153.ReadOnly = True
        TextBox154.ReadOnly = True
        TextBox155.ReadOnly = True





    End Sub

    Sub OpenSP()
        MaskedTextBox1.ReadOnly = False
        MaskedTextBox2.ReadOnly = False
        MaskedTextBox53.ReadOnly = False
        MaskedTextBox52.ReadOnly = False
        MaskedTextBox55.ReadOnly = False
        MaskedTextBox54.ReadOnly = False
        MaskedTextBox57.ReadOnly = False
        MaskedTextBox56.ReadOnly = False
        MaskedTextBox59.ReadOnly = False
        MaskedTextBox69.ReadOnly = False
        MaskedTextBox68.ReadOnly = False
        MaskedTextBox67.ReadOnly = False
        MaskedTextBox66.ReadOnly = False
        MaskedTextBox65.ReadOnly = False
        MaskedTextBox64.ReadOnly = False
        MaskedTextBox63.ReadOnly = False
        MaskedTextBox62.ReadOnly = False
        MaskedTextBox61.ReadOnly = False
        MaskedTextBox60.ReadOnly = False
        MaskedTextBox79.ReadOnly = False
        MaskedTextBox78.ReadOnly = False
        MaskedTextBox77.ReadOnly = False
        MaskedTextBox76.ReadOnly = False
        MaskedTextBox75.ReadOnly = False
        MaskedTextBox74.ReadOnly = False
        MaskedTextBox73.ReadOnly = False
        MaskedTextBox72.ReadOnly = False
        MaskedTextBox71.ReadOnly = False
        MaskedTextBox70.ReadOnly = False
        MaskedTextBox99.ReadOnly = False
        MaskedTextBox98.ReadOnly = False
        MaskedTextBox97.ReadOnly = False
        MaskedTextBox96.ReadOnly = False
        MaskedTextBox95.ReadOnly = False
        MaskedTextBox94.ReadOnly = False
        MaskedTextBox93.ReadOnly = False
        MaskedTextBox92.ReadOnly = False
        MaskedTextBox91.ReadOnly = False
        MaskedTextBox90.ReadOnly = False
        MaskedTextBox41.ReadOnly = False
        MaskedTextBox109.ReadOnly = False
        MaskedTextBox108.ReadOnly = False
        MaskedTextBox107.ReadOnly = False
        MaskedTextBox106.ReadOnly = False
        MaskedTextBox105.ReadOnly = False
        MaskedTextBox104.ReadOnly = False
        MaskedTextBox103.ReadOnly = False
        MaskedTextBox102.ReadOnly = False
        MaskedTextBox101.ReadOnly = False
        MaskedTextBox100.ReadOnly = False
        MaskedTextBox101.ReadOnly = False
        MaskedTextBox102.ReadOnly = False
        MaskedTextBox103.ReadOnly = False
        MaskedTextBox104.ReadOnly = False
        MaskedTextBox105.ReadOnly = False
        MaskedTextBox106.ReadOnly = False
        MaskedTextBox107.ReadOnly = False
        MaskedTextBox108.ReadOnly = False
        MaskedTextBox109.ReadOnly = False
        TextBox3.ReadOnly = False
        TextBox4.ReadOnly = False
        TextBox99.ReadOnly = False
        TextBox34.ReadOnly = False
        TextBox100.ReadOnly = False
        TextBox101.ReadOnly = False
        TextBox102.ReadOnly = False
        TextBox103.ReadOnly = False
        TextBox104.ReadOnly = False
        TextBox105.ReadOnly = False
        TextBox106.ReadOnly = False
        TextBox107.ReadOnly = False
        TextBox108.ReadOnly = False
        TextBox109.ReadOnly = False
        TextBox110.ReadOnly = False
        TextBox111.ReadOnly = False
        TextBox112.ReadOnly = False
        TextBox113.ReadOnly = False
        TextBox114.ReadOnly = False
        TextBox115.ReadOnly = False
        TextBox116.ReadOnly = False
        TextBox117.ReadOnly = False
        TextBox118.ReadOnly = False
        TextBox119.ReadOnly = False
        TextBox120.ReadOnly = False
        TextBox121.ReadOnly = False
        TextBox122.ReadOnly = False
        TextBox123.ReadOnly = False
        TextBox124.ReadOnly = False
        TextBox125.ReadOnly = False
        TextBox136.ReadOnly = False
        TextBox137.ReadOnly = False
        TextBox138.ReadOnly = False
        TextBox139.ReadOnly = False
        TextBox140.ReadOnly = False
        TextBox141.ReadOnly = False
        TextBox142.ReadOnly = False
        TextBox143.ReadOnly = False
        TextBox144.ReadOnly = False
        TextBox145.ReadOnly = False
        TextBox146.ReadOnly = False
        TextBox147.ReadOnly = False
        TextBox148.ReadOnly = False
        TextBox149.ReadOnly = False
        TextBox150.ReadOnly = False
        TextBox151.ReadOnly = False
        TextBox152.ReadOnly = False
        TextBox153.ReadOnly = False
        TextBox154.ReadOnly = False
        TextBox155.ReadOnly = False

    End Sub


    Sub Denied()
        'Главная вкладка

        'RichTextBox2.ReadOnly = True
        ' RichTextBox3.ReadOnly = True
        ' RichTextBox4.ReadOnly = True
        'RichTextBox5.ReadOnly = True
        'RichTextBox6.ReadOnly = True
        ' RichTextBox7.ReadOnly = True
        ' RichTextBox8.ReadOnly = True
        ' RichTextBox9.ReadOnly = True




        'Суточный план

        MaskedTextBox1.ReadOnly = True
        MaskedTextBox2.ReadOnly = True
        MaskedTextBox53.ReadOnly = True
        MaskedTextBox52.ReadOnly = True
        MaskedTextBox55.ReadOnly = True
        MaskedTextBox54.ReadOnly = True
        MaskedTextBox57.ReadOnly = True
        MaskedTextBox56.ReadOnly = True
        MaskedTextBox59.ReadOnly = True
        MaskedTextBox69.ReadOnly = True
        MaskedTextBox68.ReadOnly = True
        MaskedTextBox67.ReadOnly = True
        MaskedTextBox66.ReadOnly = True
        MaskedTextBox65.ReadOnly = True
        MaskedTextBox64.ReadOnly = True
        MaskedTextBox63.ReadOnly = True
        MaskedTextBox62.ReadOnly = True
        MaskedTextBox61.ReadOnly = True
        MaskedTextBox60.ReadOnly = True
        MaskedTextBox79.ReadOnly = True
        MaskedTextBox78.ReadOnly = True
        MaskedTextBox77.ReadOnly = True
        MaskedTextBox76.ReadOnly = True
        MaskedTextBox75.ReadOnly = True
        MaskedTextBox74.ReadOnly = True
        MaskedTextBox73.ReadOnly = True
        MaskedTextBox72.ReadOnly = True
        MaskedTextBox71.ReadOnly = True
        MaskedTextBox70.ReadOnly = True
        MaskedTextBox99.ReadOnly = True
        MaskedTextBox98.ReadOnly = True
        MaskedTextBox97.ReadOnly = True
        MaskedTextBox96.ReadOnly = True
        MaskedTextBox95.ReadOnly = True
        MaskedTextBox94.ReadOnly = True
        MaskedTextBox93.ReadOnly = True
        MaskedTextBox92.ReadOnly = True
        MaskedTextBox91.ReadOnly = True
        MaskedTextBox90.ReadOnly = True
        MaskedTextBox41.ReadOnly = True
        MaskedTextBox109.ReadOnly = True
        MaskedTextBox108.ReadOnly = True
        MaskedTextBox107.ReadOnly = True
        MaskedTextBox106.ReadOnly = True
        MaskedTextBox105.ReadOnly = True
        MaskedTextBox104.ReadOnly = True
        MaskedTextBox103.ReadOnly = True
        MaskedTextBox102.ReadOnly = True
        MaskedTextBox101.ReadOnly = True
        MaskedTextBox100.ReadOnly = True
        MaskedTextBox1.ReadOnly = True
        MaskedTextBox2.ReadOnly = True
        MaskedTextBox53.ReadOnly = True
        MaskedTextBox52.ReadOnly = True
        MaskedTextBox55.ReadOnly = True
        MaskedTextBox54.ReadOnly = True
        MaskedTextBox57.ReadOnly = True
        MaskedTextBox56.ReadOnly = True
        MaskedTextBox59.ReadOnly = True
        MaskedTextBox69.ReadOnly = True
        MaskedTextBox68.ReadOnly = True
        MaskedTextBox67.ReadOnly = True
        MaskedTextBox66.ReadOnly = True
        MaskedTextBox65.ReadOnly = True
        MaskedTextBox64.ReadOnly = True
        MaskedTextBox63.ReadOnly = True
        MaskedTextBox62.ReadOnly = True
        MaskedTextBox61.ReadOnly = True
        MaskedTextBox60.ReadOnly = True
        MaskedTextBox79.ReadOnly = True
        MaskedTextBox78.ReadOnly = True
        MaskedTextBox77.ReadOnly = True
        MaskedTextBox76.ReadOnly = True
        MaskedTextBox75.ReadOnly = True
        MaskedTextBox74.ReadOnly = True
        MaskedTextBox73.ReadOnly = True
        MaskedTextBox72.ReadOnly = True
        MaskedTextBox71.ReadOnly = True
        MaskedTextBox70.ReadOnly = True
        MaskedTextBox99.ReadOnly = True
        MaskedTextBox98.ReadOnly = True
        MaskedTextBox97.ReadOnly = True
        MaskedTextBox96.ReadOnly = True
        MaskedTextBox95.ReadOnly = True
        MaskedTextBox94.ReadOnly = True
        MaskedTextBox93.ReadOnly = True
        MaskedTextBox92.ReadOnly = True
        MaskedTextBox91.ReadOnly = True
        MaskedTextBox90.ReadOnly = True
        MaskedTextBox41.ReadOnly = True
        MaskedTextBox109.ReadOnly = True
        MaskedTextBox108.ReadOnly = True
        MaskedTextBox107.ReadOnly = True
        MaskedTextBox106.ReadOnly = True
        MaskedTextBox105.ReadOnly = True
        MaskedTextBox104.ReadOnly = True
        MaskedTextBox103.ReadOnly = True
        MaskedTextBox102.ReadOnly = True
        MaskedTextBox101.ReadOnly = True
        MaskedTextBox100.ReadOnly = True
        MaskedTextBox101.ReadOnly = True
        MaskedTextBox102.ReadOnly = True
        MaskedTextBox103.ReadOnly = True
        MaskedTextBox104.ReadOnly = True
        MaskedTextBox105.ReadOnly = True
        MaskedTextBox106.ReadOnly = True
        MaskedTextBox107.ReadOnly = True
        MaskedTextBox108.ReadOnly = True
        MaskedTextBox109.ReadOnly = True
        TextBox3.ReadOnly = True
        TextBox4.ReadOnly = True
        TextBox99.ReadOnly = True
        TextBox34.ReadOnly = True
        TextBox100.ReadOnly = True
        TextBox101.ReadOnly = True
        TextBox102.ReadOnly = True
        TextBox103.ReadOnly = True
        TextBox104.ReadOnly = True
        TextBox105.ReadOnly = True
        TextBox106.ReadOnly = True
        TextBox107.ReadOnly = True
        TextBox108.ReadOnly = True
        TextBox109.ReadOnly = True
        TextBox110.ReadOnly = True
        TextBox111.ReadOnly = True
        TextBox112.ReadOnly = True
        TextBox113.ReadOnly = True
        TextBox114.ReadOnly = True
        TextBox115.ReadOnly = True
        TextBox116.ReadOnly = True
        TextBox117.ReadOnly = True
        TextBox118.ReadOnly = True
        TextBox119.ReadOnly = True
        TextBox120.ReadOnly = True
        TextBox121.ReadOnly = True
        TextBox122.ReadOnly = True
        TextBox123.ReadOnly = True
        TextBox124.ReadOnly = True
        TextBox125.ReadOnly = True
        TextBox136.ReadOnly = True
        TextBox137.ReadOnly = True
        TextBox138.ReadOnly = True
        TextBox139.ReadOnly = True
        TextBox140.ReadOnly = True
        TextBox141.ReadOnly = True
        TextBox142.ReadOnly = True
        TextBox143.ReadOnly = True
        TextBox144.ReadOnly = True
        TextBox145.ReadOnly = True
        TextBox146.ReadOnly = True
        TextBox147.ReadOnly = True
        TextBox148.ReadOnly = True
        TextBox149.ReadOnly = True
        TextBox150.ReadOnly = True
        TextBox151.ReadOnly = True
        TextBox152.ReadOnly = True
        TextBox153.ReadOnly = True
        TextBox154.ReadOnly = True
        TextBox155.ReadOnly = True




    End Sub



    Sub GrantedAccess()

        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\gm.txt") = True Then
            Button5.Visible = True
        Else
            Button5.Visible = False
        End If


        Button12.Visible = True

        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\gm.txt") = True Then
            Button13.Visible = True
        Else
            Button13.Visible = False
        End If



        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\DS.txt") = False Then

            Denied()
            If My.Computer.FileSystem.FileExists(Application.StartupPath & "\personal.txt") = True Then Button1.Visible = True

        Else
            Label112.Text = "Полный доступ | Руководство станции " : Label112.BackColor = Color.LightBlue
            Button1.Visible = True
            Button7.Visible = True
            Button10.Visible = True
            Button11.Visible = True

        End If



        '====== РАЗГРАНИЧЕНИЕ ДОСТУПА ПО РАБОЧИМ МЕСТАМ


        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\Personal.txt") = True Then
            Label112.Text = "Ограниченный доступ" : Label112.BackColor = Color.LightCyan
            MaskedTextBox76.ReadOnly = False
            MaskedTextBox77.ReadOnly = False
            'TextBox27.ReadOnly = False
            'TextBox26.ReadOnly = False

        End If




        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\DSK.txt") = True Then
            Label112.Text = "Заместитель начальника ЛЦТО" : Label112.BackColor = Color.LightBlue
            ' RichTextBox9.ReadOnly = False
            Button7.Visible = True

        End If

        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\OK.txt") = True Then
            Label112.Text = "Отдел кадров" : Label112.BackColor = Color.LightBlue
            ' RichTextBox7.ReadOnly = False
            Button7.Visible = True
        End If

        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\PASS.txt") = True Then
            Label112.Text = "Начальник билетной кассы" : Label112.BackColor = Color.LightBlue
            '  RichTextBox6.ReadOnly = False
            Button7.Visible = True
        End If

        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\DVIZ.txt") = True Then
            Label112.Text = " ДСП | ДСЦ " : Label112.BackColor = Color.LightBlue
            'RichTextBox4.ReadOnly = False
            'Button7.Visible = True
        End If




    End Sub

    'Private Sub TextBox88_TextChanged(sender As Object, e As EventArgs)
    'If LoadEnd = 1 Then
    ' My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Prim_today.txt", TextBox106.Text, False)
    'End If
    'End Sub


    Private Sub TextBox59_TextChanged(sender As Object, e As EventArgs) Handles TextBox59.TextChanged
        SaveTextbox("\Vagonooborot_tek_god.txt", TextBox59.Text)
    End Sub



    Private Sub RichTextBox6_LinkClicked(sender As Object, e As LinkClickedEventArgs)
        System.Diagnostics.Process.Start(e.LinkText)
    End Sub



    Sub ReloadALL()

        Me.Hide()

        SplashScreen1.Show()
        SplashScreen1.Refresh()


        Label112.Text = "Только просмотр"





        GrantedAccess()







        Dim D As Date = Now


        Label45.Text = Format(D, "dd MMMM yyyyг.")
        Me.Text = Format(D, "dd MMMM yyyyг.") & " РЕЧИЦА БЧ " & Version

        'GroupBox4.Text = "Выполнение показателей за " & Format(D, "dd MMMM")

        LoadEnd = 0





        '======== ЗАГРУЗКА вкладки БЕЗОПАСНОСТЬ ДВИЖЕНИЯ


        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\myname.txt") = True Then
            'Label1.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt")
            'Me.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt") & " - E-Library"
        End If


        '======== ОБЪЯВЛЯЕМ ПЕРЕМЕННЫЕ ИЛИ СБРАСЫВАЕМ ТУТ

        Dim RW As Long = 0
        Dim Stringtext As String
        Dim bytesvalue As String

        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\IndexFileBD.txt") = True Then
            base = Application.StartupPath & "\IndexFileBD.txt"

            Dim reader As Microsoft.VisualBasic.FileIO.TextFieldParser

            reader = My.Computer.FileSystem.OpenTextFieldParser _
            (base)

            While Not reader.EndOfData
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                DataGridView1.Rows.Add()
            End While
            reader.Close()


            reader = My.Computer.FileSystem.OpenTextFieldParser _
            (base)
            While Not reader.EndOfData
                DataGridView1.Rows(RW).Cells(0).Value = reader.ReadLine()
                DataGridView1.Rows(RW).Cells(1).Value = reader.ReadLine()
                DataGridView1.Rows(RW).Cells(2).Value = reader.ReadLine()
                DataGridView1.Rows(RW).Cells(3).Value = reader.ReadLine()
                bytesvalue = reader.ReadLine()

                DataGridView1.Rows(RW).Cells(4).Value = bytesvalue

                If bytesvalue > 1024 Then
                    DataGridView1.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1024, 0) & " Кб"
                End If

                If bytesvalue > 1048576 Then
                    DataGridView1.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1048576, 0) & " Мб"
                End If
                If bytesvalue > 1073741824 Then
                    DataGridView1.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1073741824, 0) & " Гб"
                End If

                RW = RW + 1
            End While
            reader.Close()
        End If


        'DataGridView1.DefaultCellStyle.Font = New Font(DataGridView1.DefaultCellStyle.Font.Name, 13, FontStyle.Regular)




        '==== Завершено чтение файлов в индексном файле


        ' ===== запускаем индексацию
        DataGridView1.Rows.Clear() 'чистим ровбокс
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileBD.txt", "", False) 'чистим файл индекса
        IndexationV2() 'индексируем файлы БД
        'Registration()

        '===== конец загрузки











        '======== ЗАГРУЗКА вкладки Охрана труда


        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\myname.txt") = True Then
            'Label1.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt")
            'Me.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt") & " - E-Library"
        End If


        '======== ОБЪЯВЛЯЕМ ПЕРЕМЕННЫЕ ИЛИ СБРАСЫВАЕМ ТУТ

        RW = 0
        Stringtext = ""
        bytesvalue = ""



        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\IndexFileOT.txt") = True Then
            base = Application.StartupPath & "\IndexFileOT.txt"

            Dim reader As Microsoft.VisualBasic.FileIO.TextFieldParser

            reader = My.Computer.FileSystem.OpenTextFieldParser _
            (base)

            While Not reader.EndOfData
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                DataGridView3.Rows.Add()
            End While
            reader.Close()


            reader = My.Computer.FileSystem.OpenTextFieldParser _
            (base)
            While Not reader.EndOfData
                DataGridView3.Rows(RW).Cells(0).Value = reader.ReadLine()
                DataGridView3.Rows(RW).Cells(1).Value = reader.ReadLine()
                DataGridView3.Rows(RW).Cells(2).Value = reader.ReadLine()
                DataGridView3.Rows(RW).Cells(3).Value = reader.ReadLine()
                bytesvalue = reader.ReadLine()

                DataGridView3.Rows(RW).Cells(4).Value = bytesvalue

                If bytesvalue > 1024 Then
                    DataGridView3.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1024, 0) & " Кб"
                End If

                If bytesvalue > 1048576 Then
                    DataGridView3.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1048576, 0) & " Мб"
                End If
                If bytesvalue > 1073741824 Then
                    DataGridView3.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1073741824, 0) & " Гб"
                End If

                RW = RW + 1
            End While
            reader.Close()
        End If


        'DataGridView3.DefaultCellStyle.Font = New Font(DataGridView3.DefaultCellStyle.Font.Name, 13, FontStyle.Regular)




        '==== Завершено чтение файлов в индексном файле


        ' ===== запускаем индексацию
        DataGridView3.Rows.Clear() 'чистим ровбокс
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileOT.txt", "", False) 'чистим файл индекса
        IndexationOT() 'индексируем файлы БД
        'Registration()

        '===== конец загрузки












        '======== ЗАГРУЗКА вкладки ИНСТРУКТАЖИ


        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\myname.txt") = True Then
            'Label1.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt")
            'Me.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt") & " - E-Library"
        End If


        '======== ОБЪЯВЛЯЕМ ПЕРЕМЕННЫЕ ИЛИ СБРАСЫВАЕМ ТУТ

        RW = 0
        Stringtext = ""
        bytesvalue = ""



        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\IndexFileIN.txt") = True Then
            base = Application.StartupPath & "\IndexFileIN.txt"

            Dim reader As Microsoft.VisualBasic.FileIO.TextFieldParser

            reader = My.Computer.FileSystem.OpenTextFieldParser _
            (base)

            While Not reader.EndOfData
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                DataGridView5.Rows.Add()
            End While
            reader.Close()


            reader = My.Computer.FileSystem.OpenTextFieldParser _
            (base)
            While Not reader.EndOfData
                DataGridView5.Rows(RW).Cells(0).Value = reader.ReadLine()
                DataGridView5.Rows(RW).Cells(1).Value = reader.ReadLine()
                DataGridView5.Rows(RW).Cells(2).Value = reader.ReadLine()
                DataGridView5.Rows(RW).Cells(3).Value = reader.ReadLine()
                bytesvalue = reader.ReadLine()

                DataGridView5.Rows(RW).Cells(4).Value = bytesvalue

                If bytesvalue > 1024 Then
                    DataGridView5.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1024, 0) & " Кб"
                End If

                If bytesvalue > 1048576 Then
                    DataGridView5.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1048576, 0) & " Мб"
                End If
                If bytesvalue > 1073741824 Then
                    DataGridView5.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1073741824, 0) & " Гб"
                End If

                RW = RW + 1
            End While
            reader.Close()
        End If


        'Datagridview5.DefaultCellStyle.Font = New Font(Datagridview5.DefaultCellStyle.Font.Name, 13, FontStyle.Regular)




        '==== Завершено чтение файлов в индексном файле


        ' ===== запускаем индексацию
        DataGridView5.Rows.Clear() 'чистим ровбокс
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileIN.txt", "", False) 'чистим файл индекса
        IndexationIN() 'индексируем файлы БД
        'Registration()

        '===== КОНЕЦ ЗАГРУЗКИ



















        '======== ЗАГРУЗКА вкладки ДОКУМЕНТЫ


        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\myname.txt") = True Then
            'Label1.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt")
            'Me.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt") & " - E-Library"
        End If


        '======== ОБЪЯВЛЯЕМ ПЕРЕМЕННЫЕ ИЛИ СБРАСЫВАЕМ ТУТ

        RW = 0
        Stringtext = ""
        bytesvalue = ""



        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\IndexFileDOC.txt") = True Then
            base = Application.StartupPath & "\IndexFileDOC.txt"

            Dim reader As Microsoft.VisualBasic.FileIO.TextFieldParser

            reader = My.Computer.FileSystem.OpenTextFieldParser _
            (base)

            While Not reader.EndOfData
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                DataGridView7.Rows.Add()
            End While
            reader.Close()


            reader = My.Computer.FileSystem.OpenTextFieldParser _
            (base)
            While Not reader.EndOfData
                DataGridView7.Rows(RW).Cells(0).Value = reader.ReadLine()
                DataGridView7.Rows(RW).Cells(1).Value = reader.ReadLine()
                DataGridView7.Rows(RW).Cells(2).Value = reader.ReadLine()
                DataGridView7.Rows(RW).Cells(3).Value = reader.ReadLine()
                bytesvalue = reader.ReadLine()

                DataGridView7.Rows(RW).Cells(4).Value = bytesvalue

                If bytesvalue > 1024 Then
                    DataGridView7.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1024, 0) & " Кб"
                End If

                If bytesvalue > 1048576 Then
                    DataGridView7.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1048576, 0) & " Мб"
                End If
                If bytesvalue > 1073741824 Then
                    DataGridView7.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1073741824, 0) & " Гб"
                End If

                RW = RW + 1
            End While
            reader.Close()
        End If


        'DataGridView7.DefaultCellStyle.Font = New Font(DataGridView7.DefaultCellStyle.Font.Name, 13, FontStyle.Regular)




        '==== Завершено чтение файлов в индексном файле


        ' ===== запускаем индексацию
        DataGridView7.Rows.Clear() 'чистим ровбокс
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileDOC.txt", "", False) 'чистим файл индекса
        IndexationDOC() 'индексируем файлы БД
        'Registration()

        '===== КОНЕЦ ЗАГРУЗКИ




        '====================== Загрузка RichTextBox ов

        ' InformationLoad()
        ' DLoad()
        ' LCTOLoad()
        ' PLoad()
        ' OKLoad()
        ' OTLoad()
        ' BDLoad()
        LoadEnd = 1

        '======== ЗАГРУЗКА вкладки Суточный план

        LoadEnd = 0



        LoadTxtDat("Prim_today.txt")
        TextBox106.Text = LoadText1

        LoadTxt("Pogr_today_kr1.txt")
        MaskedTextBox1.Text = LoadText1
        LoadTxt("Pogr_today_kr2.txt")
        TextBox3.Text = LoadText1
        LoadTxt("Pogr_today_kr3.txt")
        MaskedTextBox2.Text = LoadText1
        LoadTxt("Pogr_today_kr4.txt")
        TextBox4.Text = LoadText1

        LoadTxt("Pogr_today.txt")
        TextBox11.Text = LoadText1
        Label189.Text = "Погрузка - " & TextBox11.Text


        LoadTxt("Pogr_today_pl1.txt")
        MaskedTextBox52.Text = LoadText1
        LoadTxt("Pogr_today_pl2.txt")
        TextBox99.Text = LoadText1
        LoadTxt("Pogr_today_pl3.txt")
        MaskedTextBox53.Text = LoadText1
        LoadTxt("Pogr_today_pl4.txt")
        TextBox34.Text = LoadText1


        LoadTxt("Pogr_today_pv1.txt")
        MaskedTextBox54.Text = LoadText1
        LoadTxt("Pogr_today_pv2.txt")
        TextBox100.Text = LoadText1
        LoadTxt("Pogr_today_pv3.txt")
        MaskedTextBox55.Text = LoadText1
        LoadTxt("Pogr_today_pv4.txt")
        TextBox101.Text = LoadText1


        LoadTxt("Pogr_today_cs1.txt")
        MaskedTextBox56.Text = LoadText1
        LoadTxt("Pogr_today_cs2.txt")
        TextBox102.Text = LoadText1
        LoadTxt("Pogr_today_cs3.txt")
        MaskedTextBox57.Text = LoadText1
        LoadTxt("Pogr_today_cs4.txt")
        TextBox103.Text = LoadText1



        LoadTxt("Pogr_today_pr1.txt")
        MaskedTextBox58.Text = LoadText1
        LoadTxt("Pogr_today_pr2.txt")
        TextBox104.Text = LoadText1
        LoadTxt("Pogr_today_pr3.txt")
        MaskedTextBox59.Text = LoadText1
        LoadTxt("Pogr_today_pr4.txt")
        TextBox105.Text = LoadText1






        LoadTxt("Vygr_today_kr1.txt")
        MaskedTextBox60.Text = LoadText1
        LoadTxt("Vygr_today_kr2.txt")
        TextBox88.Text = LoadText1
        LoadTxt("Vygr_today_kr3.txt")
        MaskedTextBox61.Text = LoadText1
        LoadTxt("Vygr_today_kr4.txt")
        TextBox107.Text = LoadText1

        LoadTxt("Vygr_today.txt")
        TextBox22.Text = LoadText1
        Label190.Text = "Выгрузка - " & TextBox22.Text


        LoadTxt("Vygr_today_pl1.txt")
        MaskedTextBox62.Text = LoadText1
        LoadTxt("Vygr_today_pl2.txt")
        TextBox108.Text = LoadText1
        LoadTxt("Vygr_today_pl3.txt")
        MaskedTextBox63.Text = LoadText1
        LoadTxt("Vygr_today_pl4.txt")
        TextBox109.Text = LoadText1


        LoadTxt("Vygr_today_pv1.txt")
        MaskedTextBox64.Text = LoadText1
        LoadTxt("Vygr_today_pv2.txt")
        TextBox110.Text = LoadText1
        LoadTxt("Vygr_today_pv3.txt")
        MaskedTextBox65.Text = LoadText1
        LoadTxt("Vygr_today_pv4.txt")
        TextBox111.Text = LoadText1


        LoadTxt("Vygr_today_cs1.txt")
        MaskedTextBox66.Text = LoadText1
        LoadTxt("Vygr_today_cs2.txt")
        TextBox112.Text = LoadText1
        LoadTxt("Vygr_today_cs3.txt")
        MaskedTextBox67.Text = LoadText1
        LoadTxt("Vygr_today_cs4.txt")
        TextBox113.Text = LoadText1



        LoadTxt("Vygr_today_pr1.txt")
        MaskedTextBox68.Text = LoadText1
        LoadTxt("Vygr_today_pr2.txt")
        TextBox114.Text = LoadText1
        LoadTxt("Vygr_today_pr3.txt")
        MaskedTextBox69.Text = LoadText1
        LoadTxt("Vygr_today_pr4.txt")
        TextBox115.Text = LoadText1









        LoadTxt("Zayavka_today_kr1.txt")
        MaskedTextBox70.Text = LoadText1
        LoadTxt("Zayavka_today_kr2.txt")
        TextBox116.Text = LoadText1
        LoadTxt("Zayavka_today_kr3.txt")
        MaskedTextBox71.Text = LoadText1
        LoadTxt("Zayavka_today_kr4.txt")
        TextBox117.Text = LoadText1

        LoadTxt("Zayavka_today.txt")
        TextBox45.Text = LoadText1
        Label191.Text = "Заявка - " & TextBox45.Text


        LoadTxt("Zayavka_today_pl1.txt")
        MaskedTextBox72.Text = LoadText1
        LoadTxt("Zayavka_today_pl2.txt")
        TextBox118.Text = LoadText1
        LoadTxt("Zayavka_today_pl3.txt")
        MaskedTextBox73.Text = LoadText1
        LoadTxt("Zayavka_today_pl4.txt")
        TextBox119.Text = LoadText1


        LoadTxt("Zayavka_today_pv1.txt")
        MaskedTextBox74.Text = LoadText1
        LoadTxt("Zayavka_today_pv2.txt")
        TextBox120.Text = LoadText1
        LoadTxt("Zayavka_today_pv3.txt")
        MaskedTextBox75.Text = LoadText1
        LoadTxt("Zayavka_today_pv4.txt")
        TextBox121.Text = LoadText1


        LoadTxt("Zayavka_today_cs1.txt")
        MaskedTextBox76.Text = LoadText1
        LoadTxt("Zayavka_today_cs2.txt")
        TextBox122.Text = LoadText1
        LoadTxt("Zayavka_today_cs3.txt")
        MaskedTextBox77.Text = LoadText1
        LoadTxt("Zayavka_today_cs4.txt")
        TextBox123.Text = LoadText1



        LoadTxt("Zayavka_today_pr1.txt")
        MaskedTextBox78.Text = LoadText1
        LoadTxt("Zayavka_today_pr2.txt")
        TextBox124.Text = LoadText1
        LoadTxt("Zayavka_today_pr3.txt")
        MaskedTextBox79.Text = LoadText1
        LoadTxt("Zayavka_today_pr4.txt")
        TextBox125.Text = LoadText1









        LoadTxt("PodVygr_today_kr1.txt")
        MaskedTextBox90.Text = LoadText1
        LoadTxt("PodVygr_today_kr2.txt")
        TextBox136.Text = LoadText1
        LoadTxt("PodVygr_today_kr3.txt")
        MaskedTextBox91.Text = LoadText1
        LoadTxt("PodVygr_today_kr4.txt")
        TextBox137.Text = LoadText1

        LoadTxt("PodVygr_today.txt")
        TextBox46.Text = LoadText1
        Label193.Text = "Под выгрузкой - " & TextBox46.Text


        LoadTxt("PodVygr_today_pl1.txt")
        MaskedTextBox92.Text = LoadText1
        LoadTxt("PodVygr_today_pl2.txt")
        TextBox138.Text = LoadText1
        LoadTxt("PodVygr_today_pl3.txt")
        MaskedTextBox93.Text = LoadText1
        LoadTxt("PodVygr_today_pl4.txt")
        TextBox139.Text = LoadText1


        LoadTxt("PodVygr_today_pv1.txt")
        MaskedTextBox94.Text = LoadText1
        LoadTxt("PodVygr_today_pv2.txt")
        TextBox140.Text = LoadText1
        LoadTxt("PodVygr_today_pv3.txt")
        MaskedTextBox95.Text = LoadText1
        LoadTxt("PodVygr_today_pv4.txt")
        TextBox141.Text = LoadText1


        LoadTxt("PodVygr_today_cs1.txt")
        MaskedTextBox96.Text = LoadText1
        LoadTxt("PodVygr_today_cs2.txt")
        TextBox142.Text = LoadText1
        LoadTxt("PodVygr_today_cs3.txt")
        MaskedTextBox97.Text = LoadText1
        LoadTxt("PodVygr_today_cs4.txt")
        TextBox143.Text = LoadText1




        LoadTxt("PodVygr_today_pr1.txt")
        MaskedTextBox98.Text = LoadText1
        LoadTxt("PodVygr_today_pr2.txt")
        TextBox144.Text = LoadText1
        LoadTxt("PodVygr_today_pr3.txt")
        MaskedTextBox99.Text = LoadText1
        LoadTxt("PodVygr_today_pr4.txt")
        TextBox145.Text = LoadText1





        LoadTxt("Perehod_today_kr1.txt")
        MaskedTextBox100.Text = LoadText1
        LoadTxt("Perehod_today_kr2.txt")
        TextBox146.Text = LoadText1
        LoadTxt("Perehod_today_kr3.txt")
        MaskedTextBox101.Text = LoadText1
        LoadTxt("Perehod_today_kr4.txt")
        TextBox147.Text = LoadText1

        LoadTxt("Perehod_today.txt")
        TextBox87.Text = LoadText1
        Label199.Text = "Нужно довезти - " & TextBox87.Text


        LoadTxt("Perehod_today_pl1.txt")
        MaskedTextBox102.Text = LoadText1
        LoadTxt("Perehod_today_pl2.txt")
        TextBox148.Text = LoadText1
        LoadTxt("Perehod_today_pl3.txt")
        MaskedTextBox103.Text = LoadText1
        LoadTxt("Perehod_today_pl4.txt")
        TextBox149.Text = LoadText1


        LoadTxt("Perehod_today_pv1.txt")
        MaskedTextBox104.Text = LoadText1
        LoadTxt("Perehod_today_pv2.txt")
        TextBox150.Text = LoadText1
        LoadTxt("Perehod_today_pv3.txt")
        MaskedTextBox105.Text = LoadText1
        LoadTxt("Perehod_today_pv4.txt")
        TextBox151.Text = LoadText1


        LoadTxt("Perehod_today_cs1.txt")
        MaskedTextBox106.Text = LoadText1
        LoadTxt("Perehod_today_cs2.txt")
        TextBox152.Text = LoadText1
        LoadTxt("Perehod_today_cs3.txt")
        MaskedTextBox107.Text = LoadText1
        LoadTxt("Perehod_today_cs4.txt")
        TextBox153.Text = LoadText1




        LoadTxt("Perehod_today_pr1.txt")
        MaskedTextBox108.Text = LoadText1
        LoadTxt("Perehod_today_pr2.txt")
        TextBox154.Text = LoadText1
        LoadTxt("Perehod_today_pr3.txt")
        MaskedTextBox109.Text = LoadText1
        LoadTxt("Perehod_today_pr4.txt")
        TextBox154.Text = LoadText1






        LoadEnd = 1
        Label48.Text = ""
        Label8.Text = ""
        Label9.Text = ""
        Label14.Text = ""





        If Val(TextBox11.Text) > 0 Then
            Label48.Text = TextBox11.Text & " ="
            Label189.Text = "Погрузка - " & TextBox11.Text
            If Val(Label47.Text) > 0 Then Label48.Text = Label48.Text & " кр" & Label47.Text
            If Val(Label52.Text) > 0 Then Label48.Text = Label48.Text & " пл" & Label52.Text
            If Val(Label59.Text) > 0 Then Label48.Text = Label48.Text & " пв" & Label59.Text
            If Val(Label62.Text) > 0 Then Label48.Text = Label48.Text & " цс" & Label62.Text
            If Val(Label65.Text) > 0 Then Label48.Text = Label48.Text & " пр" & Label65.Text

        End If


        If Val(TextBox22.Text) > 0 Then
            Label8.Text = TextBox22.Text & " ="
            Label190.Text = "Выгрузка - " & TextBox22.Text
            If Val(Label80.Text) > 0 Then Label8.Text = Label8.Text & " кр" & Label80.Text
            If Val(Label77.Text) > 0 Then Label8.Text = Label8.Text & " пл" & Label77.Text
            If Val(Label74.Text) > 0 Then Label8.Text = Label8.Text & " пв" & Label74.Text
            If Val(Label71.Text) > 0 Then Label8.Text = Label8.Text & " цс" & Label71.Text
            If Val(Label68.Text) > 0 Then Label8.Text = Label8.Text & " пр" & Label68.Text

        End If

        If Val(TextBox45.Text) > 0 Then
            Label9.Text = TextBox45.Text & " ="

            If Val(Label95.Text) > 0 Then Label9.Text = Label9.Text & " кр" & Label95.Text
            If Val(Label92.Text) > 0 Then Label9.Text = Label9.Text & " пл" & Label92.Text
            If Val(Label89.Text) > 0 Then Label9.Text = Label9.Text & " пв" & Label89.Text
            If Val(Label86.Text) > 0 Then Label9.Text = Label9.Text & " цс" & Label86.Text
            If Val(Label83.Text) > 0 Then Label9.Text = Label9.Text & " пр" & Label83.Text

        End If

        If Val(TextBox46.Text) > 0 Then
            Label14.Text = TextBox46.Text & " ="

            If Val(Label110.Text) > 0 Then Label14.Text = Label14.Text & " кр" & Label110.Text
            If Val(Label107.Text) > 0 Then Label14.Text = Label14.Text & " пл" & Label107.Text
            If Val(Label104.Text) > 0 Then Label14.Text = Label14.Text & " пв" & Label104.Text
            If Val(Label101.Text) > 0 Then Label14.Text = Label14.Text & " цс" & Label101.Text
            If Val(Label98.Text) > 0 Then Label14.Text = Label14.Text & " пр" & Label98.Text

        End If

        Me.Show()

        SplashScreen1.Close()

    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        ' My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\utv" & Format(Date.Now, "dd MMMM yyyyг.") & ".txt", "", False)
        ' My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Utv.txt", "", False)

        Button1.Enabled = False
        ''
        Label12.Text = "Печать..."
        Label12.Refresh
        WordPrint()
        Button1.Enabled = True
        Label12.Text = "Готово"
        Label12.Refresh()

        'SplashScreen2.Show()
        ' SplashScreen2.TextBox1.Text = "Утвержден новый суточный план."
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Message.Show()

    End Sub

    Sub DocumentLoad()


        'Label187.Visible = True
        Panel1.Visible = True
        Panel1.Refresh()
        'TabPage7.Enabled = False
        'SplashScreen1.ShowDialog()
        'SplashScreen1.ProgressBar1.Visible = False
        ' SplashScreen1.Refresh()

        Me.Refresh()

        '======== ОБЪЯВЛЯЕМ ПЕРЕМЕННЫЕ ИЛИ СБРАСЫВАЕМ ТУТ

        Dim RW As Long = 0
        Dim Stringtext As String
        Dim bytesvalue As String



        '======== ЗАГРУЗКА вкладки ДОКУМЕНТЫ


        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\myname.txt") = True Then
            'Label1.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt")
            'Me.Text = My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\myname.txt") & " - E-Library"
        End If


        '======== ОБЪЯВЛЯЕМ ПЕРЕМЕННЫЕ ИЛИ СБРАСЫВАЕМ ТУТ

        RW = 0
        Stringtext = ""
        bytesvalue = ""



        If My.Computer.FileSystem.FileExists(Application.StartupPath & "\IndexFileDOC.txt") = True Then
            base = Application.StartupPath & "\IndexFileDOC.txt"

            Dim reader As Microsoft.VisualBasic.FileIO.TextFieldParser

            reader = My.Computer.FileSystem.OpenTextFieldParser _
            (base)

            While Not reader.EndOfData
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                Stringtext = reader.ReadLine()
                DataGridView7.Rows.Add()
            End While
            reader.Close()


            reader = My.Computer.FileSystem.OpenTextFieldParser _
            (base)
            While Not reader.EndOfData
                DataGridView7.Rows(RW).Cells(0).Value = reader.ReadLine()
                DataGridView7.Rows(RW).Cells(1).Value = reader.ReadLine()
                DataGridView7.Rows(RW).Cells(2).Value = reader.ReadLine()
                DataGridView7.Rows(RW).Cells(3).Value = reader.ReadLine()
                bytesvalue = reader.ReadLine()

                DataGridView7.Rows(RW).Cells(4).Value = bytesvalue

                If bytesvalue > 1024 Then
                    DataGridView7.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1024, 0) & " Кб"
                End If

                If bytesvalue > 1048576 Then
                    DataGridView7.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1048576, 0) & " Мб"
                End If
                If bytesvalue > 1073741824 Then
                    DataGridView7.Rows(RW).Cells(4).Value = Math.Round(bytesvalue / 1073741824, 0) & " Гб"
                End If

                RW = RW + 1
            End While
            reader.Close()
        End If


        'DataGridView7.DefaultCellStyle.Font = New Font(DataGridView7.DefaultCellStyle.Font.Name, 13, FontStyle.Regular)




        '==== Завершено чтение файлов в индексном файле


        ' ===== запускаем индексацию
        DataGridView7.Rows.Clear() 'чистим ровбокс
        My.Computer.FileSystem.WriteAllText(Application.StartupPath & "\IndexFileDOC.txt", "", False) 'чистим файл индекса
        IndexationDOC() 'индексируем файлы БД
        'Registration()

        '===== КОНЕЦ ЗАГРУЗКИ

        'Label187.Visible = False

        'SplashScreen1.ProgressBar1.Visible = True
        'SplashScreen1.Close()

        Panel1.Visible = False

        ' TabPage7.Enabled = True



    End Sub

    Private Sub Timer3_Tick(sender As Object, e As EventArgs) Handles Timer3.Tick
        'Проверка есть ли обновления для текущей версии программы ============== ЗДЕСЬ ОБНОВЛЕНИЯ ПРОГРАММЫ = цифру больше тут и в блокноте
        If My.Computer.FileSystem.FileExists("z:\mcw\rw\update.txt") = True Then
            If Val(My.Computer.FileSystem.ReadAllText("z:\mcw\rw\update.txt")) > 32 Then
                UpdateRW()
            End If
        End If
    End Sub


    Sub UpdateRW()
        ' Проверяем на присутствие модуля обновления
        If My.Computer.FileSystem.FileExists(My.Application.Info.DirectoryPath & "\updaterw.exe") = True Then
            ' Запуск отдельного модуля обновления приложения
            Shell(My.Application.Info.DirectoryPath & "\updaterw.exe", AppWinStyle.NormalFocus)
            'Закрытие программы
            Me.Close()
        End If
    End Sub


    Sub GrWin()
        'Выравнивание групп боксов 5 и 6 (ОТ и БД) по ширине в окне
        Dim borders As Long = 10 ' задаем отступы контуров
        GroupBox5.Size = New System.Drawing.Size((Val(TabPage1.Size.Width - borders) / 2), GroupBox5.Size.Height) 'Размер = половина ширины окна Tabpage  с учетом бордюра
        GroupBox6.Location = New Point((Val(TabPage1.Size.Width + borders) / 2), GroupBox6.Location.Y) 'положение - половина окна Tabpage с учетом бордюра
        GroupBox6.Size = New System.Drawing.Size((Val(TabPage1.Size.Width - borders) / 2), GroupBox6.Size.Height)

        'Выравнивание по ширине и высоте находящихся в них текстбоксов
        'RichTextBox2.Size = New System.Drawing.Size((Val(GroupBox5.Size.Width - borders)), GroupBox5.Size.Height - borders * 3) 'Размер текстбокса внутри Группбокса с учетом бордюра
        'RichTextBox3.Size = New System.Drawing.Size((Val(GroupBox6.Size.Width - borders)), GroupBox6.Size.Height - borders * 3) 'Размер текстбокса внутри Группбокса с учетом бордюра

        'Выравнивание по высоте окна информации и нижних двух окон БД и ОТ
        Dim INFsize As Long = 55 ' размер заполнения в процентах окном информация по высоте
        '====================================================================================
        TabControl2.Size = New System.Drawing.Size((Val(TabPage1.Size.Width - borders)), TabPage1.Size.Height * INFsize / 100) 'Размер = половина ширины окна Tabpage  с учетом бордюра
        GroupBox5.Size = New System.Drawing.Size(GroupBox5.Size.Width, TabPage1.Size.Height - TabControl2.Size.Height - GroupBox4.Size.Height - 28) 'Размер
        GroupBox5.Location = New Point(GroupBox5.Location.X, Val(TabPage1.Size.Height - GroupBox5.Size.Height))  'положение - половина окна Tabpage с учетом бордюра
        GroupBox6.Size = New System.Drawing.Size(GroupBox6.Size.Width, TabPage1.Size.Height - TabControl2.Size.Height - GroupBox4.Size.Height - 28) 'Размер
        GroupBox6.Location = New Point(GroupBox6.Location.X, Val(TabPage1.Size.Height - GroupBox6.Size.Height)) 'положение - половина окна Tabpage с учетом бордюра

        'Приведение размеров ричтекстбоксов вкладок центральной инф. по высоте в норму

        Me.Refresh()

        'Приведение в порядок текстбокса в суточном плане
        'MsgBox(TabPage2.Width - borders)
        ' TextBox88.Size = New System.Drawing.Size(TabPage2.Width - borders, TabPage2.Height - GroupBox8.Size.Height - borders)
        ' GroupBox3.Location = New Point(5, GroupBox8.Size.Height + 40)
        '  Me.Text = GroupBox3.Location.X & " " & GroupBox3.Location.Y



        '===============================Выравнивание содержимого вкладки Суточное задание
        'Получение размера вкладки и расчёт размещения пяти элементов гроупбокс
        'Номера текстбоксов сверху регистрируем в массив

        TxtDB(189) = 11
        TxtDB(190) = 22
        TxtDB(191) = 45
        TxtDB(192) = 46
        TxtDB(193) = 87






        Dim GrSW As Integer = 0
        Dim GrSH As Integer = 0

        GrSW = (TabPage10.Size.Width / 5) + 5  ' здесь 5 - это количество групбоксов в табконтроле, вторая - это пробел между ними
        GrSH = TabPage10.Size.Height - 41 ' здесь 2 это пробел на всяк случай
        Dim posSt As Integer = 0
        'For i = 189 To 193
        'GrRec(GrSW, GrSH, i, posSt)
        ' posSt = posSt + 1
        ' Next
        'GroupBox43.Text = "Погрузка "
        'GroupBox44.Text = "Выгрузка "
        'GroupBox45.Text = "Заявка "
        'GroupBox46.Text = "Под выгрузкой "
        'GroupBox47.Text = "Погр. после 18 "


        GrWB = GrSW


        'MsgBox(TabPage10.Size.Height.ToString - TextBox106.Size.Height - TableLayoutPanel6.Location.Y.ToString)
        'TableLayoutPanel6.AutoScrollMinSize = New Size(1300, TabPage10.Size.Height.ToString - TextBox106.Size.Height - TableLayoutPanel6.Location.Y.ToString)







    End Sub
    Sub GrRec(GW As Integer, GH As Integer, I As Integer, posSt2 As Integer)

        'TabPage10.Controls("GroupBox" & I).Text = TabPage10.Size.Height
        ' TabPage10.Controls("Label" & I).Size = New System.Drawing.Size(GW, GH)

        'TableLayoutPanel6.Controls("Label" & I).Location = New Point(posSt2 * GW + 5, TableLayoutPanel6.Controls("Label" & I).Location.Y)
        ' Dim SizeText As Size = TextRenderer.MeasureText(TableLayoutPanel6.Controls("Label" & I).Text, TableLayoutPanel6.Controls("Label" & I).Font)
        'TableLayoutPanel6.Controls("Textbox" & TxtDB(I)).Height = SizeText.Height
        'TableLayoutPanel6.Controls("Textbox" & TxtDB(I)).Width = SizeText.Width
        'TableLayoutPanel6.Controls("Textbox" & TxtDB(I)).Location = New Point(posSt2 * GW + 15 + SizeText.Width, TableLayoutPanel6.Controls("Label" & I).Location.Y - 5)



    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        OpenNetwork()
    End Sub

    Sub OpenNetwork()
        NetWin.Show()

    End Sub

    Private Sub Timer4_Tick(sender As Object, e As EventArgs) Handles Timer4.Tick
        'Z:\mcw\RWData\netstat\online.txt"
        If My.Computer.FileSystem.FileExists("Z:\mcw\RWData\netstat\online.txt") = True Then
            My.Computer.FileSystem.WriteAllText("Z:\mcw\RWData\netstat\online\" & My.Computer.Name, Now.TimeOfDay.TotalMinutes & vbCrLf & System.Net.Dns.GetHostByName(System.Net.Dns.GetHostName()).AddressList(0).ToString & vbCrLf & My.Computer.Info.OSFullName & vbCrLf & My.User.Name & vbCrLf & My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\usercode.txt"), False) 'записываем параметр минуты
        End If
    End Sub

    Sub ScrenCapture()
        'Z:\mcw\RWData\netstat\scrcpt
        '==== передаем скриншот под именем компьютера в сеть
        If My.Computer.FileSystem.FileExists("Z:\mcw\RWData\netstat\scrcpt\on.txt") = True Then
            On Error Resume Next
            Dim currentScreen = Screen.FromHandle(Me.Handle).Bounds
            'create a bitmap of the working area
            Using bmp As New Bitmap(currentScreen.Width, currentScreen.Height)

                'copy the screen to the image
                Using g = Graphics.FromImage(bmp)
                    g.CopyFromScreen(New Point(0, 0), New Point(0, 0), currentScreen.Size)
                End Using
                'save the image
                If My.Computer.FileSystem.FileExists("Z:\mcw\RWData\netstat\scrcpt\" & My.Computer.Name & ".png") = False Then
                    bmp.Save("Z:\mcw\RWData\netstat\scrcpt\" & My.Computer.Name & ".png", System.Drawing.Imaging.ImageFormat.Png)
                End If

            End Using
        End If
    End Sub

    Private Sub Timer5_Tick(sender As Object, e As EventArgs) Handles Timer5.Tick
        If My.Computer.FileSystem.FileExists("Z:\mcw\RWData\netstat\scrcpt\" & My.Computer.Name) = True Then
            ScrenCapture()
        End If
    End Sub


    Sub InformationLoad()

        If My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Information.mht").LastWriteTime().ToString <> lastTime(1) Then

            On Error Resume Next
            yScroll(1) = WebBrowser1.Document.Body.ScrollRectangle.Y
            xScroll(1) = WebBrowser1.Document.Body.ScrollRectangle.X
            WebBrowser1.Refresh()
            WebForm.WebBrowser1.Refresh()
            lastTime(1) = My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Information.mht").LastWriteTime()
        End If


    End Sub

    Private Sub WebBrowser1_DocumentCompleted(sender As Object, e As WebBrowserDocumentCompletedEventArgs) Handles WebBrowser1.DocumentCompleted
        'Возврат коретки
        WebBrowser1.Document.Window.ScrollTo(xScroll(1), yScroll(1))

    End Sub

    Sub DLoad()
        If My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\DLoad.mht").LastWriteTime().ToString <> lastTime(2) Then
            On Error Resume Next
            yScroll(2) = WebBrowser2.Document.Body.ScrollRectangle.Y
            xScroll(2) = WebBrowser2.Document.Body.ScrollRectangle.X
            WebBrowser2.Refresh()
            WebForm.WebBrowser1.Refresh()
            lastTime(2) = My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\DLoad.mht").LastWriteTime()
        End If

    End Sub

    Private Sub WebBrowser2_DocumentCompleted(sender As Object, e As WebBrowserDocumentCompletedEventArgs) Handles WebBrowser2.DocumentCompleted
        WebBrowser2.Document.Window.ScrollTo(xScroll(2), yScroll(2))
    End Sub

    Sub LCTOLoad()
        If My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\LCTOLoad.mht").LastWriteTime().ToString <> lastTime(3) Then
            On Error Resume Next
            yScroll(3) = WebBrowser3.Document.Body.ScrollRectangle.Y
            xScroll(3) = WebBrowser3.Document.Body.ScrollRectangle.X
            WebBrowser3.Refresh()
            WebForm.WebBrowser1.Refresh()
            lastTime(3) = My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\LCTOLoad.mht").LastWriteTime()
        End If

    End Sub


    Private Sub WebBrowser3_DocumentCompleted(sender As Object, e As WebBrowserDocumentCompletedEventArgs) Handles WebBrowser3.DocumentCompleted
        WebBrowser3.Document.Window.ScrollTo(xScroll(3), yScroll(3))

    End Sub

    Sub PLoad()
        If My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\PLoad.mht").LastWriteTime().ToString <> lastTime(4) Then
            On Error Resume Next
            yScroll(4) = WebBrowser4.Document.Body.ScrollRectangle.Y
            xScroll(4) = WebBrowser4.Document.Body.ScrollRectangle.X
            WebBrowser4.Refresh()
            WebForm.WebBrowser1.Refresh()
            lastTime(4) = My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\PLoad.mht").LastWriteTime()
        End If

    End Sub


    Private Sub WebBrowser4_DocumentCompleted(sender As Object, e As WebBrowserDocumentCompletedEventArgs) Handles WebBrowser4.DocumentCompleted
        WebBrowser4.Document.Window.ScrollTo(xScroll(4), yScroll(4))

    End Sub

    Sub OKLoad()
        If My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\OKLoad.mht").LastWriteTime().ToString <> lastTime(5) Then
            On Error Resume Next
            yScroll(5) = WebBrowser5.Document.Body.ScrollRectangle.Y
            xScroll(5) = WebBrowser5.Document.Body.ScrollRectangle.X
            WebBrowser5.Refresh()
            WebForm.WebBrowser1.Refresh()
            lastTime(5) = My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\OKLoad.mht").LastWriteTime()
        End If

    End Sub


    Private Sub WebBrowser5_DocumentCompleted(sender As Object, e As WebBrowserDocumentCompletedEventArgs) Handles WebBrowser5.DocumentCompleted
        WebBrowser5.Document.Window.ScrollTo(xScroll(5), yScroll(5))
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click

        If TabControl2.SelectedIndex = 0 Then
            System.Diagnostics.Process.Start(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Information.mht", AppWinStyle.NormalFocus)
        End If
        If TabControl2.SelectedIndex = 1 Then
            System.Diagnostics.Process.Start(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\DLoad.mht", AppWinStyle.NormalFocus)
        End If
        If TabControl2.SelectedIndex = 2 Then
            System.Diagnostics.Process.Start(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\LCTOLoad.mht", AppWinStyle.NormalFocus)
        End If
        If TabControl2.SelectedIndex = 3 Then
            System.Diagnostics.Process.Start(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\PLoad.mht", AppWinStyle.NormalFocus)
        End If
        If TabControl2.SelectedIndex = 4 Then
            System.Diagnostics.Process.Start(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\OKLoad.mht", AppWinStyle.NormalFocus)
        End If


    End Sub


    Sub webLoadAll()
        WebBrowser1.Navigate(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Information.mht")
        WebBrowser2.Navigate(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\DLoad.mht")
        WebBrowser3.Navigate(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\LCTOLoad.mht")
        WebBrowser4.Navigate(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\PLoad.mht")
        WebBrowser5.Navigate(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\OKLoad.mht")
        WebBrowser6.Navigate(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\bd.mht")
        WebBrowser7.Navigate(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\ot.mht")
    End Sub


    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        WebForm.Show()

        If TabControl2.SelectedIndex = 0 Then
            WebForm.WebBrowser1.Navigate(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\Information.mht")
            WebForm.Label1.Text = "Информация"
        End If
        If TabControl2.SelectedIndex = 1 Then
            WebForm.WebBrowser1.Navigate(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\DLoad.mht")
            WebForm.Label1.Text = "Цех движения"
        End If
        If TabControl2.SelectedIndex = 2 Then
            WebForm.WebBrowser1.Navigate(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\LCTOLoad.mht")
            WebForm.Label1.Text = "ЛЦТО Речица"
        End If
        If TabControl2.SelectedIndex = 3 Then
            WebForm.WebBrowser1.Navigate(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\PLoad.mht")
            WebForm.Label1.Text = "Пассажирский цех"
        End If
        If TabControl2.SelectedIndex = 4 Then
            WebForm.WebBrowser1.Navigate(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\OKLoad.mht")
            WebForm.Label1.Text = "Отдел кадров"
        End If
        WebForm.WebBrowser1.Refresh()


    End Sub




    Sub OTLoad()
        If My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\ot.mht").LastWriteTime().ToString <> lastTime(7) Then
            On Error Resume Next
            yScroll(7) = WebBrowser6.Document.Body.ScrollRectangle.Y
            xScroll(7) = WebBrowser6.Document.Body.ScrollRectangle.X
            WebBrowser7.Refresh()
            WebForm.WebBrowser1.Refresh()
            lastTime(7) = My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\ot.mht").LastWriteTime()
        End If

    End Sub

    Private Sub WebBrowser6_DocumentCompleted(sender As Object, e As WebBrowserDocumentCompletedEventArgs) Handles WebBrowser6.DocumentCompleted
        WebBrowser6.Document.Window.ScrollTo(xScroll(6), yScroll(6))
    End Sub

    Sub BDLoad()
        If My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\bd.mht").LastWriteTime().ToString <> lastTime(6) Then
            On Error Resume Next
            yScroll(6) = WebBrowser6.Document.Body.ScrollRectangle.Y
            xScroll(6) = WebBrowser6.Document.Body.ScrollRectangle.X
            WebBrowser6.Refresh()
            WebForm.WebBrowser1.Refresh()
            lastTime(6) = My.Computer.FileSystem.GetFileInfo(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\bd.mht").LastWriteTime()
        End If

    End Sub


    Private Sub WebBrowser7_DocumentCompleted(sender As Object, e As WebBrowserDocumentCompletedEventArgs) Handles WebBrowser7.DocumentCompleted
        WebBrowser7.Document.Window.ScrollTo(xScroll(7), yScroll(7))
    End Sub

    Private Sub Button8_Click(sender As Object, e As EventArgs) Handles Button8.Click
        WebForm.Show()
        WebForm.WebBrowser1.Navigate(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\bd.mht")
        WebForm.WebBrowser1.Refresh()
        WebForm.Label1.Text = "Безопасность движения"

    End Sub

    Private Sub Button9_Click(sender As Object, e As EventArgs) Handles Button9.Click
        WebForm.Show()
        WebForm.WebBrowser1.Navigate(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\ot.mht")
        WebForm.WebBrowser1.Refresh()
        WebForm.Label1.Text = "Охрана труда"
    End Sub

    Private Sub Button10_Click(sender As Object, e As EventArgs) Handles Button10.Click
        System.Diagnostics.Process.Start(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\bd.mht", AppWinStyle.NormalFocus)
    End Sub

    Private Sub Button11_Click(sender As Object, e As EventArgs) Handles Button11.Click
        System.Diagnostics.Process.Start(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\ot.mht", AppWinStyle.NormalFocus)
    End Sub

    Private Sub TextBox3_TextChanged_1(sender As Object, e As EventArgs) Handles TextBox3.TextChanged
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_kr2.txt", TextBox3.Text, False)
        End If

        CellContry(1, 3, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут


    End Sub


    Private Sub TextBox4_TextChanged_1(sender As Object, e As EventArgs) Handles TextBox4.TextChanged
        CellContry(1, 4, 1)
        'Ввод в ячейку - Погрузка сегодня - КР
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_kr4.txt", TextBox4.Text, False)
        End If

        'Номер таблелайоут, текстбокс, строка в табллайоут

    End Sub

    Private Sub TextBox99_TextChanged_1(sender As Object, e As EventArgs) Handles TextBox99.TextChanged
        CellContry(2, 99, 0)

        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_pl2.txt", TextBox99.Text, False)
        End If

        'Номер таблелайоут, текстбокс, строка в табллайоут

    End Sub




    Sub CellContry(NumOfTable As Integer, i As Integer, rows As Integer) ' выравнивание ячеек - с ошибками пока что

        CreateDir()


        Dim arrTable As TableLayoutPanel = TableLayoutPanel6.Controls("TableLayoutPanel" & NumOfTable)



        Dim Sirina As Integer = arrTable.Size.Width - arrTable.Controls("TextBox" & i).Location.X

        'Me.Text = Sirina & " " & arrTable.Controls("TextBox" & i).Width
        'arrTable.Controls("TextBox" & i).Width = Sirina

        Dim CurWidth As Integer = arrTable.Controls("TextBox" & i).Width 'получаем текущую ширину текстбокса
        Dim KolStrok As Integer



        Dim SizeText As Size = TextRenderer.MeasureText(arrTable.Controls("TextBox" & i).Text, arrTable.Controls("TextBox" & i).Font)
        'arrTable.Controls("TextBox" & i).Width = SizeText.Width

        'получаем количество строк с округлением в большую сторону
        If SizeText.Width > 0 Then
            KolStrok = -Int(-(SizeText.Width / arrTable.Controls("TextBox" & i).Width))
        Else
            KolStrok = 1
        End If

        ' Me.Text = Sirina & " " & arrTable.Controls("TextBox" & i).Width & "--- KS " & KolStrok & " -= " & SizeText.Width

        'Если ширина текущего текстбокса больше чем полученного текста то пропустим выравнимание по ширине
        If CurWidth < SizeText.Width Then
            Dim TextboxLines As TextBox = arrTable.Controls("TextBox" & i)

            ' arrTable.Controls("TextBox" & i).Width = SizeText.Width
            'arrTable.Controls("TextBox" & i).Height = SizeText.Height
            arrTable.Controls("TextBox" & i).Height = SizeText.Height * KolStrok
            ' Me.Text = SizeText.Height * KolStrok
            If arrTable.Controls("TextBox" & i).Height < 12 Then
                arrTable.Controls("TextBox" & i).Height = 13
                'arrTable.Controls("TextBox" & i).Width = 36
            End If
            'arrTable.Controls("TextBox" & i).Text = arrTable.Controls("TextBox" & i).Text & vbCrLf
        Else
            arrTable.Controls("TextBox" & i).Height = SizeText.Height
            If arrTable.Controls("TextBox" & i).Height < 12 Then arrTable.Controls("TextBox" & i).Height = 13
        End If

        If arrTable.Controls("TextBox" & i).Width > Sirina Then
            ' arrTable.Controls("TextBox" & i).Height = arrTable.Controls("TextBox" & i).Height + 14 '* Int((arrTable.Controls("TextBox" & i).Width + Sirina) / Sirina)
            ' arrTable.Controls("TextBox" & i).Width = Sirina + 5
        End If

        arrTable.RowStyles(rows).Height = arrTable.Controls("TextBox" & i).Height

    End Sub



    Private Sub TextBox34_TextChanged(sender As Object, e As EventArgs) Handles TextBox34.TextChanged
        CellContry(2, 34, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_pl4.txt", TextBox34.Text, False)
        End If
    End Sub

    Private Sub TextBox100_TextChanged(sender As Object, e As EventArgs) Handles TextBox100.TextChanged
        CellContry(3, 100, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_pv2.txt", TextBox100.Text, False)
        End If
    End Sub

    Private Sub TextBox101_TextChanged(sender As Object, e As EventArgs) Handles TextBox101.TextChanged
        CellContry(3, 101, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_pv4.txt", TextBox101.Text, False)
        End If
    End Sub


    Private Sub TextBox102_TextChanged(sender As Object, e As EventArgs) Handles TextBox102.TextChanged
        CellContry(4, 102, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_cs2.txt", TextBox102.Text, False)
        End If

    End Sub

    Private Sub TextBox103_TextChanged(sender As Object, e As EventArgs) Handles TextBox103.TextChanged
        CellContry(4, 103, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_cs4.txt", TextBox103.Text, False)
        End If

    End Sub


    Private Sub TextBox104_TextChanged(sender As Object, e As EventArgs) Handles TextBox104.TextChanged
        CellContry(5, 104, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_pr2.txt", TextBox104.Text, False)
        End If
    End Sub

    Private Sub TextBox105_TextChanged(sender As Object, e As EventArgs) Handles TextBox105.TextChanged
        CellContry(5, 105, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today_pr4.txt", TextBox105.Text, False)
        End If
    End Sub


    Private Sub TextBox88_TextChanged_1(sender As Object, e As EventArgs) Handles TextBox88.TextChanged
        CellContry(7, 88, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_kr2.txt", TextBox88.Text, False)
        End If

    End Sub


    Private Sub TextBox107_TextChanged(sender As Object, e As EventArgs) Handles TextBox107.TextChanged
        CellContry(7, 107, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_kr4.txt", TextBox107.Text, False)
        End If
    End Sub

    Private Sub TextBox108_TextChanged(sender As Object, e As EventArgs) Handles TextBox108.TextChanged
        CellContry(8, 108, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_pl2.txt", TextBox108.Text, False)
        End If
    End Sub


    Private Sub TextBox109_TextChanged(sender As Object, e As EventArgs) Handles TextBox109.TextChanged
        CellContry(8, 109, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_pl4.txt", TextBox109.Text, False)
        End If
    End Sub



    Private Sub TextBox110_TextChanged(sender As Object, e As EventArgs) Handles TextBox110.TextChanged
        CellContry(9, 110, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_pv2.txt", TextBox110.Text, False)
        End If
    End Sub

    Private Sub TextBox111_TextChanged(sender As Object, e As EventArgs) Handles TextBox111.TextChanged
        CellContry(9, 111, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_pv4.txt", TextBox111.Text, False)
        End If
    End Sub



    Private Sub TextBox112_TextChanged(sender As Object, e As EventArgs) Handles TextBox112.TextChanged
        CellContry(10, 112, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_cs2.txt", TextBox112.Text, False)
        End If
    End Sub



    Private Sub TextBox113_TextChanged(sender As Object, e As EventArgs) Handles TextBox113.TextChanged
        CellContry(10, 113, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_cs4.txt", TextBox113.Text, False)
        End If
    End Sub


    Private Sub TextBox114_TextChanged(sender As Object, e As EventArgs) Handles TextBox114.TextChanged
        CellContry(11, 114, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_pr2.txt", TextBox114.Text, False)
        End If
    End Sub

    Private Sub TextBox115_TextChanged(sender As Object, e As EventArgs) Handles TextBox115.TextChanged
        CellContry(11, 115, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today_pr4.txt", TextBox115.Text, False)
        End If
    End Sub

    Private Sub TextBox116_TextChanged(sender As Object, e As EventArgs) Handles TextBox116.TextChanged
        CellContry(12, 116, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_kr2.txt", TextBox116.Text, False)
        End If
    End Sub

    Private Sub TextBox117_TextChanged(sender As Object, e As EventArgs) Handles TextBox117.TextChanged
        CellContry(12, 117, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_kr4.txt", TextBox117.Text, False)
        End If
    End Sub

    Private Sub TextBox118_TextChanged(sender As Object, e As EventArgs) Handles TextBox118.TextChanged
        CellContry(13, 118, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_pl2.txt", TextBox118.Text, False)
        End If
    End Sub

    Private Sub TextBox119_TextChanged(sender As Object, e As EventArgs) Handles TextBox119.TextChanged
        CellContry(13, 119, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_pl4.txt", TextBox119.Text, False)
        End If
    End Sub



    Private Sub TextBox120_TextChanged(sender As Object, e As EventArgs) Handles TextBox120.TextChanged
        CellContry(14, 120, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_pv2.txt", TextBox120.Text, False)
        End If
    End Sub

    Private Sub TextBox121_TextChanged(sender As Object, e As EventArgs) Handles TextBox121.TextChanged
        CellContry(14, 121, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_pv4.txt", TextBox121.Text, False)
        End If
    End Sub

    Private Sub TextBox122_TextChanged(sender As Object, e As EventArgs) Handles TextBox122.TextChanged
        CellContry(15, 122, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_cs2.txt", TextBox122.Text, False)
        End If
    End Sub

    Private Sub TextBox123_TextChanged(sender As Object, e As EventArgs) Handles TextBox123.TextChanged
        CellContry(15, 123, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_cs4.txt", TextBox123.Text, False)
        End If
    End Sub

    Private Sub TextBox124_TextChanged(sender As Object, e As EventArgs) Handles TextBox124.TextChanged
        CellContry(16, 124, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_pr2.txt", TextBox124.Text, False)
        End If
    End Sub

    Private Sub TextBox125_TextChanged(sender As Object, e As EventArgs) Handles TextBox125.TextChanged
        CellContry(16, 125, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today_pr4.txt", TextBox125.Text, False)
        End If
    End Sub

    Private Sub TextBox126_TextChanged(sender As Object, e As EventArgs)
        CellContry(17, 126, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
    End Sub

    Private Sub TextBox127_TextChanged(sender As Object, e As EventArgs)
        CellContry(17, 127, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
    End Sub

    Private Sub TextBox128_TextChanged(sender As Object, e As EventArgs)
        CellContry(18, 128, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
    End Sub

    Private Sub TextBox129_TextChanged(sender As Object, e As EventArgs)
        CellContry(18, 129, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
    End Sub

    Private Sub TextBox130_TextChanged(sender As Object, e As EventArgs)
        CellContry(19, 130, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
    End Sub

    Private Sub TextBox131_TextChanged(sender As Object, e As EventArgs)
        CellContry(19, 131, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
    End Sub

    Private Sub TextBox132_TextChanged(sender As Object, e As EventArgs)
        CellContry(20, 132, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
    End Sub

    Private Sub TextBox133_TextChanged(sender As Object, e As EventArgs)
        CellContry(20, 133, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
    End Sub

    Private Sub TextBox134_TextChanged(sender As Object, e As EventArgs)
        CellContry(21, 134, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
    End Sub

    Private Sub TextBox135_TextChanged(sender As Object, e As EventArgs)
        CellContry(21, 135, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
    End Sub

    Private Sub TextBox136_TextChanged(sender As Object, e As EventArgs) Handles TextBox136.TextChanged
        CellContry(22, 136, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_kr2.txt", TextBox136.Text, False)
        End If
    End Sub

    Private Sub TextBox137_TextChanged(sender As Object, e As EventArgs) Handles TextBox137.TextChanged
        CellContry(22, 137, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_kr4.txt", TextBox137.Text, False)
        End If

    End Sub

    Private Sub TextBox138_TextChanged(sender As Object, e As EventArgs) Handles TextBox138.TextChanged
        CellContry(23, 138, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_pl2.txt", TextBox138.Text, False)
        End If
    End Sub

    Private Sub TextBox139_TextChanged(sender As Object, e As EventArgs) Handles TextBox139.TextChanged
        CellContry(23, 139, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_pl4.txt", TextBox139.Text, False)
        End If

    End Sub

    Private Sub TextBox140_TextChanged(sender As Object, e As EventArgs) Handles TextBox140.TextChanged
        CellContry(24, 140, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_pv2.txt", TextBox140.Text, False)
        End If
    End Sub

    Private Sub TextBox141_TextChanged(sender As Object, e As EventArgs) Handles TextBox141.TextChanged
        CellContry(24, 141, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_pv4.txt", TextBox141.Text, False)
        End If
    End Sub

    Private Sub TextBox142_TextChanged(sender As Object, e As EventArgs) Handles TextBox142.TextChanged
        CellContry(25, 142, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_cs2.txt", TextBox142.Text, False)
        End If
    End Sub

    Private Sub TextBox143_TextChanged(sender As Object, e As EventArgs) Handles TextBox143.TextChanged
        CellContry(25, 143, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_cs4.txt", TextBox143.Text, False)
        End If
    End Sub

    Private Sub TextBox144_TextChanged(sender As Object, e As EventArgs) Handles TextBox144.TextChanged
        CellContry(26, 144, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_pr2.txt", TextBox144.Text, False)
        End If
    End Sub

    Private Sub TextBox145_TextChanged(sender As Object, e As EventArgs) Handles TextBox145.TextChanged
        CellContry(26, 145, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today_pr4.txt", TextBox145.Text, False)
        End If
    End Sub

    Private Sub TextBox146_TextChanged(sender As Object, e As EventArgs) Handles TextBox146.TextChanged
        CellContry(27, 146, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_kr2.txt", TextBox146.Text, False)
        End If
    End Sub

    Private Sub TextBox147_TextChanged(sender As Object, e As EventArgs) Handles TextBox147.TextChanged
        CellContry(27, 147, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_kr4.txt", TextBox147.Text, False)
        End If
    End Sub

    Private Sub TextBox148_TextChanged(sender As Object, e As EventArgs) Handles TextBox148.TextChanged
        CellContry(28, 148, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_pl2.txt", TextBox148.Text, False)
        End If
    End Sub

    Private Sub TextBox149_TextChanged(sender As Object, e As EventArgs) Handles TextBox149.TextChanged
        CellContry(28, 149, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_pl4.txt", TextBox149.Text, False)
        End If
    End Sub

    Private Sub TextBox150_TextChanged(sender As Object, e As EventArgs) Handles TextBox150.TextChanged
        CellContry(29, 150, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_pv2.txt", TextBox150.Text, False)
        End If
    End Sub

    Private Sub TextBox151_TextChanged(sender As Object, e As EventArgs) Handles TextBox151.TextChanged
        CellContry(29, 151, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_pv4.txt", TextBox151.Text, False)
        End If
    End Sub

    Private Sub TextBox152_TextChanged(sender As Object, e As EventArgs) Handles TextBox152.TextChanged
        CellContry(30, 152, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_cs2.txt", TextBox152.Text, False)
        End If
    End Sub

    Private Sub TextBox153_TextChanged(sender As Object, e As EventArgs) Handles TextBox153.TextChanged
        CellContry(30, 153, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_cs4.txt", TextBox153.Text, False)
        End If
    End Sub

    Private Sub TextBox154_TextChanged(sender As Object, e As EventArgs) Handles TextBox154.TextChanged
        CellContry(31, 154, 0) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_pr2.txt", TextBox154.Text, False)
        End If
    End Sub

    Private Sub TextBox155_TextChanged(sender As Object, e As EventArgs) Handles TextBox155.TextChanged
        CellContry(31, 155, 1) 'Номер таблелайоут, текстбокс, строка в табллайоут
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today_pr4.txt", TextBox155.Text, False)
        End If
    End Sub


    Private Sub TextBox11_TextChanged_1(sender As Object, e As EventArgs) Handles TextBox11.TextChanged
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Pogr_today.txt", TextBox11.Text, False)
        End If
    End Sub

    Private Sub TextBox22_TextChanged_1(sender As Object, e As EventArgs) Handles TextBox22.TextChanged
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Vygr_today.txt", TextBox22.Text, False)
        End If
    End Sub

    Private Sub TextBox45_TextChanged_1(sender As Object, e As EventArgs) Handles TextBox45.TextChanged
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Zayavka_today.txt", TextBox45.Text, False)
        End If
    End Sub

    Private Sub TextBox46_TextChanged_1(sender As Object, e As EventArgs) Handles TextBox46.TextChanged
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\PodVygr_today.txt", TextBox46.Text, False)
        End If
    End Sub

    Private Sub TextBox87_TextChanged_1(sender As Object, e As EventArgs) Handles TextBox87.TextChanged
        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Perehod_today.txt", TextBox87.Text, False)
        End If
    End Sub

    Private Sub Timer6_Tick(sender As Object, e As EventArgs) Handles Timer6.Tick
        Dim D As Date = Now
        Label45.Text = Format(D, "dd MMMM yyyyг.")
    End Sub




    Private Sub MaskedTextBox1_Validating(sender As Object, e As ComponentModel.CancelEventArgs) Handles MaskedTextBox1.Validating
        ActiveControl.BackColor = Color.FromArgb(218, 229, 242)
    End Sub


    Sub LoadProgress()

        'Me.Text = Now.TimeOfDay.TotalMinutes
        If TextBox47.Text = "" Then

        End If




        PokazateliLoad()


        'погрузка
        p1 = Val(TextBox47.Text)
        p2 = Val(TextBox58.Text)
        Procent()
        Label125.Text = rp & "%"
        If rp < 101 Then
            ProgressBar5.Value = rp
        Else
            ProgressBar5.Value = 100
        End If

        'выгрузка
        p1 = Val(TextBox48.Text)
        p2 = Val(TextBox56.Text)
        Procent()
        Label126.Text = rp & "%"
        If rp < 101 Then
            ProgressBar6.Value = rp
        Else
            ProgressBar6.Value = 100
        End If

        ' простой

        p1 = Val(TextBox55.Text)
        p2 = Val(TextBox49.Text)
        Procent()
        Label127.Text = rp & "%"

        If rp < 101 Then
            ProgressBar7.Value = rp
        Else
            ProgressBar7.Value = 100
        End If



        ' производительность локомотива

        p1 = Val(TextBox50.Text)
        p2 = Val(TextBox54.Text)
        Procent()
        Label128.Text = rp & "%"

        If rp < 101 Then
            ProgressBar8.Value = rp
        Else
            ProgressBar8.Value = 100
        End If

        '==============================ЗА ПЕРИОД ГОДА ПО ОТНОШЕНИЮ К АНАЛОГИЧНОМУ ПЕРИОДУ ПРОШЛОГО ГОДА

        ' Погрузка

        p1 = Val(TextBox64.Text)
        p2 = Val(TextBox71.Text)
        Procent()
        Label133.Text = rp & "%"

        If rp < 101 Then
            ProgressBar12.Value = rp
        Else
            ProgressBar12.Value = 100
        End If

        ' Выгрузка

        p1 = Val(TextBox62.Text)
        p2 = Val(TextBox69.Text)
        Procent()
        Label132.Text = rp & "%"

        If rp < 101 Then
            ProgressBar11.Value = rp
        Else
            ProgressBar11.Value = 100
        End If


        ' Простой

        p1 = Val(TextBox68.Text)
        p2 = Val(TextBox61.Text)
        Procent()
        Label131.Text = rp & "%"

        If rp < 101 Then
            ProgressBar10.Value = rp
        Else
            ProgressBar10.Value = 100
        End If

        ' Производительность локомотива

        p1 = Val(TextBox60.Text)
        p2 = Val(TextBox67.Text)
        Procent()
        Label130.Text = rp & "%"

        If rp < 101 Then
            ProgressBar9.Value = rp
        Else
            ProgressBar9.Value = 100
        End If


        ' Вагонооборот

        p1 = Val(TextBox59.Text)
        p2 = Val(TextBox66.Text)
        Procent()
        Label176.Text = rp & "%"

        If rp < 101 Then
            ProgressBar13.Value = rp
        Else
            ProgressBar13.Value = 100
        End If



        '==== передача данных на главную вкладку



        Label2.Text = TextBox47.Text
        Label4.Text = TextBox52.Text
        Label7.Text = TextBox48.Text
        Label12.Text = TextBox49.Text
        Label33.Text = TextBox50.Text

        Label18.Text = TextBox58.Text
        Label15.Text = TextBox57.Text
        Label16.Text = TextBox55.Text
        Label17.Text = TextBox56.Text
        Label40.Text = TextBox54.Text

        Label31.Text = Label125.Text
        Label30.Text = Label126.Text
        Label29.Text = Label127.Text
        Label43.Text = Label128.Text

        ProgressBar1.Value = ProgressBar5.Value
        ProgressBar2.Value = ProgressBar6.Value
        ProgressBar3.Value = ProgressBar7.Value
        ProgressBar4.Value = ProgressBar8.Value



        GroupBox4.Text = "Выполнение показателей за " & TextBox53.Text

    End Sub
    Private Sub Timer7_Tick(sender As Object, e As EventArgs) Handles Timer7.Tick
        'Me.Text = Now.TimeOfDay.TotalMinutes
        If TextBox47.Text = "" Then

        End If




        PokazateliLoad()


        'погрузка
        p1 = Val(TextBox47.Text)
        p2 = Val(TextBox58.Text)
        Procent()
        Label125.Text = rp & "%"
        If rp < 101 Then
            ProgressBar5.Value = rp
        Else
            ProgressBar5.Value = 100
        End If

        'выгрузка
        p1 = Val(TextBox48.Text)
        p2 = Val(TextBox56.Text)
        Procent()
        Label126.Text = rp & "%"
        If rp < 101 Then
            ProgressBar6.Value = rp
        Else
            ProgressBar6.Value = 100
        End If

        ' простой

        p1 = Val(TextBox55.Text)
        p2 = Val(TextBox49.Text)
        Procent()
        Label127.Text = rp & "%"

        If rp < 101 Then
            ProgressBar7.Value = rp
        Else
            ProgressBar7.Value = 100
        End If



        ' производительность локомотива

        p1 = Val(TextBox50.Text)
        p2 = Val(TextBox54.Text)
        Procent()
        Label128.Text = rp & "%"

        If rp < 101 Then
            ProgressBar8.Value = rp
        Else
            ProgressBar8.Value = 100
        End If

        '==============================ЗА ПЕРИОД ГОДА ПО ОТНОШЕНИЮ К АНАЛОГИЧНОМУ ПЕРИОДУ ПРОШЛОГО ГОДА

        ' Погрузка

        p1 = Val(TextBox64.Text)
        p2 = Val(TextBox71.Text)
        Procent()
        Label133.Text = rp & "%"

        If rp < 101 Then
            ProgressBar12.Value = rp
        Else
            ProgressBar12.Value = 100
        End If

        ' Выгрузка

        p1 = Val(TextBox62.Text)
        p2 = Val(TextBox69.Text)
        Procent()
        Label132.Text = rp & "%"

        If rp < 101 Then
            ProgressBar11.Value = rp
        Else
            ProgressBar11.Value = 100
        End If


        ' Простой

        p1 = Val(TextBox68.Text)
        p2 = Val(TextBox61.Text)
        Procent()
        Label131.Text = rp & "%"

        If rp < 101 Then
            ProgressBar10.Value = rp
        Else
            ProgressBar10.Value = 100
        End If

        ' Производительность локомотива

        p1 = Val(TextBox60.Text)
        p2 = Val(TextBox67.Text)
        Procent()
        Label130.Text = rp & "%"

        If rp < 101 Then
            ProgressBar9.Value = rp
        Else
            ProgressBar9.Value = 100
        End If


        ' Вагонооборот

        p1 = Val(TextBox59.Text)
        p2 = Val(TextBox66.Text)
        Procent()
        Label176.Text = rp & "%"

        If rp < 101 Then
            ProgressBar13.Value = rp
        Else
            ProgressBar13.Value = 100
        End If



        '==== передача данных на главную вкладку



        Label2.Text = TextBox47.Text
        Label4.Text = TextBox52.Text
        Label7.Text = TextBox48.Text
        Label12.Text = TextBox49.Text
        Label33.Text = TextBox50.Text

        Label18.Text = TextBox58.Text
        Label15.Text = TextBox57.Text
        Label16.Text = TextBox55.Text
        Label17.Text = TextBox56.Text
        Label40.Text = TextBox54.Text

        Label31.Text = Label125.Text
        Label30.Text = Label126.Text
        Label29.Text = Label127.Text
        Label43.Text = Label128.Text

        ProgressBar1.Value = ProgressBar5.Value
        ProgressBar2.Value = ProgressBar6.Value
        ProgressBar3.Value = ProgressBar7.Value
        ProgressBar4.Value = ProgressBar8.Value



        GroupBox4.Text = "Выполнение показателей за " & TextBox53.Text
    End Sub


    Private Sub Button12_Click(sender As Object, e As EventArgs) Handles Button12.Click
        bug.Show()
    End Sub

    Private Sub DataGridView7_CellMouseDoubleClick(sender As Object, e As DataGridViewCellMouseEventArgs) Handles DataGridView7.CellMouseDoubleClick
        System.Diagnostics.Process.Start(DataGridView7.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub

    Private Sub DataGridView8_CellMouseDoubleClick(sender As Object, e As DataGridViewCellMouseEventArgs) Handles DataGridView8.CellMouseDoubleClick
        System.Diagnostics.Process.Start(DataGridView8.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub

    Private Sub DataGridView5_CellMouseDoubleClick(sender As Object, e As DataGridViewCellMouseEventArgs) Handles DataGridView5.CellMouseDoubleClick
        System.Diagnostics.Process.Start(DataGridView5.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub

    Private Sub DataGridView6_CellMouseDoubleClick(sender As Object, e As DataGridViewCellMouseEventArgs) Handles DataGridView6.CellMouseDoubleClick
        System.Diagnostics.Process.Start(DataGridView6.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub

    Private Sub DataGridView3_CellMouseDoubleClick(sender As Object, e As DataGridViewCellMouseEventArgs) Handles DataGridView3.CellMouseDoubleClick
        System.Diagnostics.Process.Start(DataGridView3.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub

    Private Sub DataGridView4_CellMouseDoubleClick(sender As Object, e As DataGridViewCellMouseEventArgs) Handles DataGridView4.CellMouseDoubleClick
        System.Diagnostics.Process.Start(DataGridView4.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub

    Private Sub DataGridView1_CellMouseDoubleClick(sender As Object, e As DataGridViewCellMouseEventArgs) Handles DataGridView1.CellMouseDoubleClick
        System.Diagnostics.Process.Start(DataGridView1.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub

    Private Sub DataGridView2_CellMouseDoubleClick(sender As Object, e As DataGridViewCellMouseEventArgs) Handles DataGridView2.CellMouseDoubleClick
        System.Diagnostics.Process.Start(DataGridView2.CurrentRow.Cells(2).Value(), AppWinStyle.NormalFocus)
    End Sub

    Private Sub Button13_Click(sender As Object, e As EventArgs) Handles Button13.Click
        viewbug.Show()

    End Sub

    Private Sub TableLayoutPanel16_Paint(sender As Object, e As PaintEventArgs) Handles TableLayoutPanel16.Paint

    End Sub

    Private Sub TextBox106_TextChanged(sender As Object, e As EventArgs) Handles TextBox106.TextChanged
        CreateDir()

        If LoadEnd = 1 Then
            My.Computer.FileSystem.WriteAllText(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text & "\Prim_today.txt", TextBox106.Text, False)
        End If
    End Sub

    Private Sub DateTimePicker1_ValueChanged(sender As Object, e As EventArgs) Handles DateTimePicker1.ValueChanged
        Label45.Text = Format(DateAdd(DateInterval.Day, 0, Convert.ToDateTime(DateTimePicker1.Value)), "dd MMMM yyyyг.")

        'ClearAllTextboxes()

        If My.Computer.FileSystem.DirectoryExists(My.Computer.FileSystem.ReadAllText(Application.StartupPath & "\PathOfPokazateli.txt") & "\" & Label45.Text) = True Then
            TableLayoutPanel6.Visible = False
            Label22.Visible = True
            Label22.Refresh()
            SPLoad()
            Label22.Visible = False
            TableLayoutPanel6.Visible = True

        Else
            'Label45.Text = Format(DateAdd(DateInterval.Day, 1, Convert.ToDateTime(Label45.Text)), "dd MMMM yyyyг.")
            TableLayoutPanel6.Visible = False
            Label22.Visible = True
            Label22.Refresh()
            SPLoad()
            Label22.Visible = False
            TableLayoutPanel6.Visible = True
        End If
        ' DataCheckRead()
        'CreateDir()

    End Sub

    Private Sub MaskedTextBox60_MaskInputRejected(sender As Object, e As MaskInputRejectedEventArgs) Handles MaskedTextBox60.MaskInputRejected

    End Sub

    Private Sub Button16_Click(sender As Object, e As EventArgs) Handles Button16.Click
        Me.WindowState = FormWindowState.Minimized
    End Sub

    Private Sub Button14_Click(sender As Object, e As EventArgs) Handles Button14.Click
        Me.Close()
    End Sub

    Private Sub Button15_Click(sender As Object, e As EventArgs) Handles Button15.Click
        If Me.WindowState = FormWindowState.Maximized Then

            Me.WindowState = FormWindowState.Normal
        Else
            Me.WindowState = FormWindowState.Maximized
        End If


    End Sub
End Class







